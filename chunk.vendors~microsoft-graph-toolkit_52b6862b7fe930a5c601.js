(window.webpackJsonp_1a86ce4e35bac7ae60ca710fe0988d33=window.webpackJsonp_1a86ce4e35bac7ae60ca710fe0988d33||[]).push([[161],{"+BgG":function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i});var o=r("J0Kn");function n(...e){const t={scopes:e};return[new o.b(void 0,t)]}function i(...e){const t=e[0];let r=t;for(let t=1;t<e.length;++t){const o=e[t];r.setNext&&r.setNext(o),r=o}return t}},"+pM/":function(e,t,r){"use strict";var o;r.d(t,"a",function(){return o}),function(e){e[e.none=0]="none",e[e.hover=1]="hover",e[e.click=2]="click"}(o||(o={}))},"/IPs":function(e,t){t.read=function(e,t,r,o,n){var i,s,a=8*n-o-1,c=(1<<a)-1,l=c>>1,d=-7,u=r?n-1:0,h=r?-1:1,p=e[t+u];for(u+=h,i=p&(1<<-d)-1,p>>=-d,d+=a;d>0;i=256*i+e[t+u],u+=h,d-=8);for(s=i&(1<<-d)-1,i>>=-d,d+=o;d>0;s=256*s+e[t+u],u+=h,d-=8);if(0===i)i=1-l;else{if(i===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,o),i-=l}return(p?-1:1)*s*Math.pow(2,i-o)},t.write=function(e,t,r,o,n,i){var s,a,c,l=8*i-n-1,d=(1<<l)-1,u=d>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=o?0:i-1,f=o?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+u>=1?h/c:h*Math.pow(2,1-u))*c>=2&&(s++,c/=2),s+u>=d?(a=0,s=d):s+u>=1?(a=(t*c-1)*Math.pow(2,n),s+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,n),s=0));n>=8;e[r+p]=255&a,p+=f,a/=256,n-=8);for(s=s<<n|a,l+=n;l>0;e[r+p]=255&s,p+=f,s/=256,l-=8);e[r+p-f]|=128*g}},"/vu6":function(e,t,r){"use strict";r.d(t,"a",function(){return o});const o={presence:{name:"presence",stores:{presence:"presence"},version:1},users:{name:"users",stores:{users:"users",usersQuery:"usersQuery"},version:1},photos:{name:"photos",stores:{contacts:"contacts",users:"users"},version:1},people:{name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:1},groups:{name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:2},get:{name:"responses",stores:{responses:"responses"},version:1},files:{name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:1},fileLists:{name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:1}}},"/yih":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var o=r("cmRh"),n=r("hkiJ"),i=(r("0Owk"),function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}),s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class a extends o.MgtTemplatedComponent{constructor(){super(),this._isCompact=!1,this._personDetails=null}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.requestStateUpdate())}get isCompact(){return this._isCompact}asCompactView(){return this._isCompact=!0,this.requestUpdate(),this}asFullView(){return this._isCompact=!1,this.requestUpdate(),this}clearState(){this._isCompact=!1,this._personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderLoading(){return n.d`
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `}renderNoData(){return n.d`
      <div class="no-data">No data</div>
    `}navigateCard(e){let t=this.parentNode;for(;t;)if(t=t.parentNode,t&&t.host&&"MGT-PERSON-CARD"===t.host.tagName){t=t.host;break}t.navigate(e)}}i([Object(n.f)({attribute:"person-details",type:Object}),s("design:type",Object),s("design:paramtypes",[Object])],a.prototype,"personDetails",null)},"0Owk":function(e,t,r){"use strict";var o=r("hkiJ"),n=r("cmRh");const i=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .spinner{border:2px solid #c7e0f4;border-top:2px solid #0078d4;border-radius:50%;width:20px;height:20px;animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
`];let s=class extends n.MgtBaseComponent{static get styles(){return i}render(){return o.d`
      <div class="spinner"></div>
    `}};s=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}([Object(o.c)("mgt-spinner")],s)},"0i3K":function(e,t,r){"use strict";r.d(t,"e",function(){return s.a}),r.d(t,"g",function(){return a.b}),r.d(t,"h",function(){return a.c}),r.d(t,"a",function(){return o.b}),r.d(t,"b",function(){return o.e}),r.d(t,"c",function(){return o.g}),r.d(t,"d",function(){return c.c}),r.d(t,"f",function(){return l});var o=r("voU4");const n=new class{handleAttributeExpressions(e,t,r,n){const i=t[0];return"."===i?new o.f(e,t.slice(1),r).parts:"@"===i?[new o.d(e,t.slice(1),n.eventContext)]:"?"===i?[new o.c(e,t.slice(1),r)]:new o.a(e,t,r).parts}handleTextExpression(e){return new o.e(e)}};var i=r("DpLM"),s=r("ePoC"),a=r("2RF3"),c=(r("8GBX"),r("mgLx"),r("R8cf"),r("r6WH"),r("SkKE"));"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const l=(e,...t)=>new i.b(e,t,"html",n)},"2RF3":function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"c",function(){return n}),r.d(t,"b",function(){return i});const o="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,n=(e,t,r=null,o=null)=>{for(;t!==r;){const r=t.nextSibling;e.insertBefore(t,o),t=r}},i=(e,t,r=null)=>{for(;t!==r;){const r=t.nextSibling;e.removeChild(t),t=r}}},"2U3X":function(e,t,r){"use strict";r.d(t,"a",function(){return l});var o=r("hkiJ"),n=r("/yih"),i=r("P7nI");const s=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 20px 20px}:host .root .subtitle{color:var(--title-color-sub2,#797775);font-size:14px;margin:0 20px 8px 20px}:host .root .divider{display:flex;background:var(--line-seperator-color,#edebe9);height:1px;margin-top:26px;margin-bottom:18px;margin-left:20px;margin-right:20px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--background-color-sub2,#f3f2f1);border:1px solid #0078d4}:host .root .org-member.org-member--direct-report:not(:last-child){border-bottom:none}:host .root .org-member:not(.org-member--target){background-color:var(--background-color-sub1,#faf9f8);border:1px solid var(--line-seperator-color,#edebe9)}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__person mgt-person{--avatar-size:48px;--avatar-size-s:48px;--font-size:16px;--color:#323130;--line2-font-size:14px;--line3-font-size:14px;--line2-text-transform:uppercase;--line2-color:#797775;--line3-color:#797775;--line3-text-transform:uppercase;margin-right:8px;max-width:230px}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--color-sub1,#323130);font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--color-sub2,#797775)}:host .root .org-member__separator{border:1px solid var(--line-seperator-color,#edebe9);box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .coworker .coworker__person{height:46px;width:46px;border-radius:46px;margin-right:8px}:host .root .coworker .coworker__person mgt-person{--font-size:16px;--line2-text-transform:uppercase;--line2-font-size:14px;--line2-color:set-var(color__sub2, $theme-default, $common);--avatar-size:46px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}
`],a={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"};var c=r("LgXN");let l=class extends n.a{constructor(e,t){super(),this._state=e,this._me=t}static get styles(){return s}get strings(){return a}clearState(){super.clearState(),this._state=null,this._me=null}get displayName(){const{person:e,directReports:t}=this._state;return!e.manager&&t&&t.length?`${this.strings.directReportsSectionTitle} (${t.length})`:this.strings.reportsToSectionTitle}renderIcon(){return Object(i.b)(i.a.Organization)}renderCompactView(){let e;if(!this._state||!this._state.person)return null;const{person:t,directReports:r}=this._state;return t?(t.manager?e=this.renderCoworker(t.manager):r&&r.length&&(e=this.renderCompactDirectReports()),o.d`
      <div class="root compact">
        ${e}
      </div>
    `):null}renderFullView(){let e;if(!this._state||!this._state.person)return null;const{person:t,directReports:r,people:n}=this._state;if(!(t||r||n))return null;{const t=this.renderManagers(),r=this.renderCurrentUser(),n=this.renderDirectReports(),i=this.renderCoworkers();e=o.d`
        ${t} ${r} ${n} ${i}
      `}return o.d`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.organizationSectionTitle}</div>
        ${e}
      </div>
    `}renderManager(e){return o.d`
      <div class="org-member" @click=${()=>this.navigateCard(e)}>
        <div class="org-member__person">
          <mgt-person
            .personDetails=${e}
            .line2Property=${"jobTitle"}
            .line3Property=${"department"}
            .fetchImage=${!0}
            .view=${c.a.threelines}
          ></mgt-person>
        </div>
        <div class="org-member__more">
          ${Object(i.b)(i.a.ExpandRight)}
        </div>
      </div>
      <div class="org-member__separator"></div>
    `}renderManagers(){const{person:e}=this._state;if(!e||!e.manager)return null;const t=[];let r=e;for(;r.manager;)t.push(r.manager),r=r.manager;return t.length?t.reverse().map(e=>this.renderManager(e)):null}renderDirectReports(){const{directReports:e}=this._state;return e&&e.length?o.d`
      <div class="org-member__separator"></div>
      <div>
        ${e.map(e=>o.d`
            <div class="org-member org-member--direct-report" @click=${()=>this.navigateCard(e)}>
              <div class="org-member__person">
                <mgt-person
                  .personDetails=${e}
                  .line2Property=${"jobTitle"}
                  .line3Property=${"department"}
                  .fetchImage=${!0}
                  .view=${c.a.twolines}
                ></mgt-person>
              </div>
              <div class="org-member__more">
                ${Object(i.b)(i.a.ExpandRight)}
              </div>
            </div>
          `)}
      </div>
    `:null}renderCompactDirectReports(){const{directReports:e}=this._state;return o.d`
      <div class="direct-report__compact">
        ${e.slice(0,6).map(e=>o.d`
            <div class="direct-report" @click=${()=>this.navigateCard(e)}>
              <mgt-person .personDetails=${e} .fetchImage=${!0}></mgt-person>
            </div>
          `)}
      </div>
    `}renderCurrentUser(){const{person:e}=this._state;return o.d`
      <div class="org-member org-member--target">
        <div class="org-member__person">
          <mgt-person
            .personDetails=${e}
            .line2Property=${"jobTitle"}
            .line3Property=${"department"}
            .fetchImage=${!0}
            .view=${c.a.threelines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworker(e){return o.d`
      <div class="coworker" @click=${()=>this.navigateCard(e)}>
        <div class="coworker__person">
          <mgt-person
            .personDetails=${e}
            .line2Property=${"jobTitle"}
            .fetchImage=${!0}
            .view=${c.a.twolines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworkers(){const{people:e}=this._state;if(!e||!e.length)return null;const t=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:`${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;return o.d`
      <div class="divider"></div>
      <div class="subtitle">${t}</div>
      <div>
        ${e.slice(0,6).map(e=>this.renderCoworker(e))}
      </div>
    `}};l=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}([Object(o.c)("mgt-person-card-organization"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",t)}(0,[Object,Object])],l)},"2V34":function(e,t){},"2hCA":function(e,t,r){"use strict";r.d(t,"a",function(){return o});class o{}},"2ngi":function(e,t,r){"use strict";r.d(t,"a",function(){return c});var o=r("hkiJ"),n=r("wAtJ"),i=r("ayeG"),s=r("Wozh"),a=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};let c=class extends n.a{initializeProvider(){i.a.globalProvider=new s.a(!this.signedOut)}};a([Object(o.f)({attribute:"signed-out",type:Boolean}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",t)}(0,Object)],c.prototype,"signedOut",void 0),c=a([Object(o.c)("mgt-mock-provider")],c)},"3wPE":function(e,t,r){"use strict";r.d(t,"a",function(){return f});var o=r("hkiJ"),n=r("IVvM"),i=r("cmRh"),s=r("LgXN"),a=r("598n"),c=r("cy2K");const l=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}:host,mgt-login{--font-size:14px;--font-weight:600;--width:'100%';--height:'100%';--margin:0;--padding:12px 20px;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--button-color,#323130);background-color:var(--button-background-color,transparent);border:none;cursor:pointer;transition:color .3s,background-color .3s}:host .login-button mgt-person,mgt-login .login-button mgt-person{--color-sub1:set-var(button__color, $theme-default, $login)}:host .login-button:hover,mgt-login .login-button:hover{color:var(--button-color--hover,#0078d4);--color:var(--button-color--hover, #0078d4);background-color:var(--button-background-color--hover,var(--background-color--hover,#edebe9));--color-sub1:var(--button-color--hover, #0078d4)}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-button.no-click,mgt-login .login-button.no-click{pointer-events:none}:host .login-icon+span,mgt-login .login-icon+span{margin-left:6px}:host .popup,mgt-login .popup{font-family:var(--default-font-family);background-color:var(--popup-background-color,var(--background-color-sub1,#faf9f8));min-width:240px;z-index:1;color:var(--popup-color,#323130)}:host .popup mgt-person,mgt-login .popup mgt-person{--color-sub1:set-var(popup__color, $theme-default, $login)}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding)}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:#0078d4;background-color:var(--popup-background-color,var(--background-color-sub1,#faf9f8));border:none;padding:0;cursor:pointer;transition:color .3s}:host .popup-command:hover,mgt-login .popup-command:hover{color:#005a9e}[dir=rtl]{--popup-padding:24px 24px 16px 48px}[dir=rtl] mgt-person .details{--details-spacing:0px 12px 0px 0px}[dir=rtl] mgt-person .details.small{--details-spacing:0px 6px 0px 0px}
`],d={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out"};r("iNQq");var u=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};let f=class extends i.MgtTemplatedComponent{constructor(){super(),this._isFlyoutOpen=!1}static get styles(){return l}get strings(){return d}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...c.a.requiredScopes])]}connectedCallback(){super.connectedCallback(),this.addEventListener("click",e=>e.stopPropagation())}login(){return p(this,void 0,void 0,function*(){if(this.userDetails||!this.fireCustomEvent("loginInitiated"))return;const e=i.Providers.globalProvider;e&&e.login&&(yield e.login(),e.state===i.ProviderState.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))})}logout(){return p(this,void 0,void 0,function*(){if(!this.fireCustomEvent("logoutInitiated"))return;const e=i.Providers.globalProvider;e&&e.logout&&(yield e.logout(),this.userDetails=null,this.hideFlyout(),this.fireCustomEvent("logoutCompleted"))})}render(){return o.d`
      <div class="root" dir=${this.direction}>
        <div>
          ${this.renderButton()}
        </div>
        ${this.renderFlyout()}
      </div>
    `}loadState(){return p(this,void 0,void 0,function*(){const e=i.Providers.globalProvider;e&&!this.userDetails&&(e.state===i.ProviderState.SignedIn?(this.userDetails=yield Object(a.a)(e.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),this.fireCustomEvent("loginCompleted")):this.userDetails=null)})}renderButton(){const e={"login-button":!0,"no-click":this._isFlyoutOpen};return o.d`
      <button ?disabled="${this.isLoadingState}" @click=${this.onClick} class=${Object(n.a)(e)} role="button">
        ${this.renderButtonContent()}
      </button>
    `}renderFlyout(){return o.d`
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${()=>this._isFlyoutOpen=!0}
        @closed=${()=>this._isFlyoutOpen=!1}
      >
        <div slot="flyout">
          ${this.renderFlyoutContent()}
        </div>
      </mgt-flyout>
    `}renderFlyoutContent(){if(this.userDetails)return o.d`
      <div class="popup">
        <div class="popup-content">
          <div>
            ${this.renderFlyoutPersonDetails(this.userDetails,this._image)}
          </div>
          <div class="popup-commands">
            ${this.renderFlyoutCommands()}
          </div>
        </div>
      </div>
    `}renderFlyoutPersonDetails(e,t){return this.renderTemplate("flyout-person-details",{personDetails:e,personImage:t})||o.d`
        <mgt-person .personDetails=${e} .personImage=${t} .view=${s.a.twolines} />
      `}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||o.d`
        <ul>
          <li>
            <button class="popup-command" @click=${this.logout} aria-label="Sign Out">
              ${this.strings.signOutLinkSubtitle}
            </button>
          </li>
        </ul>
      `}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderSignedInButtonContent(e,t){return this.renderTemplate("signed-in-button-content",{personDetails:e,personImage:t})||o.d`
        <mgt-person .personDetails=${this.userDetails} .personImage=${this._image} .view=${s.a.oneline} />
      `}clearState(){this.userDetails=null,this._image=null}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||o.d`
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
        <span aria-label="Sign In">
          ${this.strings.signInLinkSubtitle}
        </span>
      `}showFlyout(){const e=this.flyout;e&&e.open()}hideFlyout(){const e=this.flyout;e&&e.close()}onClick(){this.userDetails?this.showFlyout():this.login()}};u([Object(o.f)({attribute:"user-details",type:Object}),h("design:type",Object)],f.prototype,"userDetails",void 0),u([Object(o.f)({attribute:!1}),h("design:type",Boolean)],f.prototype,"_isFlyoutOpen",void 0),f=u([Object(o.c)("mgt-login"),h("design:paramtypes",[])],f)},"4tA6":function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return u});var o=r("xD9d"),n=r("WCxG"),i=r("CQZ3"),s=r("PYfE"),a=r("Xzjw"),c=r("XEV4"),l=r("IMgd"),d=r("BelR");class u{static createWithAuthenticationProvider(t){const r=new n.a(t),o=new l.a(new a.a),h=new d.a,p=new i.a;if(r.setNext(o),"object"==typeof e){const e=new c.a(new s.a);o.setNext(e),e.setNext(h)}else o.setNext(h);return h.setNext(p),u.createWithMiddleware(r)}static createWithMiddleware(...e){return new o.a(...e)}}}).call(this,r("FXEK"))},"598n":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var o=r("cmRh"),n=r("o4Lv"),i=r("sh+J"),s=r("/vu6");function a(e,t,r){return a=this,void 0,l=function*(){let a,c,l=null,d=null;const u=t?"users/"+t:"me";let h=u+(r?"?$select="+r.toString():"");const p=t?["user.readbasic.all"]:["user.read"];if(Object(i.c)()){const e=o.CacheService.getCache(s.a.users,s.a.users.stores.users);c=yield e.getValue(t||"me"),c&&Object(i.f)()>Date.now()-c.timeCached?(d=c.user?JSON.parse(c.user):null,r&&r.filter(e=>!Object.keys(d).includes(e)).length>=1&&(d=null,c=null)):c=null}if(Object(n.a)())if(a=yield Object(n.d)(t||"me",s.a.photos.stores.users),a&&Object(n.e)()>Date.now()-a.timeCached)l=a.photo;else if(a)try{const r=yield e.api(u+"/photo").get();r&&r["@odata.mediaEtag"]&&r["@odata.mediaEtag"]===a.eTag?(Object(n.f)(t||"me",s.a.photos.stores.users,a),l=a.photo):a=null}catch(e){}if(a||c)if(a){if(!c){const r=yield e.api(h).middlewareOptions(Object(o.prepScopes)(...p)).get();r&&(Object(i.c)()&&o.CacheService.getCache(s.a.users,s.a.users.stores.users).putValue(t||"me",{user:JSON.stringify(r)}),d=r)}}else{const r=yield Object(n.c)(e,u,p);r&&(Object(n.a)()&&Object(n.f)(t||"me",s.a.photos.stores.users,{eTag:r.eTag,photo:r.photo}),l=r.photo)}else{let a;const c=e.createBatch();t?(c.get("user",`/users/${t}${r?"?$select="+r.toString():""}`,["user.readbasic.all"]),c.get("photo",`users/${t}/photo/$value`,["user.readbasic.all"])):(c.get("user","me",["user.read"]),c.get("photo","me/photo/$value",["user.read"]));const u=yield c.executeAll(),h=u.get("photo");h&&(a=h.headers.ETag,l=h.content);const p=u.get("user");p&&(d=p.content),Object(i.c)()&&o.CacheService.getCache(s.a.users,s.a.users.stores.users).putValue(t||"me",{user:JSON.stringify(d)}),Object(n.a)()&&Object(n.f)(t||"me",s.a.photos.stores.users,{eTag:a,photo:l})}return d&&(d.personImage=l),d},new((c=void 0)||(c=Promise))(function(e,t){function r(e){try{n(l.next(e))}catch(e){t(e)}}function o(e){try{n(l.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof c?n:new c(function(e){e(n)})).then(r,o)}n((l=l.apply(a,[])).next())});var a,c,l}},"5q4X":function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return i});var o,n=r("BdEk");!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(o||(o={}));class i{constructor(){this.featureUsage=o.NONE}static updateFeatureUsageFlag(e,t){let r;e.middlewareControl instanceof n.a?r=e.middlewareControl.getMiddlewareOptions(i):e.middlewareControl=new n.a,void 0===r&&(r=new i,e.middlewareControl.setMiddlewareOptions(i,r)),r.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}},"5tjQ":function(e,t,r){"use strict";r.d(t,"a",function(){return i});var o=r("zUnT"),n=r("b9Ts");class i{constructor(e,t){this._packageVersion=e,this._providerName=t}execute(e){return t=this,void 0,i=function*(){try{const t=[],r=e.middlewareControl.getMiddlewareOptions(n.a);if(r){const e=`${r.componentName}/${this._packageVersion}`;t.push(e)}if(this._providerName){const e=`${this._providerName}/${this._packageVersion}`;t.push(e)}const i="mgt/"+this._packageVersion;t.push(i),t.push(Object(o.d)(e.request,e.options,"SdkVersion"));const s=t.join(", ");Object(o.e)(e.request,e.options,"SdkVersion",s)}catch(e){}return yield this._nextMiddleware.execute(e)},new((r=void 0)||(r=Promise))(function(e,o){function n(e){try{a(i.next(e))}catch(e){o(e)}}function s(e){try{a(i.throw(e))}catch(e){o(e)}}function a(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r(function(e){e(o)})).then(n,s)}a((i=i.apply(t,[])).next())});var t,r,i}setNext(e){this._nextMiddleware=e}}},"8GBX":function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return n});const o={},n={}},"8d8z":function(e,t,r){"use strict";let o,n;r.d(t,"a",function(){return k}),r.d(t,"b",function(){return C});const i=new WeakMap,s=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap;let d={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return s.get(e);if("objectStoreNames"===t)return e.objectStoreNames||a.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return u(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function u(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,r)=>{const o=()=>{e.removeEventListener("success",n),e.removeEventListener("error",i)},n=()=>{t(u(e.result)),o()},i=()=>{r(e.error),o()};e.addEventListener("success",n),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&i.set(t,e)}).catch(()=>{}),l.set(t,e),t}(e);if(c.has(e))return c.get(e);const t=function(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(n||(n=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(h(this),e),u(i.get(this))}:function(...e){return u(t.apply(h(this),e))}:function(e,...r){const o=t.call(h(this),e,...r);return a.set(o,e.sort?e.sort():[e]),u(o)}:(e instanceof IDBTransaction&&function(e){if(s.has(e))return;const t=new Promise((t,r)=>{const o=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",i),e.removeEventListener("abort",i)},n=()=>{t(),o()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",n),e.addEventListener("error",i),e.addEventListener("abort",i)});s.set(e,t)}(e),r=e,(o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>r instanceof e)?new Proxy(e,d):e);var t,r}(e);return t!==e&&(c.set(e,t),l.set(t,e)),t}const h=e=>l.get(e),p=["get","getKey","getAll","getAllKeys","count"],f=["put","add","delete","clear"],g=new Map;function m(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(g.get(t))return g.get(t);const r=t.replace(/FromIndex$/,""),o=t!==r,n=f.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!n&&!p.includes(r))return;const i=async function(e,...t){const i=this.transaction(e,n?"readwrite":"readonly");let s=i.store;return o&&(s=s.index(t.shift())),(await Promise.all([s[r](...t),n&&i.done]))[0]};return g.set(t,i),i}var v;v=d,d={...v,get:(e,t,r)=>m(e,t)||v.get(e,t,r),has:(e,t)=>!!m(e,t)||v.has(e,t)};var b=r("ayeG"),y=r("ZMEg"),w=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};class k{static getCache(e,t){const r=`${e.name}/${t}`;return this.isInitialized||this.init(),this.cacheStore.has(t)||this.cacheStore.set(r,new C(e,t)),this.cacheStore.get(r)}static clearCaches(){this.cacheStore.forEach(e=>indexedDB.deleteDatabase(e.getDBName()))}static get config(){return this.cacheConfig}static init(){let e;b.a.globalProvider&&(e=b.a.globalProvider.state),b.a.onProviderUpdated(()=>{e===y.c.SignedIn&&b.a.globalProvider.state===y.c.SignedOut&&this.clearCaches(),e=b.a.globalProvider.state}),this.isInitialized=!0}}k.cacheStore=new Map,k.isInitialized=!1,k.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}};class C{constructor(e,t){if(!(t in e.stores))throw Error('"store" must be defined in the "schema"');this.schema=e,this.store=t}getValue(e){return w(this,void 0,void 0,function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,e)}catch(e){return null}})}putValue(e,t){return w(this,void 0,void 0,function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},t),{timeCached:Date.now()}),e)}catch(e){return}})}clearStore(){return w(this,void 0,void 0,function*(){if(window.indexedDB)try{(yield this.getDb()).clear(this.store)}catch(e){return}})}getDBName(){return"mgt-"+this.schema.name}getDb(){return function(e,t,{blocked:r,upgrade:o,blocking:n,terminated:i}={}){const s=indexedDB.open(e,t),a=u(s);return o&&s.addEventListener("upgradeneeded",e=>{o(u(s.result),e.oldVersion,e.newVersion,u(s.transaction))}),r&&s.addEventListener("blocked",()=>r()),a.then(e=>{i&&e.addEventListener("close",()=>i()),n&&e.addEventListener("versionchange",()=>n())}).catch(()=>{}),a}(this.getDBName(),this.schema.version,{upgrade:(e,t,r,o)=>{for(const t in this.schema.stores)this.schema.stores.hasOwnProperty(t)&&(e.objectStoreNames.contains(t)||e.createObjectStore(t))}})}}},"9iOx":function(e,t,r){"use strict";r.d(t,"a",function(){return c});var o=r("hkiJ"),n=r("/yih"),i=r("P7nI");const s=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:16px;color:var(--title-color-sub2,#797775)}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--background-color-sub2,#f3f2f1);border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item:hover{color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--color-sub2,#797775);margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--title-color-subtitle,#323130)}:host .root .data-list__item .data-list__item__date-range{color:var(--color-sub2,#797775);font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#0078d4}:host .root .work-position .work-position__location{font-size:10px;color:var(--color-sub2,#797775);line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--color-sub3,#979593)}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--color-sub1,#323130)}[dir=rtl] .token-list__item{margin-right:0!important}
`],a={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current"};let c=class extends n.a{constructor(e){super(),this.profile=e}static get styles(){return s}get strings(){return a}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get hasData(){if(!this.profile)return!1;const{languages:e,skills:t,positions:r,educationalActivities:o}=this.profile;return[this._birthdayAnniversary,this._personalInterests&&this._personalInterests.length,this._professionalInterests&&this._professionalInterests.length,e&&e.length,t&&t.length,r&&r.length,o&&o.length].filter(e=>!!e).length>0}get profile(){return this._profile}set profile(e){e!==this._profile&&(this._profile=e,this._birthdayAnniversary=e&&e.anniversaries?e.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=e&&e.interests?e.interests.filter(this.isPersonalInterest):null,this._professionalInterests=e&&e.interests?e.interests.filter(this.isProfessionalInterest):null)}renderIcon(){return Object(i.b)(i.a.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return o.d`
      <div class="root compact" dir=${this.direction}>
        ${this.renderSubSections().slice(0,2)}
      </div>
    `}renderFullView(){return this.initPostRenderOperations(),o.d`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.AboutCompactSectionTitle}</div>
        ${this.renderSubSections()}
      </div>
    `}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter(e=>!!e)}renderLanguages(){const{languages:e}=this._profile;if(!e||!e.length)return null;const t=[];for(const r of e){let e=null;r.proficiency&&r.proficiency.length&&(e=o.d`
          <span class="language__proficiency">
            &nbsp;(${r.proficiency})
          </span>
        `),t.push(o.d`
        <div class="token-list__item language">
          <span class="language__title">${r.displayName}</span>
          ${e}
        </div>
      `)}return o.d`
      <section>
        <div class="section__title">${this.strings.LanguagesSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${t}
          </div>
        </div>
      </section>
    `}renderSkills(){const{skills:e}=this._profile;if(!e||!e.length)return null;const t=[];for(const r of e)t.push(o.d`
        <div class="token-list__item skill">
          ${r.displayName}
        </div>
      `);return o.d`
      <section>
        <div class="section__title">${this.strings.SkillsSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${t}
          </div>
        </div>
      </section>
    `}renderWorkExperience(){var e,t,r,n,i,s,a,c,l;if(!this._profile||!this._profile.positions)return null;const d=[];for(const u of this._profile.positions)u.detail&&d.push(o.d`
          <div class="data-list__item work-position">
            <div class="data-list__item__header">
              <div class="data-list__item__title">${null===(e=u.detail)||void 0===e?void 0:e.jobTitle}</div>
              <div class="data-list__item__date-range">
                ${this.getDisplayDateRange(u.detail)}
              </div>
            </div>
            <div class="data-list__item__content">
              <div class="work-position__company">
                ${null===(r=null===(t=null==u?void 0:u.detail)||void 0===t?void 0:t.company)||void 0===r?void 0:r.displayName}
              </div>
              <div class="work-position__location">
                ${null===(s=null===(i=null===(n=null==u?void 0:u.detail)||void 0===n?void 0:n.company)||void 0===i?void 0:i.address)||void 0===s?void 0:s.city}, ${null===(l=null===(c=null===(a=null==u?void 0:u.detail)||void 0===a?void 0:a.company)||void 0===c?void 0:c.address)||void 0===l?void 0:l.state}
              </div>
            </div>
          </div>
        `);return o.d`
      <section>
        <div class="section__title">${this.strings.WorkExperienceSubSectionTitle}</div>
        <div class="section__content">
          <div class="data-list">
            ${d}
          </div>
        </div>
      </section>
    `}renderEducation(){const{educationalActivities:e}=this._profile;if(!e||!e.length)return null;const t=[];for(const r of e)t.push(o.d`
        <div class="data-list__item educational-activity">
          <div class="data-list__item__header">
            <div class="data-list__item__title">${r.institution.displayName}</div>
            <div class="data-list__item__date-range">
              ${this.getDisplayDateRange(r)}
            </div>
          </div>
          <div class="data-list__item__content">
            <div class="educational-activity__degree">
              ${r.program.displayName||"Bachelors Degree"}
            </div>
          </div>
        </div>
      `);return o.d`
      <section>
        <div class="section__title">${this.strings.EducationSubSectionTitle}</div>
        <div class="section__content">
          <div class="data-list">
            ${t}
          </div>
        </div>
      </section>
    `}renderProfessionalInterests(){if(!this._professionalInterests||!this._professionalInterests.length)return null;const e=[];for(const t of this._professionalInterests)e.push(o.d`
        <div class="token-list__item interest interest--professional">
          ${t.displayName}
        </div>
      `);return o.d`
      <section>
        <div class="section__title">${this.strings.professionalInterestsSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${e}
          </div>
        </div>
      </section>
    `}renderPersonalInterests(){if(!this._personalInterests||!this._personalInterests.length)return null;const e=[];for(const t of this._personalInterests)e.push(o.d`
        <div class="token-list__item interest interest--personal">
          ${t.displayName}
        </div>
      `);return o.d`
      <section>
        <div class="section__title">${this.strings.personalInterestsSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${e}
          </div>
        </div>
      </section>
    `}renderBirthday(){return this._birthdayAnniversary&&this._birthdayAnniversary.date?o.d`
      <section>
        <div class="section__title">Birthday</div>
        <div class="section__content">
          <div class="birthday">
            <div class="birthday__icon">
              ${Object(i.b)(i.a.Birthday)}
            </div>
            <div class="birthday__date">
              ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
            </div>
          </div>
        </div>
      </section>
    `:null}isPersonalInterest(e){return e.categories&&e.categories.includes("personal")}isProfessionalInterest(e){return e.categories&&e.categories.includes("professional")}isBirthdayAnniversary(e){return"birthday"===e.type}getDisplayDate(e){return e.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(e){const t=new Date(e.startMonthYear).getFullYear();return 0===t?null:`${t}  ${e.endMonthYear?new Date(e.endMonthYear).getFullYear():this.strings.currentYearSubtitle}`}initPostRenderOperations(){setTimeout(()=>{try{this.shadowRoot.querySelectorAll("section").forEach(e=>{this.handleTokenOverflow(e)})}catch(e){}},0)}handleTokenOverflow(e){const t=e.querySelectorAll(".token-list");if(t&&t.length)for(const e of Array.from(t)){const t=e.querySelectorAll(".token-list__item");if(!t||!t.length)continue;let r=null,o=t[0].getBoundingClientRect();const n=e.getBoundingClientRect(),i=2*o.height+n.top;for(let e=0;e<t.length-1;e++)if(o=t[e].getBoundingClientRect(),o.top>i){r=Array.from(t).slice(e,t.length);break}if(r){r.forEach(e=>e.classList.add("overflow"));const t=document.createElement("div");t.classList.add("token-list__item"),t.classList.add("token-list__item--show-overflow"),t.innerText=`+ ${r.length} more`,t.addEventListener("click",e=>{t.remove(),r.forEach(e=>e.classList.remove("overflow"))}),e.appendChild(t)}}}};c=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}([Object(o.c)("mgt-person-card-profile"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",t)}(0,[Object])],c)},BdEk:function(e,t,r){"use strict";r.d(t,"a",function(){return o});class o{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}},BelR:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var o=r("2cRh"),n=r("HCjR"),i=r("BdEk"),s=r("zUnT"),a=r("5q4X");class c{execute(e){return o.b(this,void 0,void 0,function*(){try{const t="string"==typeof e.request?e.request:e.request.url;if(Object(n.a)(t)){let t=Object(s.d)(e.request,e.options,c.CLIENT_REQUEST_ID_HEADER);t||(t=Object(s.c)(),Object(s.e)(e.request,e.options,c.CLIENT_REQUEST_ID_HEADER,t));let r,o=c.PRODUCT_NAME+"/2.2.1";if(e.middlewareControl instanceof i.a&&(r=e.middlewareControl.getMiddlewareOptions(a.b)),r){const e=r.getFeatureUsage();o+=` (${c.FEATURE_USAGE_STRING}=${e})`}Object(s.a)(e.request,e.options,c.SDK_VERSION_HEADER,o)}else delete e.options.headers[c.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[c.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}c.CLIENT_REQUEST_ID_HEADER="client-request-id",c.SDK_VERSION_HEADER="SdkVersion",c.PRODUCT_NAME="graph-js",c.FEATURE_USAGE_STRING="featureUsage"},Bmw4:function(e,t,r){"use strict";(function(e){r("WCxG"),r("CQZ3"),r("PYfE"),r("Xzjw"),r("XEV4"),r("IMgd"),r("BelR")}).call(this,r("FXEK"))},C0oe:function(e,t,r){"use strict";(function(e){var t=r("2cRh"),o=r("G6qX"),n=r("xUc+");class i extends o.a{constructor(e,t,r,o){super(e,t,r,o)}static constructCreateSessionUrl(e,t=i.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t="/"+t),"/"!==t[t.length-1]&&(t+="/"),`/me/drive/root:${t.split("/").map(e=>encodeURIComponent(e)).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static create(r,o,s){return t.b(this,void 0,void 0,function*(){const t=s.fileName;let a,c;if("undefined"!=typeof Blob&&o instanceof Blob)a=new File([o],t),c=a.size;else if("undefined"!=typeof File&&o instanceof File)a=o,c=a.size;else if(void 0!==e&&o instanceof e){const e=o;c=e.byteLength-e.byteOffset,a=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}try{const e=i.constructCreateSessionUrl(s.fileName,s.path),o=yield i.createUploadSession(r,e,s.fileName),l=Object(n.a)(s.rangeSize);return new i(r,{name:t,content:a,size:c},o,{rangeSize:l})}catch(e){throw e}})}static createUploadSession(e,r,o){const n=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return t.b(this,void 0,void 0,function*(){const t={item:{"@microsoft.graph.conflictBehavior":"rename",name:o}};try{return n.createUploadSession.call(this,e,r,t)}catch(e){throw e}})}commit(e){return t.b(this,void 0,void 0,function*(){try{const t={name:this.file.name,"@microsoft.graph.conflictBehavior":"rename","@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(t)}catch(e){throw e}})}}i.DEFAULT_UPLOAD_PATH="/"}).call(this,r("JX3P").Buffer)},CQZ3:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var o=r("2cRh");class n{execute(e){return o.b(this,void 0,void 0,function*(){try{return void(e.response=yield fetch(e.request,e.options))}catch(e){throw e}})}}},DpLM:function(e,t,r){"use strict";r.d(t,"b",function(){return a}),r.d(t,"a",function(){return c});var o=r("2RF3"),n=r("SkKE");const i=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),s=` ${n.f} `;class a{constructor(e,t,r,o){this.strings=e,this.values=t,this.type=r,this.processor=o}getHTML(){const e=this.strings.length-1;let t="",r=!1;for(let o=0;o<e;o++){const e=this.strings[o],i=e.lastIndexOf("\x3c!--");r=(i>-1||r)&&-1===e.indexOf("--\x3e",i+1);const a=n.e.exec(e);t+=null===a?e+(r?s:n.g):e.substr(0,a.index)+a[1]+a[2]+n.b+a[3]+n.f}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");let t=this.getHTML();return void 0!==i&&(t=i.createHTML(t)),e.innerHTML=t,e}}class c extends a{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const e=super.getTemplateElement(),t=e.content,r=t.firstChild;return t.removeChild(r),Object(o.c)(t,r.firstChild),e}}},EJ2E:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var o=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};class n{get value(){return this._value}get hasNext(){return!!this._nextLink}static create(e,t,r){return o(this,void 0,void 0,function*(){const o=yield t.get();if(o&&o.value){const t=new n;return t._graph=e,t._value=o.value,t._nextLink=o["@odata.nextLink"],t._version=r||e.version,t}return null})}static createFromValue(e,t,r){let o=new n;return o._graph=e,o._value=t,o._nextLink=r||null,o._version=e.version,o||null}next(){return o(this,void 0,void 0,function*(){if(this._nextLink){const e=this._nextLink.split(this._version)[1],t=yield this._graph.api(e).version(this._version).get();if(t&&t.value&&t.value.length)return this._value=this._value.concat(t.value),this._nextLink=t["@odata.nextLink"],t.value}return null})}}},"FIo/":function(e,t,r){"use strict";r.d(t,"a",function(){return f});var o=r("cmRh"),n=r("hkiJ"),i=r("JpLj"),s=r("t0JB"),a=(r("0Owk"),r("LgXN"));const c=[n.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242}:host{font-family:var(--default-font-family);font-size:var(--default-font-size)}:host .file-list-wrapper,mgt-file-item .file-list-wrapper{background-color:var(--file-list-background-color,#fff);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--file-list-border-radius,4px);border:var(--file-list-border,none);position:relative;color:var(--color-sub1,#323130);display:flex;flex-direction:column}:host .file-list-wrapper .file-list,mgt-file-item .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,4px 0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item,mgt-file-item .file-list-wrapper .file-list .file-item{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);margin:var(--file-item-margin,0 4px);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-list-wrapper .file-list .file-item mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item mgt-file{--file-background-color:$background-color}:host .file-list-wrapper .file-list .file-item.focused,:host .file-list-wrapper .file-list .file-item:hover,mgt-file-item .file-list-wrapper .file-list .file-item.focused,mgt-file-item .file-list-wrapper .file-list .file-item:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1))}:host .file-list-wrapper .file-list .file-item.focused mgt-file,:host .file-list-wrapper .file-list .file-item:hover mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.focused mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:hover mgt-file{--file-background-color:$file-item-background-color--hover}:host .file-list-wrapper .file-list .file-item.selected,:host .file-list-wrapper .file-list .file-item:active,mgt-file-item .file-list-wrapper .file-list .file-item.selected,mgt-file-item .file-list-wrapper .file-list .file-item:active{background-color:var(--file-item-background-color--active,rgba(0,0,0,.05))}:host .file-list-wrapper .file-list .file-item.selected mgt-file,:host .file-list-wrapper .file-list .file-item:active mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.selected mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:active mgt-file{--file-background-color:$file-item-background-color--active}:host .file-list-wrapper .show-more,mgt-file-item .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,6px);border-bottom-right-radius:var(--show-more-button-border-bottom-right-radius,4px);border-bottom-left-radius:var(--show-more-button-border-bottom-left-radius,4px);cursor:pointer;background-color:var(--show-more-button-background-color,var(--background-color-sub2,#f3f2f1))}:host .file-list-wrapper .show-more:hover,mgt-file-item .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color--hover,var(--file-item-background-color--hover,rgba(0,0,0,.1)))}
`],l={showMoreSubtitle:"Show more items"};var d=r("O3Bf"),u=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};let f=class extends o.MgtTemplatedComponent{constructor(){super(),this._focusedItemIndex=-1,this.pageSize=10,this.itemView=a.a.twolines,this._preloadedFiles=[]}static get styles(){return c}get strings(){return l}get fileListQuery(){return this._fileListQuery}set fileListQuery(e){e!==this._fileListQuery&&(this._fileListQuery=e,this.requestStateUpdate(!0))}get fileQueries(){return this._fileQueries}set fileQueries(e){Object(o.arraysAreEqual)(this._fileQueries,e)||(this._fileQueries=e,this.requestStateUpdate(!0))}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate(!0))}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate(!0))}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate(!0))}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate(!0))}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate(!0))}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate(!0))}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate(!0))}get fileExtensions(){return this._fileExtensions}set fileExtensions(e){Object(o.arraysAreEqual)(this._fileExtensions,e)||(this._fileExtensions=e,this.requestStateUpdate(!0))}get pageSize(){return this._pageSize}set pageSize(e){e!==this._pageSize&&(this._pageSize=e,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set([...d.a.requiredScopes])]}requestStateUpdate(e){return this.clearState(),super.requestStateUpdate(e)}clearState(){super.clearState(),this.files=null}render(){return!this.files&&this.isLoadingState?this.renderLoading():this.files&&0!==this.files.length?this.renderTemplate("default",{files:this.files})||this.renderFiles():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||n.d``}renderNoData(){return this.renderTemplate("no-data",null)||n.d``}renderFiles(){return n.d`
      <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
        <ul
          id="file-list"
          class="file-list"
          tabindex="0"
          @keydown="${this.onFileListKeyDown}"
          @keyup="${this.onFileListKeyUp}"
          @blur="${this.onFileListOut}"
        >
          ${Object(i.a)(this.files,e=>e.id,e=>n.d`
              <li class="file-item">
                ${this.renderFile(e)}
              </li>
            `)}
        </ul>
        ${!this.hideMoreFilesButton&&this.pageIterator&&(this.pageIterator.hasNext||this._preloadedFiles.length)?this.renderMoreFileButton():null}
      </div>
    `}renderFile(e){const t=this.itemView;return this.renderTemplate("file",{file:e},e.id)||n.d`
        <mgt-file .fileDetails=${e} .view=${t} @click=${t=>this.handleItemSelect(e,t)}></mgt-file>
      `}renderMoreFileButton(){return this.isLoadingState?n.d`
        <mgt-spinner></mgt-spinner>
      `:n.d`<a id="show-more" class="show-more" @click=${()=>this.renderNextPage()} tabindex="0" @keydown=${this.onShowMoreKeyDown}><span>${this.strings.showMoreSubtitle}<span></a>`}onShowMoreKeyDown(e){e&&"Enter"===e.code&&(e.preventDefault(),this.renderNextPage())}onFileListKeyUp(e){const t=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];"Enter"!==e.code&&"Space"!==e.code||(e.preventDefault(),null==t||t.classList.remove("selected"),null==t||t.classList.add("focused"))}onFileListKeyDown(e){const t=this.renderRoot.querySelector(".file-list");let r;if(t&&t.children.length){if("ArrowUp"!==e.code&&"ArrowDown"!==e.code||("ArrowUp"===e.code&&(-1===this._focusedItemIndex&&(this._focusedItemIndex=t.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+t.children.length)%t.children.length),"ArrowDown"===e.code&&(this._focusedItemIndex=(this._focusedItemIndex+1)%t.children.length),r=t.children[this._focusedItemIndex],this.updateItemBackgroundColor(t,r,"focused")),"Enter"===e.code||"Space"===e.code){r=t.children[this._focusedItemIndex];const o=r.children[0];e.preventDefault(),this.fireCustomEvent("itemClick",o.fileDetails),this.updateItemBackgroundColor(t,r,"selected")}"Tab"===e.code&&(r=t.children[this._focusedItemIndex],null==r||r.classList.remove("focused"))}}onFileListOut(){const e=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];null==e||e.classList.remove("focused")}loadState(){return p(this,void 0,void 0,function*(){const e=o.Providers.globalProvider;if(!e||e.state===o.ProviderState.Loading)return;if(e.state===o.ProviderState.SignedOut)return void(this.files=null);const t=e.graph.forComponent(this);let r,n;const i=!(this.driveId||this.siteId||this.groupId||this.userId);if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),!this.files){let e;if(this.fileListQuery?n=yield Object(s.i)(t,this.fileListQuery,this.pageSize):this.fileQueries?r=yield Object(s.k)(t,this.fileQueries):i?this.itemId?n=yield Object(s.h)(t,this.itemId,this.pageSize):this.itemPath?n=yield Object(s.j)(t,this.itemPath,this.pageSize):this.insightType?r=yield Object(s.u)(t,this.insightType):n=yield Object(s.l)(t,this.pageSize):this.driveId?this.itemId?n=yield Object(s.c)(t,this.driveId,this.itemId,this.pageSize):this.itemPath&&(n=yield Object(s.d)(t,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?n=yield Object(s.o)(t,this.groupId,this.itemId,this.pageSize):this.itemPath&&(n=yield Object(s.p)(t,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?n=yield Object(s.x)(t,this.siteId,this.itemId,this.pageSize):this.itemPath&&(n=yield Object(s.y)(t,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?n=yield Object(s.B)(t,this.userId,this.itemId,this.pageSize):this.itemPath?n=yield Object(s.C)(t,this.userId,this.itemPath,this.pageSize):this.insightType&&(r=yield Object(s.E)(t,this.userId,this.insightType))),n&&(this.pageIterator=n,this._preloadedFiles=[...this.pageIterator.value],r=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),this.fileExtensions&&null!==this.fileExtensions){if(this.pageIterator&&this.pageIterator.value){for(;this.pageIterator.hasNext;)yield Object(s.b)(this.pageIterator);r=this.pageIterator.value,this._preloadedFiles=[]}e=r.filter(e=>{for(const t of this.fileExtensions)if(t==this.getFileExtension(e.name))return e})}e&&e.length>=0?this.files=e:this.files=r}})}handleItemSelect(e,t){if(this.fireCustomEvent("itemClick",e),t){const e=this.renderRoot.querySelector(".file-list"),r=Array.from(e.children),o=t.target.closest("li"),n=r.indexOf(o);this._focusedItemIndex=n;for(let t=0;t<e.children.length;t++)e.children[t].classList.remove("focused")}}renderNextPage(){return p(this,void 0,void 0,function*(){const e=this.renderRoot.querySelector("file-list-wrapper");e&&e.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this._preloadedFiles.length>0?this.files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))]:this.pageIterator.hasNext&&(yield Object(s.b)(this.pageIterator),this.files=this.pageIterator.value),this.requestUpdate()})}getFileExtension(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}updateItemBackgroundColor(e,t,r){for(let t=0;t<e.children.length;t++)e.children[t].classList.remove(r);t&&(t.classList.add(r),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}reload(e=!1){e&&Object(s.a)(),this.requestStateUpdate(!0)}};u([Object(n.f)({attribute:"file-list-query"}),h("design:type",String),h("design:paramtypes",[String])],f.prototype,"fileListQuery",null),u([Object(n.f)({attribute:"file-queries",converter:(e,t)=>e?e.split(",").map(e=>e.trim()):null}),h("design:type",Array),h("design:paramtypes",[Array])],f.prototype,"fileQueries",null),u([Object(n.f)({type:Object}),h("design:type",Array)],f.prototype,"files",void 0),u([Object(n.f)({attribute:"site-id"}),h("design:type",String),h("design:paramtypes",[String])],f.prototype,"siteId",null),u([Object(n.f)({attribute:"drive-id"}),h("design:type",String),h("design:paramtypes",[String])],f.prototype,"driveId",null),u([Object(n.f)({attribute:"group-id"}),h("design:type",String),h("design:paramtypes",[String])],f.prototype,"groupId",null),u([Object(n.f)({attribute:"item-id"}),h("design:type",String),h("design:paramtypes",[String])],f.prototype,"itemId",null),u([Object(n.f)({attribute:"item-path"}),h("design:type",String),h("design:paramtypes",[String])],f.prototype,"itemPath",null),u([Object(n.f)({attribute:"user-id"}),h("design:type",String),h("design:paramtypes",[String])],f.prototype,"userId",null),u([Object(n.f)({attribute:"insight-type"}),h("design:type",String),h("design:paramtypes",[String])],f.prototype,"insightType",null),u([Object(n.f)({attribute:"item-view",converter:e=>e&&0!==e.length?(e=e.toLowerCase(),void 0===a.a[e]?a.a.threelines:a.a[e]):a.a.threelines}),h("design:type",Number)],f.prototype,"itemView",void 0),u([Object(n.f)({attribute:"file-extensions",converter:(e,t)=>e.split(",").map(e=>e.trim())}),h("design:type",Array),h("design:paramtypes",[Array])],f.prototype,"fileExtensions",null),u([Object(n.f)({attribute:"page-size",type:Number}),h("design:type",Number),h("design:paramtypes",[Number])],f.prototype,"pageSize",null),u([Object(n.f)({attribute:"hide-more-files-button",type:Boolean}),h("design:type",Boolean)],f.prototype,"hideMoreFilesButton",void 0),f=u([Object(n.c)("mgt-file-list"),h("design:paramtypes",[])],f)},FsVS:function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return i});var o=r("2cRh"),n=r("vY9u");class i{constructor(e){if(this.requests=new Map,void 0!==e){const t=i.requestLimit;if(e.length>t){const e=new Error("Maximum requests limit exceeded, Max allowed number of requests are "+t);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let r=t.next();for(;!r.done;){const e=r.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const o=r.value[1];if(void 0!==o.dependsOn&&o.dependsOn.length>0)return!1;let n=r;for(r=t.next();!r.done;){const e=r.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==n.value[1].id)return!1;n=r,r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const o=r.value[1];let n;if(void 0===o.dependsOn||0===o.dependsOn.length)n=o.id;else{if(1!==o.dependsOn.length)return!1;{const t=o.dependsOn[0];if(t===o.id||!e.has(t))return!1;n=t}}for(r=t.next();!r.done;){const e=r.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&n!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===n||e.dependsOn[0]!==n))return!1;if(e.dependsOn.length>1)return!1}r=t.next()}return!0})(e)}static getRequestData(e){return o.b(this,void 0,void 0,function*(){const t={url:""},r=new RegExp("^https?://");t.url=r.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const o={};return e.headers.forEach((e,t)=>{o[t]=e}),Object.keys(o).length&&(t.headers=o),e.method!==n.a.PATCH&&e.method!==n.a.POST&&e.method!==n.a.PUT||(t.body=yield i.getRequestBody(e)),t})}static getRequestBody(t){return o.b(this,void 0,void 0,function*(){let r,o=!1;try{const e=t.clone();r=yield e.json(),o=!0}catch(e){}if(!o)try{if("undefined"!=typeof Blob){const e=yield t.blob(),o=new FileReader;r=yield new Promise(t=>{o.addEventListener("load",()=>{const e=o.result,r=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(e);t(r[4])},!1),o.readAsDataURL(e)})}else void 0!==e&&(r=(yield t.buffer()).toString("base64"));o=!0}catch(e){}return r})}addRequest(e){const t=i.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error("Maximum requests limit exceeded, Max allowed number of requests are "+t);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),r=this.requests.entries();let o=r.next();for(;!o.done;){const t=o.value[1].dependsOn;if(void 0!==t){const r=t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&delete o.value[1].dependsOn}o=r.next()}return t}getContent(){return o.b(this,void 0,void 0,function*(){const e=[],t={requests:e},r=this.requests.entries();let o=r.next();if(o.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!i.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!o.done;){const t=o.value[1],n=yield i.getRequestData(t.request);if(void 0!==n.body&&(void 0===n.headers||void 0===n.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}n.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(n.dependsOn=t.dependsOn),e.push(n),o=r.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const r=this.requests.get(e);if(void 0===r.dependsOn&&(r.dependsOn=[]),-1!==r.dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}r.dependsOn.push(t)}else{const r=this.requests.entries();let o,n=r.next();for(;!n.done&&n.value[1].id!==e;)o=n,n=r.next();if(void 0===o){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=o.value[0];if(void 0===n.value[1].dependsOn&&(n.value[1].dependsOn=[]),-1!==n.value[1].dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}n.value[1].dependsOn.push(t)}}}removeDependency(e,t){const r=this.requests.get(e);if(void 0===r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if(void 0!==t){const e=r.dependsOn.indexOf(t);return-1!==e&&(r.dependsOn.splice(e,1),!0)}return delete r.dependsOn,!0}}i.requestLimit=20}).call(this,r("JX3P").Buffer)},G6qX:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var o=r("2cRh");class n{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class i{constructor(e,t,r,o={}){this.DEFAULT_FILE_SIZE=5242880,this.client=e,this.file=t,void 0===o.rangeSize&&(o.rangeSize=this.DEFAULT_FILE_SIZE),this.options=o,this.uploadSession=r,this.nextRange=new n(0,this.options.rangeSize-1)}static createUploadSession(e,t,r,n={}){return o.b(this,void 0,void 0,function*(){try{const o=yield e.api(t).headers(n).post(r);return{url:o.uploadUrl,expiry:new Date(o.expirationDateTime)}}catch(e){throw e}})}parseRange(e){const t=e[0];if(void 0===t||""===t)return new n;const r=t.split("-"),o=parseInt(r[0],10);let i=parseInt(r[1],10);return Number.isNaN(i)&&(i=this.file.size-1),new n(o,i)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new n(e,t)}sliceFile(e){return this.file.content.slice(e.minValue,e.maxValue+1)}upload(){return o.b(this,void 0,void 0,function*(){try{for(;;){const e=this.getNextRange();if(-1===e.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const t=this.sliceFile(e),r=yield this.uploadSlice(t,e,this.file.size);if(void 0!==r.id)return r;this.updateTaskStatus(r)}}catch(e){throw e}})}uploadSlice(e,t,r){return o.b(this,void 0,void 0,function*(){try{return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${r}`}).put(e)}catch(e){throw e}})}cancel(){return o.b(this,void 0,void 0,function*(){try{return yield this.client.api(this.uploadSession.url).delete()}catch(e){throw e}})}getStatus(){return o.b(this,void 0,void 0,function*(){try{const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}catch(e){throw e}})}resume(){return o.b(this,void 0,void 0,function*(){try{return yield this.getStatus(),yield this.upload()}catch(e){throw e}})}}},GogD:function(e,t,r){"use strict";function o(e,t){return function e(t,r,o){const n=Object.prototype.toString.call(t),i=Object.prototype.toString.call(r);if(n===i&&"[object Object]"===n&&!o.has(t)){o.add(t);for(const n in t)if(!e(t[n],r[n],o))return!1;for(const e in r)if(!t.hasOwnProperty(e))return!1;return!0}if(n===i&&"[object Array]"===n&&!o.has(t)){if(o.add(t),t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n],o))return!1;return!0}return t===r}(e,t,new Set)}function n(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;if(0===e.length)return!0;const r=new Set(e);for(const e of t)if(!r.has(e))return!1;return!0}r.d(t,"b",function(){return o}),r.d(t,"a",function(){return n})},HCjR:function(e,t,r){"use strict";(function(e){r.d(t,"b",function(){return n}),r.d(t,"d",function(){return i}),r.d(t,"c",function(){return s}),r.d(t,"a",function(){return a});var o=r("mV2a");const n=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],i=e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce((e,r)=>{return[(o=e,o.replace(/\/+$/,"")),t(r)].join("/");var o})},s=t=>{const r=t&&t.constructor&&t.constructor.name;if("Buffer"===r||"Blob"===r||"File"===r||"FormData"===r||"string"==typeof t)return t;if("ArrayBuffer"===r)t=e.from(t);else if("Int8Array"===r||"Int16Array"===r||"Int32Array"===r||"Uint8Array"===r||"Uint16Array"===r||"Uint32Array"===r||"Uint8ClampedArray"===r||"Float32Array"===r||"Float64Array"===r||"DataView"===r)t=e.from(t.buffer);else try{t=JSON.stringify(t)}catch(e){throw new Error("Unable to stringify the content")}return t},a=e=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const t=(e=e.replace("https://","")).indexOf(":"),r=e.indexOf("/");let n="";if(-1!==r)return-1!==t&&t<r?(n=e.substring(0,t),o.c.has(n)):(n=e.substring(0,r),o.c.has(n))}return!1}}).call(this,r("JX3P").Buffer)},IMgd:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var o=r("2cRh"),n=r("vY9u"),i=r("BdEk"),s=r("zUnT"),a=r("Xzjw"),c=r("5q4X");class l{constructor(e=new a.a){this.options=e}isRetry(e){return-1!==l.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const r="string"==typeof e?t.method:e.method;return r!==n.a.PUT&&r!==n.a.PATCH&&r!==n.a.POST||"application/octet-stream"!==Object(s.d)(e,t,"Content-Type")}getDelay(e,t,r){const o=()=>Number(Math.random().toFixed(3)),n=void 0!==e.headers?e.headers.get(l.RETRY_AFTER_HEADER):null;let i;return i=null!==n?Number.isNaN(Number(n))?Math.round((new Date(n).getTime()-Date.now())/1e3):Number(n):t>=2?this.getExponentialBackOffTime(t)+r+o():r+o(),Math.min(i,this.options.getMaxDelay()+o())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return o.b(this,void 0,void 0,function*(){const t=1e3*e;return new Promise(e=>setTimeout(e,t))})}getOptions(e){let t;return e.middlewareControl instanceof i.a&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new a.a,this.options)),t}executeWithRetry(e,t,r){return o.b(this,void 0,void 0,function*(){try{if(yield this.nextMiddleware.execute(e),t<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,t,e.request,e.options,e.response)){++t,Object(s.e)(e.request,e.options,l.RETRY_ATTEMPT_HEADER,t.toString());const o=this.getDelay(e.response,t,r.delay);return yield this.sleep(o),yield this.executeWithRetry(e,t,r)}return}catch(e){throw e}})}execute(e){return o.b(this,void 0,void 0,function*(){try{const t=0,r=this.getOptions(e);return c.b.updateFeatureUsageFlag(e,c.a.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,t,r)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}l.RETRY_STATUS_CODES=[429,503,504],l.RETRY_ATTEMPT_HEADER="Retry-Attempt",l.RETRY_AFTER_HEADER="Retry-After"},IVvM:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var o=r("0i3K");class n{constructor(e){this.classes=new Set,this.changed=!1,this.element=e;const t=(e.getAttribute("class")||"").split(/\s+/);for(const e of t)this.classes.add(e)}add(e){this.classes.add(e),this.changed=!0}remove(e){this.classes.delete(e),this.changed=!0}commit(){if(this.changed){let e="";this.classes.forEach(t=>e+=t+" "),this.element.setAttribute("class",e)}}}const i=new WeakMap,s=Object(o.e)(e=>t=>{if(!(t instanceof o.a)||t instanceof o.c||"class"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:r}=t,{element:s}=r;let a=i.get(t);void 0===a&&(s.setAttribute("class",r.strings.join(" ")),i.set(t,a=new Set));const c=s.classList||new n(s);a.forEach(t=>{t in e||(c.remove(t),a.delete(t))});for(const t in e){const r=e[t];r!=a.has(t)&&(r?(c.add(t),a.add(t)):(c.remove(t),a.delete(t)))}"function"==typeof c.commit&&c.commit()})},J0Kn:function(e,t,r){"use strict";r.d(t,"c",function(){return n.a}),r.d(t,"a",function(){return i.a}),r.d(t,"e",function(){return s.a}),r.d(t,"g",function(){return a.a}),r.d(t,"i",function(){return c.a}),r.d(t,"b",function(){return l.a}),r.d(t,"h",function(){return d.a}),r.d(t,"d",function(){return E}),r.d(t,"f",function(){return v});var o,n=r("FsVS"),i=r("WCxG"),s=r("CQZ3"),a=r("IMgd"),c=(r("XEV4"),r("BelR")),l=(r("Bmw4"),r("ghBn")),d=r("Xzjw");r("PYfE"),r("5q4X"),function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(o||(o={}));var u=r("2cRh"),h=r("BdEk");r("zUnT"),r("G6qX"),r("C0oe");var p=r("mV2a");class f{constructor(e){this.provider=e}getAccessToken(){return u.b(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((r,o)=>{o?e(o):t(r)})})})}}class g extends Error{constructor(e=-1,t,r){super(t||r&&r.message),Object.setPrototypeOf(this,g.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=r?r.stack:this.stack}}class m{static constructError(e,t){const r=new g(t,"",e);return void 0!==e.name&&(r.code=e.name),r.body=e.toString(),r.date=new Date,r}static constructErrorFromResponse(e,t){e=e.error;const r=new g(t,e.message);r.code=e.code,void 0!==e.innerError&&(r.requestId=e.innerError["request-id"],r.date=new Date(e.innerError.date));try{r.body=JSON.stringify(e)}catch(e){}return r}static getError(e=null,t=-1,r){return u.b(this,void 0,void 0,function*(){let o;if(o=e&&e.error?m.constructErrorFromResponse(e,t):"undefined"!=typeof Error&&e instanceof Error?m.constructError(e,t):new g(t),"function"!=typeof r)return o;r(o,null)})}}var v,b,y,w,k=r("HCjR");!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(v||(v={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(b||(b={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(y||(y={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(w||(w={}));class C{static parseDocumentResponse(e,t){try{return"undefined"!=typeof DOMParser?new Promise((r,o)=>{e.text().then(e=>{try{const o=(new DOMParser).parseFromString(e,t);r(o)}catch(e){o(e)}})}):Promise.resolve(e.body)}catch(e){throw e}}static convertResponse(e,t){return u.b(this,void 0,void 0,function*(){if(204===e.status)return Promise.resolve();let r;try{switch(t){case v.ARRAYBUFFER:r=yield e.arrayBuffer();break;case v.BLOB:r=yield e.blob();break;case v.DOCUMENT:r=yield C.parseDocumentResponse(e,b.TEXT_XML);break;case v.JSON:r=yield e.json();break;case v.STREAM:r=yield Promise.resolve(e.body);break;case v.TEXT:r=yield e.text();break;default:const t=e.headers.get("Content-type");if(null!==t){const o=t.split(";")[0];r=new RegExp(w.DOCUMENT).test(o)?yield C.parseDocumentResponse(e,o):new RegExp(w.IMAGE).test(o)?e.blob():o===y.TEXT_PLAIN?yield e.text():o===y.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else r=Promise.resolve(e.body)}}catch(e){throw e}return r})}static getResponse(e,t,r){return u.b(this,void 0,void 0,function*(){try{if(t===v.RAW)return Promise.resolve(e);{const o=yield C.convertResponse(e,t);if(!e.ok)throw o;if("function"!=typeof r)return o;r(null,o)}}catch(e){throw e}})}}var T=r("vY9u");class S{constructor(e,t,r){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const r=e.indexOf("/");-1!==r&&(this.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const r=e.substring(t+1,e.length).split("&");for(const e of r)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let o=[];r.length>1&&"string"==typeof t?o=Array.prototype.slice.call(r):"string"==typeof t?o.push(t):o=o.concat(t),this.urlComponents.oDataQueryParams[e]+=o.join(",")}buildFullUrl(){const e=Object(k.d)([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const r in e.oDataQueryParams)e.oDataQueryParams.hasOwnProperty(r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const r in e.otherURLQueryParams)e.otherURLQueryParams.hasOwnProperty(r)&&t.push(r+"="+e.otherURLQueryParams[r]);if(0!==e.otherURLQueryOptions.length)for(const r of e.otherURLQueryOptions)t.push(r);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)e.hasOwnProperty(t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),r=e.substring(0,t),o=e.substring(t+1);this.setURLComponentsQueryParamater(r,o)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==k.b.indexOf(e)){const r=this.urlComponents.oDataQueryParams[e],o=r&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=o?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,r){return u.b(this,void 0,void 0,function*(){let o;const n=new h.a(this._middlewareOptions);this.updateRequestOptions(t);try{return o=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:n})).response,yield C.getResponse(o,this._responseType,r)}catch(e){let t;throw void 0!==o&&(t=o.status),yield m.getError(e,t,r)}})}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)e.hasOwnProperty(t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!1){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return u.b(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:T.a.GET};try{return yield this.send(t,r,e)}catch(e){throw e}})}post(e,t){return u.b(this,void 0,void 0,function*(){const r=this.buildFullUrl(),o={method:T.a.POST,body:Object(k.c)(e)};"FormData"===(e&&e.constructor&&e.constructor.name)?o.headers={}:(this.setHeaderContentType(),o.headers=this._headers);try{return yield this.send(r,o,t)}catch(e){throw e}})}create(e,t){return u.b(this,void 0,void 0,function*(){try{return yield this.post(e,t)}catch(e){throw e}})}put(e,t){return u.b(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const o={method:T.a.PUT,body:Object(k.c)(e)};try{return yield this.send(r,o,t)}catch(e){throw e}})}patch(e,t){return u.b(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const o={method:T.a.PATCH,body:Object(k.c)(e)};try{return yield this.send(r,o,t)}catch(e){throw e}})}update(e,t){return u.b(this,void 0,void 0,function*(){try{return yield this.patch(e,t)}catch(e){throw e}})}delete(e){return u.b(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:T.a.DELETE};try{return yield this.send(t,r,e)}catch(e){throw e}})}del(e){return u.b(this,void 0,void 0,function*(){try{return yield this.delete(e)}catch(e){throw e}})}getStream(e){return u.b(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:T.a.GET};this.responseType(v.STREAM);try{return yield this.send(t,r,e)}catch(e){throw e}})}putStream(e,t){return u.b(this,void 0,void 0,function*(){const r=this.buildFullUrl(),o={method:T.a.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};try{return yield this.send(r,o,t)}catch(e){throw e}})}}var _=r("xD9d"),I=r("4tA6");class E{constructor(e){this.config={baseUrl:p.b,debugLogging:!1,defaultVersion:p.a};try{(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})()}catch(e){throw e}for(const t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=I.a.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new _.a(...[].concat(e.middleware))}this.httpClient=t}static init(e){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[r]="authProvider"===r?new f(e[r]):e[r]);return E.initWithMiddleware(t)}static initWithMiddleware(e){try{return new E(e)}catch(e){throw e}}api(e){return new S(this.httpClient,this.config,e)}}r("Vcri")},JX3P:function(e,t,r){"use strict";(function(e){var o=r("ykqw"),n=r("/IPs"),i=r("8knM");function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return l(this,e,t,r)}function l(e,t,r,o){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,o){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(o||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===o?new Uint8Array(t):void 0===o?new Uint8Array(t,r):new Uint8Array(t,r,o),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t),e}(e,t,r,o):"string"==typeof t?function(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var o=0|f(t,r),n=(e=a(e,o)).write(t,r);return n!==o&&(e=e.slice(0,n)),e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|p(t.length);return 0===(e=a(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(o=t.length)!=o?a(e,0):h(e,t);if("Buffer"===t.type&&i(t.data))return h(e,t.data)}var o;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(d(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t){var r=t.length<0?0:0|p(t.length);e=a(e,r);for(var o=0;o<r;o+=1)e[o]=255&t[o];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return F(e).length;default:if(o)return H(e).length;t=(""+t).toLowerCase(),o=!0}}function g(e,t,r){var o=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return E(this,t,r);case"latin1":case"binary":return x(this,t,r);case"base64":return _(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,r);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function m(e,t,r){var o=e[t];e[t]=e[r],e[r]=o}function v(e,t,r,o,n){if(0===e.length)return-1;if("string"==typeof r?(o=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=c.from(t,o)),c.isBuffer(t))return 0===t.length?-1:b(e,t,r,o,n);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,o,n);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,o,n){var i,s=1,a=e.length,c=t.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(n){var d=-1;for(i=r;i<a;i++)if(l(e,i)===l(t,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===c)return d*s}else-1!==d&&(i-=i-d),d=-1}else for(r+c>a&&(r=a-c),i=r;i>=0;i--){for(var u=!0,h=0;h<c;h++)if(l(e,i+h)!==l(t,h)){u=!1;break}if(u)return i}return-1}function y(e,t,r,o){r=Number(r)||0;var n=e.length-r;o?(o=Number(o))>n&&(o=n):o=n;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");o>i/2&&(o=i/2);for(var s=0;s<o;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function w(e,t,r,o){return q(H(t,e.length-r),e,r,o)}function k(e,t,r,o){return q(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,o)}function C(e,t,r,o){return k(e,t,r,o)}function T(e,t,r,o){return q(F(t),e,r,o)}function S(e,t,r,o){return q(function(e,t){for(var r,o,n,i=[],s=0;s<e.length&&!((t-=2)<0);++s)o=(r=e.charCodeAt(s))>>8,n=r%256,i.push(n),i.push(o);return i}(t,e.length-r),e,r,o)}function _(e,t,r){return 0===t&&r===e.length?o.fromByteArray(e):o.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);for(var o=[],n=t;n<r;){var i,s,a,c,l=e[n],d=null,u=l>239?4:l>223?3:l>191?2:1;if(n+u<=r)switch(u){case 1:l<128&&(d=l);break;case 2:128==(192&(i=e[n+1]))&&(c=(31&l)<<6|63&i)>127&&(d=c);break;case 3:i=e[n+1],s=e[n+2],128==(192&i)&&128==(192&s)&&(c=(15&l)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(d=c);break;case 4:i=e[n+1],s=e[n+2],a=e[n+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&l)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(d=c)}null===d?(d=65533,u=1):d>65535&&(d-=65536,o.push(d>>>10&1023|55296),d=56320|1023&d),o.push(d),n+=u}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var r="",o=0;o<t;)r+=String.fromCharCode.apply(String,e.slice(o,o+=4096));return r}(o)}function E(e,t,r){var o="";r=Math.min(e.length,r);for(var n=t;n<r;++n)o+=String.fromCharCode(127&e[n]);return o}function x(e,t,r){var o="";r=Math.min(e.length,r);for(var n=t;n<r;++n)o+=String.fromCharCode(e[n]);return o}function O(e,t,r){var o,n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=t;s<r;++s)i+=(o=e[s])<16?"0"+o.toString(16):o.toString(16);return i}function A(e,t,r){for(var o=e.slice(t,r),n="",i=0;i<o.length;i+=2)n+=String.fromCharCode(o[i]+256*o[i+1]);return n}function R(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,r,o,n,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<i)throw new RangeError('"value" argument is out of bounds');if(r+o>e.length)throw new RangeError("Index out of range")}function N(e,t,r,o){t<0&&(t=65535+t+1);for(var n=0,i=Math.min(e.length-r,2);n<i;++n)e[r+n]=(t&255<<8*(o?n:1-n))>>>8*(o?n:1-n)}function D(e,t,r,o){t<0&&(t=4294967295+t+1);for(var n=0,i=Math.min(e.length-r,4);n<i;++n)e[r+n]=t>>>8*(o?n:3-n)&255}function L(e,t,r,o,n,i){if(r+o>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(e,t,r,o,i){return i||L(e,0,r,4),n.write(e,t,r,o,23,4),r+4}function M(e,t,r,o,i){return i||L(e,0,r,8),n.write(e,t,r,o,52,8),r+8}t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return l(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,o){return d(t),t<=0?a(null,t):void 0!==r?"string"==typeof o?a(null,t).fill(r,o):a(null,t).fill(r):a(null,t)}(0,e,t,r)},c.allocUnsafe=function(e){return u(null,e)},c.allocUnsafeSlow=function(e){return u(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,o=t.length,n=0,i=Math.min(r,o);n<i;++n)if(e[n]!==t[n]){r=e[n],o=t[n];break}return r<o?-1:o<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var o=c.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var s=e[r];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(o,n),n+=s.length}return o},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,r,o,n){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===o&&(o=0),void 0===n&&(n=this.length),t<0||r>e.length||o<0||n>this.length)throw new RangeError("out of range index");if(o>=n&&t>=r)return 0;if(o>=n)return-1;if(t>=r)return 1;if(this===e)return 0;for(var i=(n>>>=0)-(o>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(i,s),l=this.slice(o,n),d=e.slice(t,r),u=0;u<a;++u)if(l[u]!==d[u]){i=l[u],s=d[u];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},c.prototype.write=function(e,t,r,o){if(void 0===t)o="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)o=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===o&&(o="utf8")):(o=r,r=void 0)}var n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":return k(this,e,t,r);case"latin1":case"binary":return C(this,e,t,r);case"base64":return T(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},c.prototype.slice=function(e,t){var r,o=this.length;if((e=~~e)<0?(e+=o)<0&&(e=0):e>o&&(e=o),(t=void 0===t?o:~~t)<0?(t+=o)<0&&(t=0):t>o&&(t=o),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var n=t-e;r=new c(n,void 0);for(var i=0;i<n;++i)r[i]=this[i+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var o=this[e],n=1,i=0;++i<t&&(n*=256);)o+=this[e+i]*n;return o},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var o=this[e+--t],n=1;t>0&&(n*=256);)o+=this[e+--t]*n;return o},c.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var o=this[e],n=1,i=0;++i<t&&(n*=256);)o+=this[e+i]*n;return o>=(n*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var o=t,n=1,i=this[e+--o];o>0&&(n*=256);)i+=this[e+--o]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),n.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),n.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),n.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),n.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,o){e=+e,t|=0,r|=0,o||P(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,i=0;for(this[t]=255&e;++i<r&&(n*=256);)this[t+i]=e/n&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,o){e=+e,t|=0,r|=0,o||P(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,i=1;for(this[t+n]=255&e;--n>=0&&(i*=256);)this[t+n]=e/i&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,o){if(e=+e,t|=0,!o){var n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}var i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},c.prototype.writeIntBE=function(e,t,r,o){if(e=+e,t|=0,!o){var n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}var i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return U(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return U(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return M(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return M(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,o){if(r||(r=0),o||0===o||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),o>0&&o<r&&(o=r),o===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-r&&(o=e.length-t+r);var n,i=o-r;if(this===e&&r<t&&t<o)for(n=i-1;n>=0;--n)e[n+t]=this[n+r];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(n=0;n<i;++n)e[n+t]=this[n+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},c.prototype.fill=function(e,t,r,o){if("string"==typeof e){if("string"==typeof t?(o=t,t=0,r=this.length):"string"==typeof r&&(o=r,r=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!c.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var s=c.isBuffer(e)?e:H(new c(e,o).toString()),a=s.length;for(i=0;i<r-t;++i)this[i+t]=s[i%a]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function H(e,t){var r;t=t||1/0;for(var o=e.length,n=null,i=[],s=0;s<o;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===o){(t-=3)>-1&&i.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&i.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function F(e){return o.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,o){for(var n=0;n<o&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}}).call(this,r("fw+E"))},JaDF:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var o=r("2cRh"),n=r("VkLk"),i=function(e){function t(r,o){var n=e.call(this,r,o)||this;return n.name="ServerError",Object.setPrototypeOf(n,t.prototype),n}return o.d(t,e),t.createServerUnavailableError=function(){return new t("server_unavailable","Server is temporarily unavailable.")},t.createUnknownServerError=function(e){return new t("unknown_server_error",e)},t}(n.a)},Jjn7:function(e,t,r){"use strict";r.r(t);var o=r("amkZ");for(var n in o)["default"].indexOf(n)<0&&function(e){r.d(t,e,function(){return o[e]})}(n);var i=r("LgXN");r.d(t,"ViewType",function(){return i.a})},JpLj:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var o=r("0i3K");const n=(e,t)=>{const r=e.startNode.parentNode,n=void 0===t?e.endNode:t.startNode,i=r.insertBefore(Object(o.d)(),n);r.insertBefore(Object(o.d)(),n);const s=new o.b(e.options);return s.insertAfterNode(i),s},i=(e,t)=>(e.setValue(t),e.commit(),e),s=(e,t,r)=>{const n=e.startNode.parentNode,i=r?r.startNode:e.endNode,s=t.endNode.nextSibling;s!==i&&Object(o.h)(n,t.startNode,s,i)},a=e=>{Object(o.g)(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},c=(e,t,r)=>{const o=new Map;for(let n=t;n<=r;n++)o.set(e[n],n);return o},l=new WeakMap,d=new WeakMap,u=Object(o.e)((e,t,r)=>{let u;return void 0===r?r=t:void 0!==t&&(u=t),t=>{if(!(t instanceof o.b))throw new Error("repeat can only be used in text bindings");const h=l.get(t)||[],p=d.get(t)||[],f=[],g=[],m=[];let v,b,y=0;for(const t of e)m[y]=u?u(t,y):y,g[y]=r(t,y),y++;let w=0,k=h.length-1,C=0,T=g.length-1;for(;w<=k&&C<=T;)if(null===h[w])w++;else if(null===h[k])k--;else if(p[w]===m[C])f[C]=i(h[w],g[C]),w++,C++;else if(p[k]===m[T])f[T]=i(h[k],g[T]),k--,T--;else if(p[w]===m[T])f[T]=i(h[w],g[T]),s(t,h[w],f[T+1]),w++,T--;else if(p[k]===m[C])f[C]=i(h[k],g[C]),s(t,h[k],h[w]),k--,C++;else if(void 0===v&&(v=c(m,C,T),b=c(p,w,k)),v.has(p[w]))if(v.has(p[k])){const e=b.get(m[C]),r=void 0!==e?h[e]:null;if(null===r){const e=n(t,h[w]);i(e,g[C]),f[C]=e}else f[C]=i(r,g[C]),s(t,r,h[w]),h[e]=null;C++}else a(h[k]),k--;else a(h[w]),w++;for(;C<=T;){const e=n(t,f[T+1]);i(e,g[C]),f[C++]=e}for(;w<=k;){const e=h[w++];null!==e&&a(e)}l.set(t,f),d.set(t,m)}})},LgXN:function(e,t,r){"use strict";var o;r.d(t,"a",function(){return o}),function(e){e[e.image=2]="image",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines"}(o||(o={}))},LrYD:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var o=r("hkiJ"),n=r("IVvM"),i=r("cmRh"),s=(r("iNQq"),r("0Owk"),r("P7nI")),a=r("uHnN");const c=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}:host{font-family:var(--default-font-family)}.root{position:relative}.root .input-wrapper{font-family:var(--default-font-family);display:flex;flex-wrap:wrap;align-items:center;padding:4px 10px;position:relative;background-color:var(--input-background-color,#fff);font-size:14px;color:var(--color-sub1,#323130);height:29px;line-height:19px;cursor:text;border-top:var(--input-border-top,2px solid #605e5c);border-right:var(--input-border-right,2px solid #605e5c);border-bottom:var(--input-border-bottom,2px solid #605e5c);border-left:var(--input-border-left,2px solid #605e5c);border:var(--input-border,2px solid #605e5c)}.root .input-wrapper:hover{border-color:var(--input-border-color--hover,#323130)}.root .input-wrapper.focused{border-color:var(--input-border-color--focus,#0078d4)}.root .input-wrapper .selected-team{padding-right:10px;border:none;display:flex;position:relative;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;align-items:center;height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.root .input-wrapper .selected-team .arrow{margin-left:8px;margin-right:8px}.root .input-wrapper .selected-team .selected-team-name{font-weight:700}.root .input-wrapper .selected-team .search-wrapper{margin-left:12px;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .search-wrapper{overflow:hidden;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .hide-icon{display:none}.root .input-wrapper .team-chosen-input{display:inline-block;border:none;line-height:normal;outline:0;font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:transparent;color:var(--color-sub1,#323130);padding-left:5px}.root .input-wrapper .team-chosen-input::placeholder{color:var(--placeholder-color,#605e5c)}.root .input-wrapper .team-chosen-input[contenteditable]:empty::after{content:attr(data-placeholder);color:var(--placeholder-color,#605e5c)}.root .input-wrapper .search-icon{margin-top:1px;align-self:flex-start;font-family:FabricMDL2Icons;color:var(--accent-color,#0078d4);line-height:normal}.root .input-wrapper .input-search{height:19px}.root .input-wrapper .input-search-start{white-space:nowrap;line-height:normal;margin-inline-start:0;margin-inline-end:0}.root .input-wrapper::after{content:'';position:absolute;width:100%;height:90%;top:2px;right:2px;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}.root .close-icon{display:inline-block;position:absolute;right:10px;top:12px;line-height:normal;font-family:FabricMDL2Icons;cursor:pointer;color:var(--placeholder-color,#605e5c);background-color:var(--input-background-color,#fff)}.root .close-icon:hover{color:var(--color-sub1,#323130)}.root .dropdown{padding-top:5px;padding-bottom:11px;position:absolute;box-shadow:0 1.3289px 2.65781px rgba(180,180,180,.182),0 1.3289px 2.65781px rgba(68,68,68,.3);border-radius:2px;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));z-index:1;width:100%;text-align:left;list-style-type:none;font-family:var(--default-font-family);font-style:normal;font-weight:400;color:var(--color-sub1,#323130);display:none;max-height:346px;overflow-y:auto}.root .dropdown.visible{display:block}.root .dropdown .item .arrow svg{fill:var(--arrow-fill,#000)}.root .dropdown .item.list-team{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;display:flex;flex-direction:row;align-items:center;padding:5px 12px 6px 14px;margin-top:6px;font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:16px;color:var(--color-sub1,#323130);flex-flow:nowrap;position:relative;overflow:hidden;white-space:nowrap;background-color:transparent}.root .dropdown .item.list-team:after{content:'';position:absolute;width:36px;height:100%;top:0;right:0;background-image:-webkit-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-moz-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-ms-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-o-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:linear-gradient(to left,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0))}.root .dropdown .item.list-team:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .item.list-team .arrow{margin-right:5px;margin-bottom:1px}.root .dropdown .item.selected{background-color:var(--dropdown-item-selected-background,#deecf9)}.root .dropdown .item.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .channel-display{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;cursor:pointer;padding-left:21px;padding-right:10px}.root .dropdown .channel-display .showing{padding-left:10px;padding-top:4px;padding-bottom:4px}.root .dropdown .channel-display .showing .channel-name-text{font-size:14px;font-weight:400;color:var(--color-sub1,#323130);margin:0;padding:0}.root .dropdown .channel-display .showing .channel-name-text.highlight-search-text{font-weight:700}.root .dropdown .channel-display:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .loading-text,.root .dropdown .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;color:var(--color-sub1,#323130);line-height:19px;text-align:center}.root .dropdown .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}.root .dropdown .message-parent .loading-text{margin-top:3px;margin-left:9px;color:#0078d4}[dir=rtl] .input-wrapper::after{content:'';position:absolute;width:99%;height:90%;top:2px;left:0;background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}[dir=rtl] .search-wrapper{margin-right:0!important}[dir=rtl] .search-icon{margin-left:8px!important}[dir=rtl] .channel-display{padding:0 34px 0 10px!important}[dir=rtl] .close-icon{right:auto;left:10px}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}
`],l={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading..."};var d,u=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};let f=d=class extends i.MgtTemplatedComponent{constructor(){super(),this._inputValue="",this._isFocused=!1,this._treeViewState=[],this._focusList=[],this._focusedIndex=-1,this.handleWindowClick=this.handleWindowClick.bind(this),this.addEventListener("keydown",e=>this.onUserKeyDown(e)),this.addEventListener("focus",e=>this.loadTeamsIfNotLoaded()),this.addEventListener("mouseover",e=>this.loadTeamsIfNotLoaded())}static get styles(){return c}get strings(){return l}static get config(){return this._config}get selectedItem(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}static get requiredScopes(){return this.config.useTeamsBasedScopes?["team.readbasic.all","channel.readbasic.all"]:["user.read.all","group.read.all"]}set items(e){this._items!==e&&(this._items=e,this._treeViewState=e?this.generateTreeViewState(e):[],this.resetFocusState())}get items(){return this._items}get _input(){return this.renderRoot.querySelector(".team-chosen-input")}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this.handleWindowClick)}disconnectedCallback(){window.removeEventListener("click",this.handleWindowClick),super.disconnectedCallback()}selectChannelById(e){return p(this,void 0,void 0,function*(){const t=i.Providers.globalProvider;if(t&&t.state===i.ProviderState.SignedIn){this.items||(yield this.requestStateUpdate());for(const t of this._treeViewState)for(const r of t.channels)if(r.item.id===e)return this.selectChannel(r),!0}return!1})}render(){const e={focused:this._isFocused,"input-wrapper":!0},t=(this._isFocused&&this._selectedItemState,{dropdown:!0,visible:this._isDropdownVisible}),r={"hide-icon":!!this._selectedItemState,"search-wrapper":!0};return this.renderTemplate("default",{teams:this.items})||o.d`
        <div class="root" @blur=${this.lostFocus} dir=${this.direction}>
          <div class=${Object(n.a)(e)} @click=${this.gainedFocus}>
            ${this.renderSelected()}
            <div class=${Object(n.a)(r)}>${this.renderSearchIcon()} ${this.renderInput()}</div>
          </div>
          ${this.renderCloseButton()}
          <div class=${Object(n.a)(t)}>${this.renderDropdown()}</div>
        </div>
      `}renderSelected(){return this._selectedItemState?o.d`
      <li class="selected-team" title=${this._selectedItemState.item.displayName}>
        <div class="selected-team-name">${this._selectedItemState.parent.item.displayName}</div>
        <div class="arrow">${Object(s.b)(s.a.TeamSeparator,"#B3B0AD")}</div>
        ${this._selectedItemState.item.displayName}
        <div class="search-wrapper">${this.renderSearchIcon()} ${this.renderInput()}</div>
      </li>
    `:o.d``}clearState(){this._items=[],this._inputValue="",this._treeViewState=[],this._focusList=[]}renderSearchIcon(){return o.d`
      <div class="search-icon">
        ${Object(s.b)(s.a.Search,"#252424")}
      </div>
    `}renderInput(){const e={"input-search":!!this._selectedItemState,"input-search-start":!this._selectedItemState};return o.d`
      <div class="${Object(n.a)(e)}">
        <span
          id="teams-channel-picker-input"
          class="team-chosen-input"
          type="text"
          label="teams-channel-picker-input"
          aria-label="Select a channel"
          data-placeholder="${this._selectedItemState?"":this.strings.inputPlaceholderText} "
          role="input"
          @keyup=${e=>this.handleInputChanged(e)}
          contenteditable
        ></span>
      </div>
    `}renderCloseButton(){return o.d`
      <div class="close-icon" @click="${()=>this.selectChannel(null)}">
        
      </div>
    `}renderDropdown(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&0===this._treeViewState.length&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):o.d``}renderDropdownList(e,t=0){return e&&e.length?e.map((e,r)=>{const n=!!e.channels&&e.isExpanded;return o.d`
          ${this.renderItem(e)}
          ${n?this.renderDropdownList(e.channels,t+1):o.d``}
        `}):null}renderItem(e){let t=null;e.channels&&(t=e.isExpanded?Object(s.b)(s.a.ArrowDown,"#252424"):Object(s.b)(s.a.ArrowRight,"#252424"));let r=!1;this.selectedItem&&this.selectedItem.channel===e.item&&(r=!0);const i={focused:this._focusList[this._focusedIndex]===e,item:!0,"list-team":!!e.channels,selected:r},a=this.renderRoot.querySelector(".dropdown");return a.children[this._focusedIndex]&&a.children[this._focusedIndex].scrollIntoView(!1),o.d`
      <div @click=${()=>this.handleItemClick(e)} class="${Object(n.a)(i)}">
        <div class="arrow">
          ${t}
        </div>
        ${e.channels?e.item.displayName:this.renderHighlightedText(e.item)}
      </div>
    `}renderHighlightedText(e){let t={};const r=e.displayName.toLowerCase().indexOf(this._inputValue.toLowerCase());return-1!==r?0===r?(t.first="",t.highlight=e.displayName.slice(0,this._inputValue.length),t.last=e.displayName.slice(this._inputValue.length,e.displayName.length)):r===e.displayName.length?(t.first=e.displayName.slice(0,r),t.highlight=e.displayName.slice(r,e.displayName.length),t.last=""):(t.first=e.displayName.slice(0,r),t.highlight=e.displayName.slice(r,r+this._inputValue.length),t.last=e.displayName.slice(r+this._inputValue.length,e.displayName.length)):t.last=e.displayName,o.d`
      <div class="channel-display">
        <div class="showing">
          <span class="channel-name-text">${t.first}</span
          ><span class="channel-name-text highlight-search-text">${t.highlight}</span
          ><span class="channel-name-text">${t.last}</span>
        </div>
      </div>
    `}renderError(){return this.renderTemplate("error",null,"error")||o.d`
        <div class="message-parent">
          <div label="search-error-text" aria-label="We didn't find any matches." class="search-error-text">
            ${this.strings.noResultsFound}
          </div>
        </div>
      `}renderLoading(){return this.renderTemplate("loading",null,"loading")||o.d`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}loadState(){return p(this,void 0,void 0,function*(){const e=i.Providers.globalProvider;let t;if(e&&e.state===i.ProviderState.SignedIn){const r=e.graph.forComponent(this);if(!(yield e.getAccessTokenForScopes(...d.requiredScopes)))return;t=yield function(e){return t=this,void 0,o=function*(){const t=yield e.api("/me/joinedTeams").select(["displayName","id","isArchived"]).get();return t?t.value:null},new((r=void 0)||(r=Promise))(function(e,n){function i(e){try{a(o.next(e))}catch(e){n(e)}}function s(e){try{a(o.throw(e))}catch(e){n(e)}}function a(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r(function(e){e(o)})).then(i,s)}a((o=o.apply(t,[])).next())});var t,r,o}(r),t=t.filter(e=>!e.isArchived);const o=r.createBatch();for(const e of t)o.get(e.id,`teams/${e.id}/channels`);const n=yield o.executeAll();for(const e of t){const t=n.get(e.id);t&&t.content&&t.content.value&&(e.channels=t.content.value.map(e=>({item:e})))}this.items=t.map(e=>({channels:e.channels,item:e}))}this.filterList(),this.resetFocusState()})}handleItemClick(e){e.channels?e.isExpanded=!e.isExpanded:this.selectChannel(e),this._focusedIndex=-1,this.resetFocusState()}handleInputChanged(e){this._inputValue!==e.target.textContent&&(this._inputValue=e.target.textContent,this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=Object(a.b)(()=>{this.filterList()},400)),this.debouncedSearch())}filterList(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this._focusedIndex=-1,this.resetFocusState())}generateTreeViewState(e,t="",r=null){const o=[];if(t=t.toLowerCase(),e)for(const n of e){let e;if(0===t.length||n.item.displayName.toLowerCase().includes(t))e={item:n.item,parent:r},n.channels&&(e.channels=this.generateTreeViewState(n.channels,"",e),e.isExpanded=t.length>0);else if(n.channels){const o={item:n.item,parent:r},i=this.generateTreeViewState(n.channels,t,o);i.length>0&&(e=o,e.channels=i,e.isExpanded=!0)}e&&o.push(e)}return o}generateFocusList(e){if(!e||0===e.length)return[];let t=[];for(const r of e)t.push(r),r.channels&&r.isExpanded&&(t=[...t,...this.generateFocusList(r.channels)]);return t}resetFocusState(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}loadTeamsIfNotLoaded(){this.items||this.isLoadingState||this.requestStateUpdate()}handleWindowClick(e){e.target!==this&&this.lostFocus()}onUserKeyDown(e){if(13===e.keyCode&&e.preventDefault(),0===this._treeViewState.length)return;const t=this._focusList[this._focusedIndex];switch(e.keyCode){case 40:this._focusedIndex=(this._focusedIndex+1)%this._focusList.length,this.requestUpdate(),e.preventDefault();break;case 38:-1===this._focusedIndex&&(this._focusedIndex=this._focusList.length),this._focusedIndex=(this._focusedIndex-1+this._focusList.length)%this._focusList.length,this.requestUpdate(),e.preventDefault();break;case 39:t&&t.channels&&!t.isExpanded&&(t.isExpanded=!0,this.resetFocusState(),e.preventDefault());break;case 37:t&&t.channels&&t.isExpanded&&(t.isExpanded=!1,this.resetFocusState(),e.preventDefault());break;case 9:if(!t){this.lostFocus();break}case 13:t&&t.channels?(t.isExpanded=!t.isExpanded,this.resetFocusState(),e.preventDefault()):t&&!t.channels&&(this.selectChannel(t),this.resetFocusState(),this._focusedIndex=-1,e.preventDefault());break;case 8:0===this._inputValue.length&&this._selectedItemState&&(this.selectChannel(null),e.preventDefault());break;case 27:this.selectChannel(this._selectedItemState),this._focusedIndex=-1,this.resetFocusState(),e.preventDefault()}}gainedFocus(){this._isFocused=!0;const e=this._input;e&&e.focus(),this._isDropdownVisible=!0}lostFocus(){this._isFocused=!1;const e=this._input;e&&(e.textContent=this._inputValue=""),this._isDropdownVisible=!1,this.filterList()}selectChannel(e){this._selectedItemState!==e&&(this._selectedItemState=e,this.fireCustomEvent("selectionChanged",e?[this.selectedItem]:[]));const t=this._input;t&&(t.textContent=this._inputValue=""),this.requestUpdate(),this.lostFocus()}};f._config={useTeamsBasedScopes:!1},u([Object(o.f)({attribute:!1}),h("design:type",Object)],f.prototype,"_isDropdownVisible",void 0),f=d=u([Object(o.c)("mgt-teams-channel-picker"),h("design:paramtypes",[])],f)},NgJg:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var o=r("hkiJ"),n=r("GogD"),i=r("yNap"),s=r("jTv9");class a extends i.b{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(e)}updated(e){super.updated(e),this.removeUnusedSlottedElements()}renderTemplate(e,t,r){if(!this.hasTemplate(e))return null;r=r||e,this._slotNamesAddedDuringRender.push(r),this._renderedSlots=!0;const i=o.d`
      <slot name=${r}></slot>
    `;if(this._renderedTemplates.hasOwnProperty(r)){const{context:e,slot:o}=this._renderedTemplates[r];if(Object(n.b)(e,t))return i;this.removeChild(o)}const a=document.createElement("div");return a.slot=r,a.dataset.generated="template",s.a.renderTemplate(a,this.templates[e],t,Object.assign({},this.templateContext)),this.appendChild(a),this._renderedTemplates[r]={context:t,slot:a},this.fireCustomEvent("templateRendered",{templateType:e,context:t,element:a}),i}hasTemplate(e){return this.templates&&this.templates[e]}getTemplates(){const e={};for(let t=0;t<this.children.length;t++){const r=this.children[t];if("TEMPLATE"===r.nodeName){const o=r;o.dataset.type?e[o.dataset.type]=o:e.default=o,o.templateOrder=t}}return e}removeUnusedSlottedElements(){if(this._renderedSlots){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.dataset&&t.dataset.generated&&!this._slotNamesAddedDuringRender.includes(t.slot)&&(this.removeChild(t),delete this._renderedTemplates[t.slot],e--)}this._renderedSlots=!1}}}},O3Bf:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var o=r("hkiJ");const n=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-background-color:#ffffff}.mgt-dark{--file-background-color:#424242}:host{font-family:var(--font-family,var(--default-font-family))}:host .item,mgt-file .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color,#fff)}:host .item__file-type-icon,mgt-file .item__file-type-icon{padding:16px;width:var(--file-type-icon-size,28px);min-width:var(--file-type-icon-size,28px);height:var(--file-type-icon-size,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img,mgt-file .item__file-type-icon img{height:var(--file-type-icon-size,28px);width:var(--file-type-icon-size,28px)}:host .item__details,mgt-file .item__details{padding:10px 0}:host .item__details .line1,mgt-file .item__details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,400);text-transform:var(text-transform,none);line-height:20px;color:var(--color-sub1,#323130)}:host .item__details .line2,mgt-file .item__details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none));line-height:16px}:host .item__details .line3,mgt-file .item__details .line3{color:var(--line3-color,var(--color-sub1,#323130));font-size:var(--line3-font-size,var(--size-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none));line-height:16px}[dir=rtl] .item__details{direction:ltr}
`];var i=r("cmRh"),s=r("t0JB"),a=r("uHnN"),c=r("LgXN"),l=r("zKI9"),d=r("P7nI");const u={modifiedSubtitle:"Modified",sizeSubtitle:"Size"};var h=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let f=class extends i.MgtTemplatedComponent{constructor(){super(),this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view=c.a.threelines}static get styles(){return n}get strings(){return u}get fileQuery(){return this._fileQuery}set fileQuery(e){e!==this._fileQuery&&(this._fileQuery=e,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate())}get listId(){return this._listId}set listId(e){e!==this._listId&&(this._listId=e,this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate())}get insightId(){return this._insightId}set insightId(e){e!==this._insightId&&(this._insightId=e,this.requestStateUpdate())}get fileDetails(){return this._fileDetails}set fileDetails(e){e!==this._fileDetails&&(this._fileDetails=e,this.requestStateUpdate())}get fileIcon(){return this._fileIcon}set fileIcon(e){e!==this._fileIcon&&(this._fileIcon=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}render(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();const e=this.driveItem;let t;if(t=this.renderTemplate("default",{file:e}),!t){const r=this.renderDetails(e),n=this.renderFileTypeIcon();t=o.d`
        <div class="item">
          ${n} ${r}
        </div>
      `}return o.d`
      <span dir=${this.direction}>
        ${t}
      </span>
    `}renderLoading(){return this.renderTemplate("loading",null)||o.d``}renderNoData(){return this.renderTemplate("no-data",null)||o.d``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return o.d``;let e;if(this.fileIcon)e=this.fileIcon;else{const t=/(?:\.([^.]+))?$/,r=void 0===this.driveItem.package&&void 0===this.driveItem.folder?t.exec(this.driveItem.name)[1]?t.exec(this.driveItem.name)[1].toLowerCase():"null":void 0!==this.driveItem.package&&"oneNote"===this.driveItem.package.type?"onetoc":"folder";e=Object(l.b)(r,48,"svg")}return o.d`
      <div class="item__file-type-icon">
        ${e?o.d`
              <img src=${e} alt="File icon" />
            `:o.d`
              ${Object(d.b)(d.a.File)}
            `}
      </div>
    `}renderDetails(e){if(!e||this.view===c.a.image)return o.d``;const t=[];if(this.view>c.a.image){const r=this.getTextFromProperty(e,this.line1Property);r&&t.push(o.d`
          <div class="line1" aria-label="${r}">${r}</div>
        `)}if(this.view>c.a.oneline){const r=this.getTextFromProperty(e,this.line2Property);r&&t.push(o.d`
          <div class="line2" aria-label="${r}">${r}</div>
        `)}if(this.view>c.a.twolines){const r=this.getTextFromProperty(e,this.line3Property);r&&t.push(o.d`
          <div class="line3" aria-label="${r}">${r}</div>
        `)}return o.d`
      <div class="item__details">
        ${t}
      </div>
    `}loadState(){return e=this,void 0,r=function*(){if(this.fileDetails)return void(this.driveItem=this.fileDetails);const e=i.Providers.globalProvider;if(!e||e.state===i.ProviderState.Loading)return;if(e.state===i.ProviderState.SignedOut)return void(this.driveItem=null);const t=e.graph.forComponent(this);let r;const o=!(this.driveId||this.siteId||this.groupId||this.listId||this.userId);this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?r=null:this.fileQuery?r=yield Object(s.g)(t,this.fileQuery):this.itemId&&o?r=yield Object(s.r)(t,this.itemId):this.itemPath&&o?r=yield Object(s.s)(t,this.itemPath):this.userId?this.itemId?r=yield Object(s.z)(t,this.userId,this.itemId):this.itemPath?r=yield Object(s.A)(t,this.userId,this.itemPath):this.insightType&&this.insightId&&(r=yield Object(s.D)(t,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?r=yield Object(s.e)(t,this.driveId,this.itemId):this.itemPath&&(r=yield Object(s.f)(t,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?r=yield Object(s.v)(t,this.siteId,this.itemId):this.itemPath&&(r=yield Object(s.w)(t,this.siteId,this.itemPath)):this.listId?r=yield Object(s.q)(t,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?r=yield Object(s.m)(t,this.groupId,this.itemId):this.itemPath&&(r=yield Object(s.n)(t,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(r=yield Object(s.t)(t,this.insightType,this.insightId)),this.driveItem=r},new((t=void 0)||(t=Promise))(function(o,n){function i(e){try{a(r.next(e))}catch(e){n(e)}}function s(e){try{a(r.throw(e))}catch(e){n(e)}}function a(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t(function(e){e(r)})).then(i,s)}a((r=r.apply(e,[])).next())});var e,t,r}getTextFromProperty(e,t){if(!t||0===t.length)return null;const r=t.trim().split(",");let o,n=0;for(;!o&&n<r.length;){const t=r[n].trim();switch(t){case"size":let r;r=e.size?this.formatBytes(e.size):"0",o=`${this.strings.sizeSubtitle}: ${r}`;break;case"lastModifiedDateTime":let n,i;if(e.lastModifiedDateTime){const t=new Date(e.lastModifiedDateTime);n=Object(a.f)(t),i=`${this.strings.modifiedSubtitle} ${n}`}else i="";o=i;break;default:o=e[t]}n++}return o}formatBytes(e,t=2){if(0===e)return"0 Bytes";const r=t<0?0:t,o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(r))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o]}};h([Object(o.f)({attribute:"file-query"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"fileQuery",null),h([Object(o.f)({attribute:"site-id"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"siteId",null),h([Object(o.f)({attribute:"drive-id"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"driveId",null),h([Object(o.f)({attribute:"group-id"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"groupId",null),h([Object(o.f)({attribute:"list-id"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"listId",null),h([Object(o.f)({attribute:"user-id"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"userId",null),h([Object(o.f)({attribute:"item-id"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"itemId",null),h([Object(o.f)({attribute:"item-path"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"itemPath",null),h([Object(o.f)({attribute:"insight-type"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"insightType",null),h([Object(o.f)({attribute:"insight-id"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"insightId",null),h([Object(o.f)({type:Object}),p("design:type",Object),p("design:paramtypes",[Object])],f.prototype,"fileDetails",null),h([Object(o.f)({attribute:"file-icon"}),p("design:type",String),p("design:paramtypes",[String])],f.prototype,"fileIcon",null),h([Object(o.f)({type:Object}),p("design:type",Object)],f.prototype,"driveItem",void 0),h([Object(o.f)({attribute:"line1-property"}),p("design:type",String)],f.prototype,"line1Property",void 0),h([Object(o.f)({attribute:"line2-property"}),p("design:type",String)],f.prototype,"line2Property",void 0),h([Object(o.f)({attribute:"line3-property"}),p("design:type",String)],f.prototype,"line3Property",void 0),h([Object(o.f)({attribute:"view",converter:e=>e&&0!==e.length?(e=e.toLowerCase(),void 0===c.a[e]?c.a.threelines:c.a[e]):c.a.threelines}),p("design:type",Number)],f.prototype,"view",void 0),f=h([Object(o.c)("mgt-file"),p("design:paramtypes",[])],f)},P7nI:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return i});var o,n=r("hkiJ");function i(e,t){switch(e){case o.ArrowRight:return n.d`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 7L4.46481 10.5359L4.46481 7L4.46481 3.46413L8 7Z" />
        </svg>
      `;case o.ArrowDown:return n.d`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;case o.TeamSeparator:return n.d`
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${t}
          />
        </svg>
      `;case o.Search:return n.d`
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0)">
            <circle cx="5.36377" cy="5.36396" r="4" transform="rotate(45 5.36377 5.36396)" stroke="#B3B0AD" />
            <path
              d="M8.19189 7.48529L12.7881 12.0815C12.9834 12.2767 12.9834 12.5933 12.7881 12.7886V12.7886C12.5928 12.9839 12.2762 12.9839 12.081 12.7886L7.48479 8.1924L8.19189 7.48529Z"
              fill="#B3B0AD"
            />
          </g>
          <defs>
            <clipPath id="clip0">
              <rect width="14" height="14" fill="white" />
            </clipPath>
          </defs>
        </svg>
      `;case o.SkypeArrow:return n.d`
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;case o.SmallEmail:return n.d`
        <svg width="14" height="10" viewBox="0 0 14 10" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M11.8473 1H2.04886L6.47364 4.18916C6.64273 4.31103 6.86969 4.31522 7.04316 4.19968L11.8473 1ZM1 1.47671V9H13V1.43376L7.59749 5.03198C7.07706 5.3786 6.39621 5.36601 5.88894 5.0004L1 1.47671ZM0 1C0 0.447715 0.447715 0 1 0H13C13.5523 0 14 0.447715 14 1V9C14 9.55228 13.5523 10 13 10H1C0.447716 10 0 9.55229 0 9V1Z"
          />
        </svg>
      `;case o.SmallChat:return n.d`
        <svg width="13" height="13" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M9.5781 8.26403L9.57811 8.26403C9.68611 8.29867 9.8455 8.36364 10.0125 8.50479C10.1405 8.61294 10.2409 8.73883 10.3235 8.86465L11.9634 10.9944C11.9701 10.9924 11.9753 10.9904 11.9785 10.9889C11.9841 10.9864 11.9918 10.9823 12 10.9768V1.32284C12 1.18078 11.8731 1 11.6207 1H1.37926C1.12692 1 1 1.18078 1 1.32284V7.37377C1 7.45357 1.01415 7.49036 1.02102 7.50507C1.02778 7.51955 1.04342 7.54689 1.09159 7.58705L1.10485 7.5981L1.11771 7.6096C1.13526 7.62529 1.21707 7.69076 1.33937 7.76027C1.46122 7.82952 1.58119 7.87864 1.67944 7.89966L1.69102 7.90214L1.691 7.9022C3.32106 8.27116 6.2626 8.27688 8.67896 8.18036L8.69908 8.17955L8.71921 8.17956L8.7627 8.17954C9.01362 8.17932 9.31313 8.17907 9.5781 8.26403ZM11.2376 11.6908L9.50506 9.44081C9.39493 9.26422 9.32445 9.23285 9.27276 9.21627C9.17534 9.18504 9.0401 9.17966 8.71888 9.17956C6.31879 9.27543 3.24831 9.27999 1.47024 8.87753C1.01314 8.77974 0.600449 8.48852 0.451238 8.35513C0.15593 8.10893 0 7.78958 0 7.37377V1.32284C0 0.593147 0.610664 0 1.37926 0H11.6207C12.3893 0 13 0.593147 13 1.32284V11.0441C13 11.4686 12.6828 11.7689 12.3881 11.9012C12.1048 12.0284 11.673 12.0728 11.3387 11.7993C11.3003 11.7679 11.2678 11.7301 11.2376 11.6908ZM3 3.5C3 3.22386 3.22386 3 3.5 3H9.5C9.77614 3 10 3.22386 10 3.5C10 3.77614 9.77614 4 9.5 4H3.5C3.22386 4 3 3.77614 3 3.5ZM3.5 5C3.22386 5 3 5.22386 3 5.5C3 5.77614 3.22386 6 3.5 6H6.5C6.77614 6 7 5.77614 7 5.5C7 5.22386 6.77614 5 6.5 5H3.5Z"
          />
        </svg>
      `;case o.ExpandDown:return n.d`
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="#3078CD" />
        </svg>
      `;case o.Overview:return n.d`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12 4V9H2V4H12ZM11 8V5H3V8H11ZM13 4H18V9H13V4ZM17 8V5H14V8H17ZM8 15V10H18V15H8ZM9 11V14H17V11H9ZM2 15V10H7V15H2ZM3 11V14H6V11H3Z"
          />
        </svg>
      `;case o.Send:return n.d`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;case o.Contact:return n.d`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M11.3315 11.7855L11.3452 11.7913L11.3591 11.7967C11.4057 11.8149 11.4421 11.8389 11.4762 11.8729L12.8836 13.2797C12.9177 13.3137 12.9416 13.35 12.9597 13.3965L12.9651 13.4104L12.971 13.4241C12.9902 13.4693 13 13.5151 13 13.5699C13 13.6248 12.9901 13.6759 12.9676 13.7303L12.9675 13.7302L12.9628 13.7419C12.9458 13.7844 12.9218 13.822 12.8836 13.8602L12.7941 13.9497C12.57 14.1736 12.3673 14.37 12.1855 14.5396C12.0445 14.6712 11.9037 14.7767 11.7639 14.8601C11.6429 14.9284 11.499 14.9865 11.3265 15.0296C11.1716 15.0683 10.9523 15.0957 10.6541 15.0957C10.226 15.0957 9.77339 15.0291 9.29316 14.8873C8.79837 14.7411 8.29897 14.537 7.79466 14.2716C7.29099 14.0043 6.7904 13.6843 6.2931 13.3097C5.79797 12.9334 5.32815 12.5234 4.88351 12.0793C4.44215 11.6299 4.03516 11.1575 3.66219 10.6619C3.2916 10.1652 2.97561 9.66531 2.71228 9.16232C2.44987 8.65684 2.24939 8.16115 2.1072 7.67496C1.96889 7.20203 1.9043 6.75953 1.9043 6.34426C1.9043 6.04676 1.92945 5.8283 1.96505 5.67477C2.00758 5.51024 2.06491 5.36965 2.13346 5.24839C2.21771 5.10725 2.32161 4.96874 2.44802 4.83312C2.61763 4.65148 2.814 4.44899 3.03788 4.22522L3.14024 4.12291C3.18256 4.08061 3.22694 4.05101 3.2785 4.0291C3.32105 4.01103 3.36887 4 3.43131 4C3.48634 4 3.53235 4.00983 3.57773 4.0291L3.57771 4.02914L3.58585 4.03251C3.6411 4.05541 3.68414 4.08469 3.72239 4.12291L5.12984 5.52968C5.16387 5.56369 5.18781 5.60004 5.20594 5.64649L5.21136 5.66038L5.2172 5.6741C5.23642 5.71931 5.24622 5.76513 5.24622 5.81992C5.24622 5.88591 5.23631 5.9178 5.23225 5.92835C5.20132 5.99698 5.16601 6.05438 5.12738 6.10352C5.07447 6.17083 5.01613 6.23146 4.95179 6.28625L4.94467 6.2923L4.93768 6.29849C4.81323 6.40852 4.69584 6.51839 4.58605 6.62811C4.45174 6.76237 4.32909 6.90895 4.22378 7.06908C4.0535 7.32254 3.96032 7.61696 3.96032 7.93007C3.96032 8.35888 4.12439 8.75141 4.42612 9.05299L7.95115 12.5763C8.25285 12.8779 8.64535 13.0417 9.07392 13.0417C9.38687 13.0417 9.68121 12.9486 9.9347 12.7785C10.0949 12.6733 10.2415 12.5507 10.3758 12.4164C10.4856 12.3067 10.5955 12.1894 10.7056 12.065L10.7118 12.058L10.7179 12.0509C10.7727 11.9866 10.8333 11.9283 10.9007 11.8754C10.9499 11.8367 11.0074 11.8014 11.0761 11.7704C11.0868 11.7663 11.1189 11.7564 11.1851 11.7564C11.2401 11.7564 11.2861 11.7662 11.3315 11.7855ZM11.5689 15.9998C11.8248 15.9358 12.0573 15.8442 12.2663 15.7248C12.4753 15.6012 12.6757 15.4499 12.8676 15.2708C13.0596 15.0918 13.2707 14.8872 13.501 14.657L13.5906 14.5674C13.7228 14.4353 13.823 14.284 13.8912 14.1134C13.9637 13.9387 14 13.7575 14 13.5699C14 13.3824 13.9637 13.2033 13.8912 13.0328C13.823 12.858 13.7228 12.7045 13.5906 12.5724L12.1831 11.1656C12.0509 11.0335 11.8974 10.9333 11.7225 10.8651C11.5519 10.7926 11.3728 10.7564 11.1851 10.7564C10.9974 10.7564 10.829 10.7884 10.6797 10.8523C10.5347 10.9163 10.4025 10.9951 10.283 11.0889C10.1636 11.1827 10.0549 11.2871 9.95677 11.4022C9.85868 11.5131 9.76272 11.6154 9.66889 11.7092C9.57506 11.8029 9.47909 11.8818 9.381 11.9457C9.28717 12.0097 9.18481 12.0417 9.07392 12.0417C8.91185 12.0417 8.77323 11.9841 8.65808 11.869L5.13305 8.34571C5.0179 8.23061 4.96032 8.09206 4.96032 7.93007C4.96032 7.81924 4.99231 7.71693 5.05628 7.62314C5.12026 7.52509 5.19916 7.42918 5.29299 7.33539C5.38682 7.24161 5.48918 7.14569 5.60007 7.04765C5.71522 6.9496 5.81972 6.84089 5.91355 6.72153C6.00738 6.60217 6.08628 6.47002 6.15026 6.32508C6.21423 6.17588 6.24622 6.00749 6.24622 5.81992C6.24622 5.63236 6.20997 5.45331 6.13746 5.2828C6.06922 5.10802 5.96899 4.95455 5.83678 4.8224L4.42932 3.41564C4.29711 3.28348 4.14357 3.18117 3.9687 3.1087C3.7981 3.03623 3.61897 3 3.43131 3C3.23939 3 3.05813 3.03623 2.88752 3.1087C2.71692 3.18117 2.56552 3.28348 2.4333 3.41564L2.33094 3.51795C2.10063 3.74814 1.89591 3.95916 1.71678 4.15099C1.54192 4.33856 1.39264 4.53678 1.26895 4.74567C1.14953 4.95455 1.05784 5.18475 0.993862 5.43626C0.934152 5.68777 0.904297 5.99044 0.904297 6.34426C0.904297 6.86434 0.985332 7.40147 1.1474 7.95565C1.30947 8.50983 1.53552 9.06614 1.82554 9.62458C2.11556 10.1788 2.46102 10.7244 2.86193 11.2615C3.26285 11.7944 3.70001 12.3017 4.17342 12.7834C4.65111 13.2609 5.15651 13.7021 5.68963 14.107C6.22703 14.512 6.77295 14.8616 7.3274 15.1557C7.88611 15.4499 8.44696 15.6801 9.00994 15.8463C9.57292 16.0126 10.121 16.0957 10.6541 16.0957C11.0081 16.0957 11.313 16.0637 11.5689 15.9998ZM14.9616 14H17.0002C17.5525 14 18.0002 13.5523 18.0002 13V5C18.0002 4.44772 17.5525 4 17.0002 4H6.43555L6.54385 4.11514C6.77073 4.34192 6.94536 4.60775 7.06365 4.90525C7.07677 4.93665 7.08919 4.96824 7.10089 5H16.8821L10.2238 8.32913C10.083 8.39951 9.91736 8.39951 9.7766 8.32913L7.22381 7.05273L6.7766 7.94716L9.32938 9.22355C9.75167 9.4347 10.2487 9.4347 10.671 9.22356L17.0002 6.05895V13H14.9314C14.9772 13.1858 15.0001 13.3764 15.0001 13.5699C15.0001 13.7154 14.9872 13.8589 14.9616 14Z"
          />
        </svg>
      `;case o.Copy:return n.d`
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;case o.CellPhone:return n.d`
        <svg width="10" height="15" viewBox="0 0 10 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="0.5" y="0.5" width="9" height="14" rx="0.9" stroke="${t}" />
          <rect x="3" y="12" width="4" height="1" rx="0.5" fill="${t}" />
        </svg>
      `;case o.Chat:return n.d`
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M2.67824 0C2.3824 0 2.14258 0.239826 2.14258 0.535665C2.14258 0.831505 2.3824 1.07133 2.67824 1.07133H13.9985C14.5508 1.07133 14.9985 1.51905 14.9985 2.07133V12.3203C14.9985 12.6161 15.2384 12.856 15.5342 12.856C15.8301 12.856 16.0699 12.6161 16.0699 12.3203V2C16.0699 0.895431 15.1744 0 14.0699 0H2.67824Z"
            fill="${t}"
          />
          <path
            d="M9.34097 11.4769L9.3309 11.4769L9.32085 11.4773C6.74142 11.5804 3.51639 11.5801 1.6855 11.1657L1.6855 11.1657L1.67972 11.1644C1.30373 11.084 0.937799 10.8292 0.816663 10.7209L0.81023 10.7152L0.803602 10.7096C0.601843 10.5414 0.5 10.3403 0.5 10.0423V3.55978C0.5 3.07185 0.912353 2.64258 1.47765 2.64258H12.4497C13.0149 2.64258 13.4273 3.07185 13.4273 3.55978V13.9745C13.4273 14.1578 13.2827 14.3397 13.067 14.4366C12.8614 14.5288 12.6204 14.5275 12.457 14.3904L10.5932 11.9699C10.5218 11.8587 10.4457 11.7646 10.3579 11.6904C10.2528 11.6015 10.1556 11.5622 10.0869 11.5401L9.93419 12.0163L10.0869 11.5401C9.89097 11.4773 9.65413 11.477 9.34097 11.4769Z"
            stroke="${t}"
          />
        </svg>
      `;case o.Department:return n.d`
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M9.625 3.5H14V11.375H0V3.5H4.375V1.75H9.625V3.5ZM5.25 2.625V3.5H8.75V2.625H5.25ZM13.125 4.375H0.875V6.125H3.5V5.25H4.375V6.125H9.625V5.25H10.5V6.125H13.125V4.375ZM0.875 10.5H13.125V7H10.5V7.875H9.625V7H4.375V7.875H3.5V7H0.875V10.5Z"
            fill="${t}"
          />
        </svg>
      `;case o.Email:return n.d`
        <svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M0.5 0.772727C0.5 0.622104 0.622104 0.5 0.772727 0.5H13.2273C13.3779 0.5 13.5 0.622104 13.5 0.772727V9.22727C13.5 9.3779 13.3779 9.5 13.2273 9.5H0.772727C0.622104 9.5 0.5 9.3779 0.5 9.22727V0.772727Z"
            stroke="${t}"
          />
          <path d="M13.5 0.5L7.18923 4.70314C6.92113 4.8817 6.57039 4.87522 6.30907 4.68687L0.5 0.5" stroke="#929292" />
        </svg>
      `;case o.OfficeLocation:return n.d`
        <svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M6.78489 16.3832L6.78263 16.3859C6.75278 16.4216 6.71543 16.4503 6.67324 16.4701L6.88498 16.923L6.67324 16.4701C6.63105 16.4898 6.58504 16.5 6.53846 16.5C6.49188 16.5 6.44588 16.4898 6.40368 16.4701C6.36149 16.4503 6.32415 16.4216 6.2943 16.3859L6.29202 16.3832C5.47882 15.4241 4.01597 13.6289 2.75914 11.7172C2.13055 10.7611 1.56021 9.78597 1.14862 8.87887C0.732553 7.96189 0.5 7.15987 0.5 6.53687C0.5 3.20251 3.20343 0.5 6.53846 0.5C9.87349 0.5 12.5769 3.20251 12.5769 6.53687C12.5769 7.16011 12.3444 7.96225 11.9283 8.87925C11.5167 9.78639 10.9464 10.7615 10.3178 11.7175C9.06097 13.6291 7.59812 15.424 6.78489 16.3832Z"
            stroke="${t}"
          />
          <path
            d="M4.40039 6.53921C4.40039 5.37092 5.34748 4.42383 6.51577 4.42383C7.68407 4.42383 8.63116 5.37092 8.63116 6.53921C8.63116 7.70751 7.68407 8.6546 6.51577 8.6546C5.34748 8.6546 4.40039 7.70751 4.40039 6.53921Z"
            stroke="${t}"
          />
        </svg>
      `;case o.Person:return n.d`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M8.91699 4C8.91699 5.65685 7.57385 7 5.91699 7C4.26014 7 2.91699 5.65685 2.91699 4C2.91699 2.34315 4.26014 1 5.91699 1C7.57385 1 8.91699 2.34315 8.91699 4ZM8.04431 7.38803C9.16935 6.68014 9.91699 5.42738 9.91699 4C9.91699 1.79086 8.12613 0 5.91699 0C3.70785 0 1.91699 1.79086 1.91699 4C1.91699 5.42739 2.66465 6.68016 3.78972 7.38805C1.82681 8.13254 0.356122 9.8773 0 12H1.01706C1.48033 9.71776 3.49808 8 5.91704 8C8.336 8 10.3538 9.71776 10.817 12H11.8341C11.478 9.87728 10.0072 8.1325 8.04431 7.38803Z"
            fill="${t}"
          />
        </svg>
      `;case o.Messages:return n.d`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4 3.5C4 3.22386 4.22386 3 4.5 3H16C17.1046 3 18 3.89543 18 5V12.5C18 12.7761 17.7761 13 17.5 13C17.2239 13 17 12.7761 17 12.5V5C17 4.44772 16.5523 4 16 4H4.5C4.22386 4 4 3.77614 4 3.5ZM4.04886 6H13.8473L9.04316 9.19968C8.86969 9.31522 8.64273 9.31103 8.47364 9.18916L4.04886 6ZM3 14V6.47671L7.88894 10.0004C8.39621 10.366 9.07706 10.3786 9.59749 10.032L15 6.43376V14H3ZM3 5C2.44772 5 2 5.44772 2 6V14C2 14.5523 2.44772 15 3 15H15C15.5523 15 16 14.5523 16 14V6C16 5.44772 15.5523 5 15 5H3Z"
          />
        </svg>
      `;case o.Organization:return n.d`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13 4H8V7H13V4ZM8 3C7.44772 3 7 3.44772 7 4V7C7 7.55228 7.44772 8 8 8H10V9H7.5C6.67157 9 6 9.67157 6 10.5V11H4C3.44772 11 3 11.4477 3 12V15C3 15.5523 3.44772 16 4 16H9C9.55228 16 10 15.5523 10 15V12C10 11.4477 9.55228 11 9 11H7V10.5C7 10.2239 7.22386 10 7.5 10H13.5C13.7761 10 14 10.2239 14 10.5V11H12C11.4477 11 11 11.4477 11 12V15C11 15.5523 11.4477 16 12 16H17C17.5523 16 18 15.5523 18 15V12C18 11.4477 17.5523 11 17 11H15V10.5C15 9.67157 14.3284 9 13.5 9H11V8H13C13.5523 8 14 7.55228 14 7V4C14 3.44772 13.5523 3 13 3H8ZM9 12H4L4 15H9V12ZM12 12H17V15H12V12Z"
          />
        </svg>
      `;case o.ExpandRight:return n.d`
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;case o.Profile:return n.d`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13 8C13 9.65685 11.6569 11 10 11C8.34315 11 7 9.65685 7 8C7 6.34315 8.34315 5 10 5C11.6569 5 13 6.34315 13 8ZM12.1273 11.388C13.2524 10.6801 14 9.42738 14 8C14 5.79086 12.2091 4 10 4C7.79086 4 6 5.79086 6 8C6 9.42739 6.74766 10.6802 7.87272 11.3881C5.90981 12.1325 4.43913 13.8773 4.08301 16H5.10007C5.56334 13.7178 7.58109 12 10 12C12.419 12 14.4368 13.7178 14.9 16H15.9171C15.561 13.8773 14.0903 12.1325 12.1273 11.388Z"
          />
        </svg>
      `;case o.Profile:return n.d`
        <svg width="12" height="14" viewBox="0 0 12 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.5"
            d="M5.125 10.0625C5.125 10.2448 5.15918 10.4157 5.22754 10.5752C5.2959 10.7347 5.38932 10.8737 5.50781 10.9922C5.6263 11.1107 5.7653 11.2041 5.9248 11.2725C6.08431 11.3408 6.25521 11.375 6.4375 11.375H9.0625C9.35872 11.375 9.63672 11.4297 9.89648 11.5391C10.1608 11.6484 10.3978 11.8079 10.6074 12.0176C10.8171 12.2272 10.9766 12.4642 11.0859 12.7285C11.1953 12.9883 11.25 13.2663 11.25 13.5625C11.25 13.681 11.2067 13.7835 11.1201 13.8701C11.0335 13.9567 10.931 14 10.8125 14C10.694 14 10.5915 13.9567 10.5049 13.8701C10.4183 13.7835 10.375 13.681 10.375 13.5625C10.375 13.3802 10.3408 13.2093 10.2725 13.0498C10.2041 12.8903 10.1107 12.7513 9.99219 12.6328C9.8737 12.5143 9.7347 12.4209 9.5752 12.3525C9.41569 12.2842 9.24479 12.25 9.0625 12.25H6.4375C6.14128 12.25 5.861 12.1953 5.59668 12.0859C5.33691 11.9766 5.10221 11.8171 4.89258 11.6074C4.68294 11.3978 4.52344 11.1631 4.41406 10.9033C4.30469 10.639 4.25 10.3587 4.25 10.0625V9.46777C3.7168 9.21712 3.23372 8.89811 2.80078 8.51074C2.36784 8.12337 1.9987 7.69043 1.69336 7.21191C1.39258 6.72884 1.16016 6.21159 0.996094 5.66016C0.832031 5.10417 0.75 4.52995 0.75 3.9375C0.75 3.39518 0.852539 2.88477 1.05762 2.40625C1.26725 1.92773 1.5498 1.51074 1.90527 1.15527C2.26074 0.799805 2.67773 0.519531 3.15625 0.314453C3.63477 0.104818 4.14518 0 4.6875 0C5.22982 0 5.74023 0.104818 6.21875 0.314453C6.69727 0.519531 7.11426 0.799805 7.46973 1.15527C7.8252 1.51074 8.10547 1.92773 8.31055 2.40625C8.52018 2.88477 8.625 3.39518 8.625 3.9375C8.625 4.52995 8.54297 5.10417 8.37891 5.66016C8.21484 6.21615 7.98014 6.7334 7.6748 7.21191C7.37402 7.69043 7.00716 8.12337 6.57422 8.51074C6.14583 8.89811 5.66276 9.21712 5.125 9.46777V10.0625ZM1.625 3.9375C1.625 4.45247 1.69564 4.9515 1.83691 5.43457C1.98275 5.91309 2.18783 6.3597 2.45215 6.77441C2.72103 7.18913 3.04232 7.56283 3.41602 7.89551C3.79427 8.22363 4.2181 8.49479 4.6875 8.70898C5.1569 8.49479 5.57845 8.22363 5.95215 7.89551C6.3304 7.56283 6.65169 7.18913 6.91602 6.77441C7.1849 6.3597 7.38997 5.91309 7.53125 5.43457C7.67708 4.9515 7.75 4.45247 7.75 3.9375C7.75 3.51367 7.66797 3.11719 7.50391 2.74805C7.3444 2.37435 7.12565 2.05078 6.84766 1.77734C6.57422 1.49935 6.25065 1.2806 5.87695 1.12109C5.50781 0.957031 5.11133 0.875 4.6875 0.875C4.26367 0.875 3.86491 0.957031 3.49121 1.12109C3.12207 1.2806 2.7985 1.49935 2.52051 1.77734C2.24707 2.05078 2.02832 2.37435 1.86426 2.74805C1.70475 3.11719 1.625 3.51367 1.625 3.9375ZM6.4375 4.375C6.31901 4.375 6.21647 4.33171 6.12988 4.24512C6.04329 4.15853 6 4.05599 6 3.9375C6 3.75521 5.96582 3.58431 5.89746 3.4248C5.8291 3.2653 5.73568 3.1263 5.61719 3.00781C5.4987 2.88932 5.3597 2.7959 5.2002 2.72754C5.04069 2.65918 4.86979 2.625 4.6875 2.625C4.56901 2.625 4.46647 2.58171 4.37988 2.49512C4.29329 2.40853 4.25 2.30599 4.25 2.1875C4.25 2.06901 4.29329 1.96647 4.37988 1.87988C4.46647 1.79329 4.56901 1.75 4.6875 1.75C4.98828 1.75 5.27083 1.80697 5.53516 1.9209C5.80404 2.03483 6.03646 2.19206 6.23242 2.39258C6.43294 2.58854 6.59017 2.82096 6.7041 3.08984C6.81803 3.35417 6.875 3.63672 6.875 3.9375C6.875 4.05599 6.83171 4.15853 6.74512 4.24512C6.65853 4.33171 6.55599 4.375 6.4375 4.375Z"
            fill="black"
          />
        </svg>
      `;case o.File:return n.d`
        <svg width="20" height="26" viewBox="0 0 20 26" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;case o.Files:return n.d`
        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M17 8C17.1354 8 17.263 8.02604 17.3828 8.07812C17.5078 8.13021 17.6146 8.20312 17.7031 8.29688C17.7969 8.38542 17.8698 8.48958 17.9219 8.60938C17.974 8.72917 18 8.85677 18 8.99219C18 9.14844 17.9635 9.29948 17.8906 9.44531L14.6172 16H2V5C2 4.85938 2.02604 4.72917 2.07812 4.60938C2.13021 4.48958 2.20052 4.38542 2.28906 4.29688C2.38281 4.20312 2.48958 4.13021 2.60938 4.07812C2.72917 4.02604 2.85938 4 3 4H5.75C5.98438 4 6.1849 4.02604 6.35156 4.07812C6.52344 4.125 6.67448 4.1849 6.80469 4.25781C6.9401 4.33073 7.0599 4.41146 7.16406 4.5C7.26823 4.58854 7.3724 4.66927 7.47656 4.74219C7.58594 4.8151 7.70052 4.8776 7.82031 4.92969C7.94531 4.97656 8.08854 5 8.25 5H14C14.1406 5 14.2708 5.02604 14.3906 5.07812C14.5104 5.13021 14.6146 5.20312 14.7031 5.29688C14.7969 5.38542 14.8698 5.48958 14.9219 5.60938C14.974 5.72917 15 5.85938 15 6V8H17ZM3 13.3828L5.41406 8.55469C5.5026 8.38281 5.625 8.2474 5.78125 8.14844C5.94271 8.04948 6.11979 8 6.3125 8H14V6H8.25C8.01562 6 7.8125 5.97656 7.64062 5.92969C7.47396 5.8776 7.32292 5.8151 7.1875 5.74219C7.05729 5.66927 6.9401 5.58854 6.83594 5.5C6.73177 5.41146 6.625 5.33073 6.51562 5.25781C6.41146 5.1849 6.29688 5.125 6.17188 5.07812C6.05208 5.02604 5.91146 5 5.75 5H3V13.3828ZM17 9H6.3125L3.3125 15H14L17 9Z"
          />
        </svg>
      `;case o.Back:return n.d`
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `}}!function(e){e[e.ArrowRight=0]="ArrowRight",e[e.ArrowDown=1]="ArrowDown",e[e.TeamSeparator=2]="TeamSeparator",e[e.Search=3]="Search",e[e.SkypeArrow=4]="SkypeArrow",e[e.SmallEmail=5]="SmallEmail",e[e.SmallChat=6]="SmallChat",e[e.ExpandDown=7]="ExpandDown",e[e.Overview=8]="Overview",e[e.Send=9]="Send",e[e.Contact=10]="Contact",e[e.Copy=11]="Copy",e[e.CellPhone=12]="CellPhone",e[e.Chat=13]="Chat",e[e.Department=14]="Department",e[e.Email=15]="Email",e[e.OfficeLocation=16]="OfficeLocation",e[e.Person=17]="Person",e[e.Messages=18]="Messages",e[e.Organization=19]="Organization",e[e.ExpandRight=20]="ExpandRight",e[e.Profile=21]="Profile",e[e.Birthday=22]="Birthday",e[e.File=23]="File",e[e.Files=24]="Files",e[e.Back=25]="Back"}(o||(o={}))},PL2B:function(e,t,r){"use strict";r.d(t,"a",function(){return o});class o{constructor(){this.eventHandlers=[]}fire(e){for(const t of this.eventHandlers)t(e)}add(e){this.eventHandlers.push(e)}remove(e){for(let t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}},PYfE:function(e,t,r){"use strict";r.d(t,"a",function(){return o});class o{constructor(e=o.DEFAULT_MAX_REDIRECTS,t=o.DEFAULT_SHOULD_RETRY){if(e>o.MAX_MAX_REDIRECTS){const e=new Error("MaxRedirects should not be more than "+o.MAX_MAX_REDIRECTS);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}o.DEFAULT_MAX_REDIRECTS=5,o.MAX_MAX_REDIRECTS=20,o.DEFAULT_SHOULD_RETRY=()=>!0},"R/m1":function(e,t,r){"use strict";r.d(t,"a",function(){return y});var o=r("hkiJ"),n=r("IVvM"),i=r("JpLj"),s=r("cmRh"),a=r("uHnN");r("cy2K");const c={cancelNewTaskSubtitle:"cancel",newTaskPlaceholder:"Task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var l=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class u extends s.MgtTemplatedComponent{constructor(){super(),this.clearState(),this._previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}get newTaskName(){return this._newTaskName}get strings(){return c}attributeChangedCallback(e,t,r){switch(super.attributeChangedCallback(e,t,r),e){case"target-id":case"initial-id":this.clearState(),this.requestStateUpdate()}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){const e=s.Providers.globalProvider;if(!e||e.state!==s.ProviderState.SignedIn)return o.d``;if(this.isLoadingState)return this.renderLoadingTask();const t=this.hideHeader?null:this.renderHeader(),r=this._isNewTaskVisible?this.renderNewTaskPanel():null,n=this.isLoadingState?this.renderLoadingTask():this.renderTasks();return o.d`
      ${t} ${r}
      <div class="Tasks" dir=${this.direction}>
        ${n}
      </div>
    `}renderHeader(){const e=this.renderHeaderContent(),t=Object(n.a)({AddBarItem:!0,NewTaskButton:!0,hidden:this.readOnly||this._isNewTaskVisible});return o.d`
      <div class="Header" dir=${this.direction}>
        ${e}
        <button class="${t}" @click="${()=>this.showNewTaskPanel()}">
          <span class="TaskIcon"></span>
          <span>${this.strings.addTaskButtonSubtitle}</span>
        </button>
      </div>
    `}renderLoadingTask(){return o.d`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderNewTaskPanel(){const e=this._newTaskName,t=o.d`
      <input
        type="text"
        placeholder="${this.strings.newTaskPlaceholder}"
        .value="${e}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="input"
        @input="${e=>{this._newTaskName=e.target.value,this.requestUpdate()}}"
      />
    `,r=Object(n.a)({Disabled:!(this._isNewTaskBeingAdded||e&&e.length),TaskAddButtonContainer:!0}),i=this._isNewTaskBeingAdded?null:o.d`
          <div class="TaskIcon TaskCancel" @click="${()=>this.hideNewTaskPanel()}">
            <span>${this.strings.cancelNewTaskSubtitle}</span>
          </div>
          <div class="TaskIcon TaskAdd" @click="${()=>this.addTask()}">
            <span></span>
          </div>
        `,s=this.renderNewTaskDetails();return o.d`
      <div dir=${this.direction} class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${t}
            </div>
            <div class="TaskDetails">
              ${s}
            </div>
          </div>
        </div>
        <div class="${r}">
          ${i}
        </div>
      </div>
    `}renderBucketIcon(){return o.d`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}addTask(){return e=this,void 0,r=function*(){if(!this._isNewTaskBeingAdded&&this.newTaskName){this._isNewTaskBeingAdded=!0,yield this.requestUpdate();try{yield this.createNewTask()}finally{this._isNewTaskBeingAdded=!1,this._isNewTaskVisible=!1,this.requestUpdate()}}},new((t=void 0)||(t=Promise))(function(o,n){function i(e){try{a(r.next(e))}catch(e){n(e)}}function s(e){try{a(r.throw(e))}catch(e){n(e)}}function a(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t(function(e){e(r)})).then(i,s)}a((r=r.apply(e,[])).next())});var e,t,r}clearNewTaskData(){this._newTaskName=""}clearState(){this.clearNewTaskData(),this._isNewTaskVisible=!1,this.requestUpdate()}handleTaskClick(e,t){this.fireCustomEvent("taskClick",{task:t})}dateToInputValue(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}showNewTaskPanel(){this._isNewTaskVisible=!0,this.requestUpdate()}hideNewTaskPanel(){this._isNewTaskVisible=!1,this.clearNewTaskData(),this.requestUpdate()}onResize(){this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())}}l([Object(o.f)({attribute:"read-only",type:Boolean}),d("design:type",Boolean)],u.prototype,"readOnly",void 0),l([Object(o.f)({attribute:"hide-header",type:Boolean}),d("design:type",Boolean)],u.prototype,"hideHeader",void 0),l([Object(o.f)({attribute:"hide-options",type:Boolean}),d("design:type",Boolean)],u.prototype,"hideOptions",void 0),l([Object(o.f)({attribute:"target-id",type:String}),d("design:type",String)],u.prototype,"targetId",void 0),l([Object(o.f)({attribute:"initial-id",type:String}),d("design:type",String)],u.prototype,"initialId",void 0),r("m4u+"),r("Snan");var h,p,f,g=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};!function(e){e[e.notStarted=0]="notStarted",e[e.inProgress=1]="inProgress",e[e.completed=2]="completed",e[e.deferred=3]="deferred",e[e.waitingOnOthers=4]="waitingOnOthers"}(h||(h={})),function(e){e[e.low=0]="low",e[e.normal=1]="normal",e[e.high=2]="high"}(p||(p={})),function(e){e[e.none=0]="none",e[e.default=1]="default",e[e.flaggedEmails=2]="flaggedEmails",e[e.unknownFutureValue=3]="unknownFutureValue"}(f||(f={}));const m=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--task-border:2px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:2px solid #797775;--task-complete-border:2px dotted #797775;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,2px solid #e1dfdd)}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#797775));font-size:12px;font-weight:600;white-space:nowrap;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;padding:4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{flex:0 0 auto;display:flex}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{height:100%;max-width:50px;min-width:50px;flex:1 1 auto;justify-content:center;align-items:center;display:flex;cursor:pointer}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4)}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{font-family:var(--default-font-family, "Segoe UI");font-size:14px;font-weight:600;color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));margin:0 12px 0 32px}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{background:var(--task-new-add-button-disabled-background,#eaeaea);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}
`],v={cancelNewTaskSubtitle:"cancel",newTaskPlaceholder:"Task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var b=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};let y=class extends u{constructor(){super(),this._graph=null,this._newTaskDueDate=null,this._newTaskListId="",this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}static get styles(){return m}get strings(){return v}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}renderTasks(){if(this._isLoadingTasks)return this.renderLoadingTask();let e=this._tasks;e&&this.taskFilter&&(e=e.filter(e=>this.taskFilter(e)));const t=Object(i.a)(e,e=>e.id,e=>this.renderTask(e));return o.d`
      ${t}
    `}renderNewTaskDetails(){const e=this._lists.filter(e=>this._currentList&&e.id===this._currentList.id||!this._currentList&&e.id===this._newTaskListId);e.length>0&&!this._newTaskListId&&(this._newTaskListId=e[0].id);const t=this._currentList?o.d`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <span>${this._currentList.displayName}</span>
          </span>
        `:o.d`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskListId}"
              @change="${e=>{this._newTaskListId=e.target.value}}"
            >
              ${e.map(e=>o.d`
                  <option value="${e.id}">${e.displayName}</option>
                `)}
            </select>
          </span>
        `,r=o.d`
      <span class="NewTaskDue">
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="input"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${e=>{const t=e.target.value;this._newTaskDueDate=t?new Date(t+"T17:00"):null}}"
        />
      </span>
    `;return o.d`
      ${t} ${r}
    `}renderHeaderContent(){if(this.isLoadingState)return o.d`
        <div class="header__loading"></div>
      `;const e=this._lists||[],t=this._currentList,r=this.targetId;let n;if(r&&e.length){const t=e.find(e=>e.id===r);t&&(n=o.d`
          <span class="PlanTitle">
            ${t.displayName}
          </span>
        `)}else if(t){const r={};for(const t of e)r[t.displayName]=()=>this.loadTaskList(t);n=o.d`
        <mgt-arrow-options .value="${t.displayName}" .options="${r}"></mgt-arrow-options>
      `}return o.d`
      <span class="TitleCont">
        ${n}
      </span>
    `}renderTask(e){const t={task:e,list:this._currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",t,e.id);const r=h[e.status]===h.completed,i=this._loadingTasks.includes(e.id),s={Complete:!i&&r,Loading:i,TaskCheck:!0,TaskIcon:!0},c=i?o.d`
          
        `:r?o.d`
          
        `:null;let l=null;if(this.hasTemplate("task-details"))l=this.renderTemplate("task-details",t,"task-details-"+e.id);else{const t=e.dueDateTime?o.d`
            <div class="TaskDetail TaskDue">
              <span>Due ${Object(a.g)(new Date(e.dueDateTime.dateTime))}</span>
            </div>
          `:null;l=o.d`
        <div class="TaskTitle">
          ${e.title}
        </div>
        <div class="TaskDetail TaskBucket">
          ${this.renderBucketIcon()}
          <span>${this._currentList.displayName}</span>
        </div>
        ${t}
      `}const d=this.readOnly||this.hideOptions?null:o.d`
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{[this.strings.removeTaskSubtitle]:t=>this.removeTask(t,e.id)}}"
              ></mgt-dot-options>
            </div>
          `,u=Object(n.a)({Complete:r,Incomplete:!r,ReadOnly:this.readOnly,Task:!0}),p=Object(n.a)({Complete:r,Incomplete:!r,TaskCheckContainer:!0});return o.d`
      <div class=${u}>
        <div class="TaskContent" @click="${t=>this.handleTaskClick(t,e)}}">
          <span class=${p} @click="${t=>this.handleTaskCheckClick(t,e)}">
            <span class=${Object(n.a)(s)}>
              <span class="TaskCheckContent">${c}</span>
            </span>
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery}">
            ${l}
          </div>
          ${d}
          <div class="Divider"></div>
        </div>
      </div>
    `}loadState(){return b(this,void 0,void 0,function*(){const e=s.Providers.globalProvider;if(!e||e.state!==s.ProviderState.SignedIn)return;if(!this._graph){const t=e.graph.forComponent(this);this._graph=t}let t=this._lists;if(!t||!t.length){if(this.targetId){const e=yield function(e,t){return g(this,void 0,void 0,function*(){return yield e.api("/me/todo/lists/"+t).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.Read")).get()})}(this._graph,this.targetId);t=e?[e]:[]}else t=yield function(e){return g(this,void 0,void 0,function*(){const t=yield e.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.Read")).get();return t&&t.value})}(this._graph);this._tasks=[],this._currentList=null,this._lists=t}let r=this._currentList;!r&&t&&t.length&&(this.initialId&&(r=t.find(e=>e.id===this.initialId)),r||(r=t[0]),this._tasks=[],this._currentList=r),r&&(yield this.loadTaskList(r))})}createNewTask(){return b(this,void 0,void 0,function*(){const e=this._currentList.id,t={title:this.newTaskName};this._newTaskDueDate&&(t.dueDateTime={dateTime:this._newTaskDueDate.toLocaleDateString(),timeZone:"UTC"});const r=yield function(e,t,r){return g(this,void 0,void 0,function*(){return yield e.api(`/me/todo/lists/${t}/tasks`).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.ReadWrite")).post(r)})}(this._graph,e,t);this._tasks.unshift(r)})}clearNewTaskData(){super.clearNewTaskData(),this._newTaskDueDate=null,this._newTaskListId=null}clearState(){super.clearState(),this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}loadTaskList(e){return b(this,void 0,void 0,function*(){this._isLoadingTasks=!0,this._currentList=e,this.requestUpdate(),this._tasks=yield function(e,t){return g(this,void 0,void 0,function*(){const r=yield e.api(`/me/todo/lists/${t}/tasks`).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.Read")).get();return r&&r.value})}(this._graph,e.id),this._isLoadingTasks=!1,this.requestUpdate()})}updateTaskStatus(e,t){return b(this,void 0,void 0,function*(){this._loadingTasks=[...this._loadingTasks,e.id],this.requestUpdate(),e.status=t;const r=this._currentList.id;e=yield function(e,t,r,o){return g(this,void 0,void 0,function*(){return yield e.api(`/me/todo/lists/${t}/tasks/${r}`).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.ReadWrite")).patch(o)})}(this._graph,r,e.id,e);const o=this._tasks.findIndex(t=>t.id===e.id);this._tasks[o]=e,this._loadingTasks=this._loadingTasks.filter(t=>t!==e.id),this.requestUpdate()})}removeTask(e,t){return b(this,void 0,void 0,function*(){this._tasks=this._tasks.filter(e=>e.id!==t),this.requestUpdate();const e=this._currentList.id;yield function(e,t,r){return g(this,void 0,void 0,function*(){yield e.api(`/me/todo/lists/${t}/tasks/${r}`).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.ReadWrite")).delete()})}(this._graph,e,t),this._tasks=this._tasks.filter(e=>e.id!==t)})}handleTaskCheckClick(e,t){this.readOnly||(h[t.status]===h.completed?this.updateTaskStatus(t,h.notStarted):this.updateTaskStatus(t,h.completed),e.stopPropagation(),e.preventDefault())}};y=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}([Object(o.c)("mgt-todo"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",[])}()],y)},R8cf:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i});var o=r("SkKE");function n(e){let t=i.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},i.set(e.type,t));let r=t.stringsArray.get(e.strings);if(void 0!==r)return r;const n=e.strings.join(o.f);return r=t.keyString.get(n),void 0===r&&(r=new o.a(e,e.getTemplateElement()),t.keyString.set(n,r)),t.stringsArray.set(e.strings,r),r}const i=new Map},"S/Up":function(e,t){},SkKE:function(e,t,r){"use strict";r.d(t,"f",function(){return o}),r.d(t,"g",function(){return n}),r.d(t,"b",function(){return s}),r.d(t,"a",function(){return a}),r.d(t,"d",function(){return l}),r.d(t,"c",function(){return d}),r.d(t,"e",function(){return u});const o=`{{lit-${String(Math.random()).slice(2)}}}`,n=`\x3c!--${o}--\x3e`,i=new RegExp(`${o}|${n}`),s="$lit$";class a{constructor(e,t){this.parts=[],this.element=t;const r=[],n=[],a=document.createTreeWalker(t.content,133,null,!1);let l=0,h=-1,p=0;const{strings:f,values:{length:g}}=e;for(;p<g;){const e=a.nextNode();if(null!==e){if(h++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:r}=t;let o=0;for(let e=0;e<r;e++)c(t[e].name,s)&&o++;for(;o-- >0;){const t=f[p],r=u.exec(t)[2],o=r.toLowerCase()+s,n=e.getAttribute(o);e.removeAttribute(o);const a=n.split(i);this.parts.push({type:"attribute",index:h,name:r,strings:a}),p+=a.length-1}}"TEMPLATE"===e.tagName&&(n.push(e),a.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(o)>=0){const o=e.parentNode,n=t.split(i),a=n.length-1;for(let t=0;t<a;t++){let r,i=n[t];if(""===i)r=d();else{const e=u.exec(i);null!==e&&c(e[2],s)&&(i=i.slice(0,e.index)+e[1]+e[2].slice(0,-s.length)+e[3]),r=document.createTextNode(i)}o.insertBefore(r,e),this.parts.push({type:"node",index:++h})}""===n[a]?(o.insertBefore(d(),e),r.push(e)):e.data=n[a],p+=a}}else if(8===e.nodeType)if(e.data===o){const t=e.parentNode;null!==e.previousSibling&&h!==l||(h++,t.insertBefore(d(),e)),l=h,this.parts.push({type:"node",index:h}),null===e.nextSibling?e.data="":(r.push(e),h--),p++}else{let t=-1;for(;-1!==(t=e.data.indexOf(o,t+1));)this.parts.push({type:"node",index:-1}),p++}}else a.currentNode=n.pop()}for(const e of r)e.parentNode.removeChild(e)}}const c=(e,t)=>{const r=e.length-t.length;return r>=0&&e.slice(r)===t},l=e=>-1!==e.index,d=()=>document.createComment(""),u=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/},Snan:function(e,t,r){"use strict";var o=r("hkiJ"),n=r("IVvM"),i=r("cmRh");const s=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host,mgt-dot-options{font-family:var(--default-font-family)}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap;transform:var(--dot-options-translateX,translateX(-50px))}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:var(--background-color--hover,#edebe9)}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:var(--background-color--active,#e1dfdd)}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}
`];var a=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let l=class extends i.MgtBaseComponent{constructor(){super(),this._clickHandler=null,this._clickHandler=e=>this.open=!1}static get styles(){return s}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){return o.d`
      <div class=${Object(n.a)({DotMenu:!0,Open:this.open})} @click=${e=>this.onDotClick(e)}>
        <span class="DotIcon">\uE712</span>
        <div class="Menu">
          ${Object.keys(this.options).map(e=>this.getMenuOption(e,this.options[e]))}
        </div>
      </div>
    `}getMenuOption(e,t){return o.d`
      <div
        class="DotItem"
        @click="${e=>{e.preventDefault(),e.stopPropagation(),t(e),this.open=!1}}"
      >
        <span class="DotItemName">
          ${e}
        </span>
      </div>
    `}onDotClick(e){e.preventDefault(),e.stopPropagation(),this.open=!this.open}};a([Object(o.f)({type:Boolean}),c("design:type",Boolean)],l.prototype,"open",void 0),a([Object(o.f)({type:Object}),c("design:type",Object)],l.prototype,"options",void 0),l=a([Object(o.c)("mgt-dot-options"),c("design:paramtypes",[])],l)},ThlN:function(e,t,r){"use strict";r.d(t,"c",function(){return Ct}),r.d(t,"b",function(){return It}),r.d(t,"a",function(){return At});var o=r("cmRh"),n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return(s=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function a(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})}function c(e,t){var r,o,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){s.label=i[1];break}if(6===i[0]&&s.label<n[1]){s.label=n[1],n=i;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(i);break}n[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function l(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return s}function d(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}var u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function h(e,t){function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var p=function(){return(p=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function f(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})}function g(e,t){var r,o,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){s.label=i[1];break}if(6===i[0]&&s.label<n[1]){s.label=n[1],n=i;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(i);break}n[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function m(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,n++)o[n]=i[s];return o}var v,b,y,w,k,C={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"AUTO_DISCOVER",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},T=[C.OPENID_SCOPE,C.PROFILE_SCOPE,C.OFFLINE_ACCESS_SCOPE],S=m(T,[C.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox"}(v||(v={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description"}(b||(b={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(y||(y={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox"}(w||(w={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(k||(k={}));var _,I={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(_||(_={}));var E,x,O,A,R,P,N,D,L={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(E||(E={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(x||(x={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(O||(O={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(A||(A={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(R||(R={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(P||(P={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(N||(N={})),function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}(D||(D={}));var U,M,j,H,F,q,B,$,z,V={SCHEMA_VERSION:2,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.POP="pop",e.BEARER="Bearer"}(U||(U={})),function(e){e.username="username",e.password="password"}(M||(M={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(j||(j={})),function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(H||(H={})),function(e){e.GET="GET",e.POST="POST"}(F||(F={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential"}(q||(q={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(B||(B={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent"}($||($={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(z||(z={}));var K,G={scopes:T};!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(K||(K={}));var W,Q=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),J=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Q.decimalToHex(e[0])+Q.decimalToHex(e[1])+Q.decimalToHex(e[2])+Q.decimalToHex(e[3])+"-"+Q.decimalToHex(e[4])+Q.decimalToHex(e[5])+"-"+Q.decimalToHex(e[6])+Q.decimalToHex(e[7])+"-"+Q.decimalToHex(e[8])+Q.decimalToHex(e[9])+"-"+Q.decimalToHex(e[10])+Q.decimalToHex(e[11])+Q.decimalToHex(e[12])+Q.decimalToHex(e[13])+Q.decimalToHex(e[14])+Q.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,n="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(o=16*Math.random()|0),"x"===t[i]?n+=r[o]:"y"===t[i]?(o&=3,n+=r[o|=8]):n+=t[i];return n}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),Y=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,o=e.length,n=0;n<o;n++)r+=(t=e.charCodeAt(n))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),s=0,a=0;s<r;a++)(t=e.charCodeAt(a))<128?i[s++]=t:t<2048?(i[s++]=192+(t>>>6),i[s++]=128+(63&t)):t<65536?(i[s++]=224+(t>>>12),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<2097152?(i[s++]=240+(t>>>18),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<67108864?(i[s++]=248+(t>>>24),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):(i[s++]=252+(t>>>30),i[s++]=128+(t>>>24&63),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return t},e.utf8ArrToString=function(e){for(var t="",r=void 0,o=e.length,n=0;n<o;n++)r=e[n],t+=String.fromCharCode(r>251&&r<254&&n+5<o?1073741824*(r-252)+(e[++n]-128<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:r>247&&r<252&&n+4<o?(r-248<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:r>239&&r<248&&n+3<o?(r-240<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:r>223&&r<240&&n+2<o?(r-224<<12)+(e[++n]-128<<6)+e[++n]-128:r>191&&r<224&&n+1<o?(r-192<<6)+e[++n]-128:r);return t},e}(),X=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=Y.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",o=void 0,n=e.length,i=0,s=0;s<n;s++)o=s%3,i|=e[s]<<(16>>>o&24),2!==o&&e.length-s!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Z=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Y.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),o=r.length,n=t?Math.ceil((3*o+1>>>2)/t)*t:3*o+1>>>2,i=new Uint8Array(n),s=void 0,a=void 0,c=0,l=0,d=0;d<o;d++)if(a=3&d,c|=this.b64ToUint6(r.charCodeAt(d))<<18-6*a,3===a||o-d==1){for(s=0;s<3&&l<n;s++,l++)i[l]=c>>>(16>>>s&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),ee=function(e){function t(r,o,n){var i=this,s=o?r+": "+o:r;return i=e.call(this,s)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||C.EMPTY_STRING,i.errorMessage=o||"",i.subError=n||"",i.name="AuthError",i}return h(t,e),t.createUnexpectedError=function(e){return new t("unexpected_error","Unexpected error in authentication.: "+e)},t}(Error),te=function(e){function t(r,o){var n=e.call(this,r,o)||this;return n.name="ClientAuthError",Object.setPrototypeOf(n,t.prototype),n}return h(t,e),t.createClientInfoDecodingError=function(e){return new t("client_info_decoding_error","The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause. Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t("client_info_empty_error","The client info was empty. Please review the trace to determine the root cause.")},t.createTokenParsingError=function(e){return new t("token_parsing_error","Token cannot be parsed. Please review stack trace to determine root cause. Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t("null_or_empty_token","The token is null or empty. Please review the trace to determine the root cause. Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t("endpoints_resolution_error","Error: could not resolve endpoints. Please check network and try again. Detail: "+e)},t.createNetworkError=function(e,r){return new t("network_error","Network request failed. Please check network trace to determine root cause. | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t("openid_config_error","Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints. Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t("hash_not_deserialized","The hash parameters could not be deserialized. Please review the trace to determine the root cause. Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t("invalid_state","State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState(). Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t("state_mismatch","State mismatch error. Please check your network. Continued requests may cause cache overflow.")},t.createStateNotFoundError=function(e){return new t("state_not_found","State not found:  "+e)},t.createNonceMismatchError=function(){return new t("nonce_mismatch","Nonce mismatch error. This may be caused by a race condition in concurrent requests.")},t.createNonceNotFoundError=function(e){return new t("nonce_not_found","nonce not found:  "+e)},t.createNoTokensFoundError=function(){return new t("no_tokens_found","No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken().")},t.createMultipleMatchingTokensInCacheError=function(){return new t("multiple_matching_tokens","The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account..")},t.createMultipleMatchingAccountsInCacheError=function(){return new t("multiple_matching_accounts","The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account")},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t("multiple_matching_appMetadata","The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata")},t.createTokenRequestCannotBeMadeError=function(){return new t("request_cannot_be_made","Token request cannot be made without authorization code or refresh token.")},t.createAppendEmptyScopeToSetError=function(e){return new t("cannot_append_empty_scope","Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info. Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t("cannot_remove_empty_scope","Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info. Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t("cannot_append_scopeset","Cannot append ScopeSet due to error. Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t("empty_input_scopeset","Empty input ScopeSet cannot be processed.")},t.createDeviceCodeCancelledError=function(){return new t("device_code_polling_cancelled","Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.")},t.createDeviceCodeExpiredError=function(){return new t("device_code_expired","Device code is expired.")},t.createDeviceCodeUnknownError=function(){return new t("device_code_unknown_error","Device code stopped polling for unknown reasons.")},t.createNoAccountInSilentRequestError=function(){return new t("no_account_in_silent_request","Please pass an account object, silent flow is not supported without account information")},t.createNullOrUndefinedCacheRecord=function(){return new t("invalid_cache_record","Cache record object was null or undefined.")},t.createInvalidCacheEnvironmentError=function(){return new t("invalid_cache_environment","Invalid environment when attempting to create cache entry")},t.createNoAccountFoundError=function(){return new t("no_account_found","No account found in cache for given key.")},t.createCachePluginError=function(){return new t("no cache plugin set on CacheManager","ICachePlugin needs to be set before using readFromStorage or writeFromStorage")},t.createNoCryptoObjectError=function(e){return new t("no_crypto_object","No crypto object detected. This is required for the following operation: "+e)},t.createInvalidCacheTypeError=function(){return new t("invalid_cache_type","Invalid cache type")},t.createUnexpectedAccountTypeError=function(){return new t("unexpected_account_type","Unexpected account type.")},t.createUnexpectedCredentialTypeError=function(){return new t("unexpected_credential_type","Unexpected credential type.")},t.createInvalidAssertionError=function(){return new t("invalid_assertion","Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515")},t.createInvalidCredentialError=function(){return new t("invalid_client_credential","Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential")},t.createRefreshRequiredError=function(){return new t("token_refresh_required","Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.")},t.createUserTimeoutReachedError=function(){return new t("user_timeout_reached","User defined timeout for device code polling reached")},t.createTokenClaimsRequiredError=function(){return new t("token_claims_cnf_required_for_signedjwt","Cannot generate a POP jwt if the token_claims are not populated")},t.createNoAuthCodeInServerResponseError=function(){return new t("authorization_code_missing_from_server_response","Server response does not contain an authorization code to proceed")},t}(ee),re=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw te.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw te.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(e){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t,r=/\+/g,o=/([^&=]+)=([^&]*)/g,n=function(e){return decodeURIComponent(decodeURIComponent(e.replace(r," ")))},i={};for(t=o.exec(e);t;)i[n(t[1])]=n(t[2]),t=o.exec(e);return i},e.trimArrayEntries=function(e){return e.map(function(e){return e.trim()})},e.removeEmptyStringsFromArray=function(t){return t.filter(function(t){return!e.isEmpty(t)})},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}(),oe=function(e){function t(r,o){var n=e.call(this,r,o)||this;return Object.setPrototypeOf(n,t.prototype),n.name="BrowserAuthError",n}return i(t,e),t.createPkceNotGeneratedError=function(e){return new t("pkce_not_created","The PKCE code challenge and verifier could not be generated. Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t("crypto_nonexistent","The crypto object or function is not available. Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t("http_method_not_implemented","The HTTP method given has not been implemented in this library. Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t("empty_navigate_uri","Navigation URI is empty. Please check stack trace for more info.")},t.createEmptyHashError=function(e){return new t("hash_empty_error","Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t("no_state_in_hash","Hash does not contain state. Please verify that the request originated from msal.")},t.createHashDoesNotContainKnownPropertiesError=function(){return new t("hash_does_not_contain_known_properties","Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.")},t.createUnableToParseStateError=function(){return new t("unable_to_parse_state","Unable to parse state. Please verify that the request originated from msal.")},t.createStateInteractionTypeMismatchError=function(){return new t("state_interaction_type_mismatch","Hash contains state but the interaction type does not match the caller.")},t.createInteractionInProgressError=function(){return new t("interaction_in_progress","Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors.")},t.createPopupWindowError=function(e){var r="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.";return new t("popup_window_error",r=re.isEmpty(e)?r:r+" Details: "+e)},t.createEmptyWindowCreatedError=function(){return new t("empty_window_error","window.open returned null or undefined window object.")},t.createUserCancelledError=function(){return new t("user_cancelled","User cancelled the flow.")},t.createMonitorPopupTimeoutError=function(){return new t("monitor_window_timeout","Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.")},t.createMonitorIframeTimeoutError=function(){return new t("monitor_window_timeout","Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.")},t.createRedirectInIframeError=function(e){return new t("redirect_in_iframe","Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs. (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t("block_iframe_reload","Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors")},t.createBlockAcquireTokenInPopupsError=function(){return new t("block_nested_popups","Request was blocked inside a popup because MSAL detected it was running in a popup.")},t.createIframeClosedPrematurelyError=function(){return new t("iframe_closed_prematurely","The iframe being monitored was closed prematurely.")},t.createSilentSSOInsufficientInfoError=function(){return new t("silent_sso_error","Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid.")},t.createNoAccountError=function(){return new t("no_account_error","No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.")},t.createSilentPromptValueError=function(e){return new t("silent_prompt_value_error","The value given for the prompt value is not valid for silent requests - must be set to 'none'. Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t("unable_to_parse_token_request_cache_error","The cached token request could not be parsed.")},t.createNoTokenRequestCacheError=function(){return new t("no_token_request_cache_error","No token request in found in cache.")},t.createAuthRequestNotSetError=function(){return new t("auth_request_not_set_error","Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler")},t.createNoCachedAuthorityError=function(){return new t("no_cached_authority_error","No cached authority found.")},t.createInvalidCacheTypeError=function(){return new t("invalid_cache_type","Invalid cache type")},t.createNonBrowserEnvironmentError=function(){return new t("non_browser_environment","Login and token requests are not supported in non-browser environments.")},t.createDatabaseNotOpenError=function(){return new t("database_not_open","Database is not open!")},t.createNoNetworkConnectivityError=function(){return new t("no_network_connectivity","No network connectivity. Check your internet connection.")},t.createPostRequestFailedError=function(e,r){return new t("post_request_failed","Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA' | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t("get_request_failed","Network request failed. Please check the network trace to determine root cause. | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t("failed_to_parse_response","Failed to parse network response. Check network trace. | Attempted to reach: "+e.split("?")[0])},t}(ee),ne=function(){function e(e){this.base64Encode=new X,this.cryptoObj=e}return e.prototype.generateCodes=function(){return a(this,void 0,void 0,function(){var e,t;return c(this,function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}})})},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw oe.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return a(this,void 0,void 0,function(){var t,r;return c(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=o.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=o.sent(),oe.createPkceNotGeneratedError(r);case 3:return[2]}})})},e}(),ie=new Uint8Array([1,0,1]),se=function(){function e(){if(!this.hasCryptoAPI())throw oe.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256",modulusLength:2048,publicExponent:ie}}return e.prototype.sha256Digest=function(e){return a(this,void 0,void 0,function(){var t;return c(this,function(r){return t=Y.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest("SHA-256",t):this.getSubtleCryptoDigest("SHA-256",t)]})})},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw oe.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return a(this,void 0,void 0,function(){return c(this,function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]})})},e.prototype.exportJwk=function(e){return a(this,void 0,void 0,function(){return c(this,function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey("jwk",e)]})})},e.prototype.importJwk=function(t,r,o){return a(this,void 0,void 0,function(){var n,i;return c(this,function(s){return n=e.getJwkString(t),i=Y.stringToArrayBuffer(n),[2,this.hasIECrypto()?this.msCryptoImportKey(i,r,o):window.crypto.subtle.importKey("jwk",t,this._keygenAlgorithmOptions,r,o)]})})},e.prototype.sign=function(e,t){return a(this,void 0,void 0,function(){return c(this,function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]})})},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(e,t){return a(this,void 0,void 0,function(){return c(this,function(r){return[2,window.crypto.subtle.digest(e,t)]})})},e.prototype.getMSCryptoDigest=function(e,t){return a(this,void 0,void 0,function(){return c(this,function(r){return[2,new Promise(function(r,o){var n=window.msCrypto.subtle.digest(e,t.buffer);n.addEventListener("complete",function(e){r(e.target.result)}),n.addEventListener("error",function(e){o(e)})})]})})},e.prototype.msCryptoGenerateKey=function(e,t){return a(this,void 0,void 0,function(){var r=this;return c(this,function(o){return[2,new Promise(function(o,n){var i=window.msCrypto.subtle.generateKey(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",function(e){o(e.target.result)}),i.addEventListener("error",function(e){n(e)})})]})})},e.prototype.msCryptoExportJwk=function(e){return a(this,void 0,void 0,function(){return c(this,function(t){return[2,new Promise(function(t,r){var o=window.msCrypto.subtle.exportKey("jwk",e);o.addEventListener("complete",function(e){var o=e.target.result,n=Y.utf8ArrToString(new Uint8Array(o)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(n))}catch(e){r(e)}}),o.addEventListener("error",function(e){r(e)})})]})})},e.prototype.msCryptoImportKey=function(e,t,r){return a(this,void 0,void 0,function(){var o=this;return c(this,function(n){return[2,new Promise(function(n,i){var s=window.msCrypto.subtle.importKey("jwk",e,o._keygenAlgorithmOptions,t,r);s.addEventListener("complete",function(e){n(e.target.result)}),s.addEventListener("error",function(e){i(e)})})]})})},e.prototype.msCryptoSign=function(e,t){return a(this,void 0,void 0,function(){var r=this;return c(this,function(o){return[2,new Promise(function(o,n){var i=window.msCrypto.subtle.sign(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",function(e){o(e.target.result)}),i.addEventListener("error",function(e){n(e)})})]})})},e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),ae=function(){function e(e,t,r){this.dbName=e,this.tableName=t,this.version=r,this.dbOpen=!1}return e.prototype.open=function(){return a(this,void 0,void 0,function(){var e=this;return c(this,function(t){return[2,new Promise(function(t,r){var o=window.indexedDB.open(e.dbName,e.version);o.addEventListener("upgradeneeded",function(t){t.target.result.createObjectStore(e.tableName)}),o.addEventListener("success",function(r){var o=r;e.db=o.target.result,e.dbOpen=!0,t()}),o.addEventListener("error",function(e){return r(e)})})]})})},e.prototype.get=function(e){return a(this,void 0,void 0,function(){var t=this;return c(this,function(r){switch(r.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:r.sent(),r.label=2;case 2:return[2,new Promise(function(r,o){if(!t.db)return o(oe.createDatabaseNotOpenError());var n=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);n.addEventListener("success",function(e){r(e.target.result)}),n.addEventListener("error",function(e){return o(e)})})]}})})},e.prototype.put=function(e,t){return a(this,void 0,void 0,function(){var r=this;return c(this,function(o){switch(o.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:o.sent(),o.label=2;case 2:return[2,new Promise(function(o,n){if(!r.db)return n(oe.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",function(e){o(e.target.result)}),i.addEventListener("error",function(e){return n(e)})})]}})})},e}(),ce=function(){function e(){this.browserCrypto=new se,this.b64Encode=new X,this.b64Decode=new Z,this.guidGenerator=new J(this.browserCrypto),this.pkceGenerator=new ne(this.browserCrypto),this.cache=new ae(e.DB_NAME,e.TABLE_NAME,e.DB_VERSION)}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return a(this,void 0,void 0,function(){return c(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},e.prototype.getPublicKeyThumbprint=function(t){return a(this,void 0,void 0,function(){var r,o,n,i,s,a,l,d;return c(this,function(c){switch(c.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return r=c.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return o=c.sent(),n={e:o.e,kty:o.kty,n:o.n},i=se.getJwkString(n),[4,this.browserCrypto.sha256Digest(i)];case 3:return s=c.sent(),a=this.b64Encode.urlEncodeArr(new Uint8Array(s)),[4,this.browserCrypto.exportJwk(r.privateKey)];case 4:return l=c.sent(),[4,this.browserCrypto.importJwk(l,!1,["sign"])];case 5:return d=c.sent(),this.cache.put(a,{privateKey:d,publicKey:r.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri}),[2,a]}})})},e.prototype.signJwt=function(e,t){return a(this,void 0,void 0,function(){var r,o,n,i,s,a,l,d,u,h;return c(this,function(c){switch(c.label){case 0:return[4,this.cache.get(t)];case 1:return r=c.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return o=c.sent(),n=se.getJwkString(o),i={alg:o.alg,type:"jwk"},s=this.b64Encode.urlEncode(JSON.stringify(i)),e.cnf={jwk:JSON.parse(n)},a=this.b64Encode.urlEncode(JSON.stringify(e)),l=s+"."+a,d=Y.stringToArrayBuffer(l),[4,this.browserCrypto.sign(r.privateKey,d)];case 3:return u=c.sent(),h=this.b64Encode.urlEncodeArr(new Uint8Array(u)),[2,l+"."+h]}})})},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e.DB_VERSION=1,e.DB_NAME="msal.db",e.TABLE_NAME=e.DB_NAME+".keys",e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(W||(W={}));var le,de=function(){function e(e,t,r){this.level=W.Info,this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level=e.logLevel||W.Info,this.correlationId=e.correlationId||"",this.packageName=t||C.EMPTY_STRING,this.packageVersion=r||C.EMPTY_STRING}return e.prototype.clone=function(t,r,o){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:o||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),o=(re.isEmpty(t.correlationId)?re.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+W[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,o,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:W.Error,containsPii:!1,correlationId:t||""})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:W.Error,containsPii:!0,correlationId:t||""})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:W.Warning,containsPii:!1,correlationId:t||""})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:W.Warning,containsPii:!0,correlationId:t||""})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:W.Info,containsPii:!1,correlationId:t||""})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:W.Info,containsPii:!0,correlationId:t||""})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:W.Verbose,containsPii:!1,correlationId:t||""})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:W.Verbose,containsPii:!0,correlationId:t||""})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:W.Trace,containsPii:!1,correlationId:t||""})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:W.Trace,containsPii:!0,correlationId:t||""})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),ue={createNewGuid:function(){throw ee.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw ee.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw ee.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return f(this,void 0,void 0,function(){return g(this,function(e){throw ee.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})},getPublicKeyThumbprint:function(){return f(this,void 0,void 0,function(){return g(this,function(e){throw ee.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")})})},signJwt:function(){return f(this,void 0,void 0,function(){return g(this,function(e){throw ee.createUnexpectedError("Crypto interface - signJwt() has not been implemented")})})}},he=function(e){function t(r,o){var n=e.call(this,r,o)||this;return n.name="ClientConfigurationError",Object.setPrototypeOf(n,t.prototype),n}return h(t,e),t.createRedirectUriEmptyError=function(){return new t("redirect_uri_empty","A redirect URI is required for all calls, and none has been set.")},t.createPostLogoutRedirectUriEmptyError=function(){return new t("post_logout_uri_empty","A post logout redirect has not been set.")},t.createClaimsRequestParsingError=function(e){return new t("claims_request_parsing_error","Could not parse the given claims request object. Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t("authority_uri_insecure","Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options Given URI: "+e)},t.createUrlParseError=function(e){return new t("url_parse_error","URL could not be parsed into appropriate segments. Given Error: "+e)},t.createUrlEmptyError=function(){return new t("empty_url_error","URL was empty or null.")},t.createEmptyScopesArrayError=function(){return new t("empty_input_scopes_error","Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.")},t.createClientIdSingleScopeError=function(e){return new t("clientid_input_scopes_error","Client ID can only be provided as a single scope. Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t("invalid_prompt_value","Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t("invalid_claims","Given claims parameter must be a stringified JSON object.")},t.createEmptyLogoutRequestError=function(){return new t("logout_request_empty","The logout request was null or undefined.")},t.createEmptyTokenRequestError=function(){return new t("token_request_empty","Token request was empty and not found in cache.")},t.createInvalidCodeChallengeMethodError=function(){return new t("invalid_code_challenge_method",'code_challenge_method passed is invalid. Valid values are "plain" and "S256".')},t.createInvalidCodeChallengeParamsError=function(){return new t("pkce_params_missing","Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request")},t.createInvalidCloudDiscoveryMetadataError=function(){return new t("invalid_cloud_discovery_metadata","Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields")},t.createInvalidAuthorityMetadataError=function(){return new t("invalid_authority_metadata","Invalid authorityMetadata provided. Must by a JSON object containing authorization_endpoint, token_endpoint, end_session_endpoint, issuer fields.")},t.createUntrustedAuthorityError=function(){return new t("untrusted_authority","The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.")},t}(te),pe=function(){function e(t){if(this._urlString=t,re.isEmpty(this._urlString))throw he.createUrlEmptyError();re.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return re.endsWith(t,"?")?t=t.slice(0,-1):re.endsWith(t,"?/")&&(t=t.slice(0,-2)),re.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw he.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw he.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw he.createInsecureAuthorityUriError(this.urlString)},e.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},e.appendQueryString=function(e,t){return re.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),o=r.PathSegments;return!t||0===o.length||o[0]!==y.COMMON&&o[0]!==y.ORGANIZATIONS||(o[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw he.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=r.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0}),r.PathSegments=o,!re.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw he.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===C.FORWARD_SLASH){var o=new e(r).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):""},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(re.isEmpty(t))return{};var r=e.parseHash(t),o=re.queryStringToObject(re.isEmpty(r)?t:r);if(!o)throw te.createHashNotDeserializedError(JSON.stringify(o));return o},e.hashContainsKnownProperties=function(t){if(re.isEmpty(t))return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}(),fe=function(e){function t(r,o,n){var i=e.call(this,r,o,n)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return h(t,e),t}(ee),ge=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return"throttling."+JSON.stringify(e)},e.preProcess=function(t,r){var o,n=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(n);if(i){if(i.throttleTime<Date.now())return void t.removeItem(n,P.THROTTLING);throw new fe((null===(o=i.errorCodes)||void 0===o?void 0:o.join(" "))||C.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,r,o){if(e.checkResponseStatus(o)||e.checkResponseForRetryAfter(o)){var n={throttleTime:e.calculateThrottleTime(parseInt(o.headers[v.RETRY_AFTER])),error:o.body.error,errorCodes:o.body.error_codes,errorMessage:o.body.error_description,subError:o.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),n)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(v.RETRY_AFTER)&&(e.status<200||e.status>=300)},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))},e.removeThrottle=function(e,t,r,o,n){var i={clientId:t,authority:r,scopes:o,homeAccountIdentifier:n},s=this.generateThrottlingStorageKey(i);return e.removeItem(s,P.THROTTLING)},e}(),me=["interaction_required","consent_required","login_required"],ve=["message_only","additional_action","basic_action","user_password_expired","consent_required"],be=function(e){function t(r,o,n){var i=e.call(this,r,o,n)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return h(t,e),t.isInteractionRequiredError=function(e,t,r){var o=!!e&&me.indexOf(e)>-1,n=!!r&&ve.indexOf(r)>-1,i=!!t&&me.some(function(e){return t.indexOf(e)>-1});return o||i||n},t}(fe);function ye(e,t){if(re.isEmpty(e))throw te.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw te.createClientInfoDecodingError(e)}}function we(e){if(re.isEmpty(e))throw te.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(A.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?C.EMPTY_STRING:t[1]}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(le||(le={}));var ke,Ce=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(A.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case O.ADFS_ACCOUNT_TYPE:return N.ADFS;case O.MSAV1_ACCOUNT_TYPE:return N.MSA;case O.MSSTS_ACCOUNT_TYPE:return N.MSSTS;case O.GENERIC_ACCOUNT_TYPE:return N.GENERIC;default:throw te.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(A.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,o,n,i,s,a){var c,l,d,u,h,p,f=new e;f.authorityType=O.MSSTS_ACCOUNT_TYPE,f.clientInfo=t,f.homeAccountId=r;var g=o.getPreferredCache();if(re.isEmpty(g))throw te.createInvalidCacheEnvironmentError();return f.environment=g,f.realm=(null===(c=null==n?void 0:n.claims)||void 0===c?void 0:c.tid)||"",f.oboAssertion=i,n&&(f.idTokenClaims=n.claims,f.localAccountId=(null===(l=null==n?void 0:n.claims)||void 0===l?void 0:l.oid)||(null===(d=null==n?void 0:n.claims)||void 0===d?void 0:d.sub)||"",f.username=(null===(u=null==n?void 0:n.claims)||void 0===u?void 0:u.preferred_username)||((null===(h=null==n?void 0:n.claims)||void 0===h?void 0:h.emails)?n.claims.emails[0]:""),f.name=null===(p=null==n?void 0:n.claims)||void 0===p?void 0:p.name),f.cloudGraphHostName=s,f.msGraphHost=a,f},e.createGenericAccount=function(t,r,o,n,i,s){var a,c,l,d,u=new e;u.authorityType=t.authorityType===le.Adfs?O.ADFS_ACCOUNT_TYPE:O.GENERIC_ACCOUNT_TYPE,u.homeAccountId=r,u.realm="",u.oboAssertion=n;var h=t.getPreferredCache();if(re.isEmpty(h))throw te.createInvalidCacheEnvironmentError();return o&&(u.localAccountId=(null===(a=null==o?void 0:o.claims)||void 0===a?void 0:a.oid)||(null===(c=null==o?void 0:o.claims)||void 0===c?void 0:c.sub)||"",u.username=(null===(l=null==o?void 0:o.claims)||void 0===l?void 0:l.upn)||"",u.name=(null===(d=null==o?void 0:o.claims)||void 0===d?void 0:d.name)||"",u.idTokenClaims=null==o?void 0:o.claims),u.environment=h,u.cloudGraphHostName=i,u.msGraphHost=s,u},e.generateHomeAccountId=function(e,t,r,o,n){var i,s=(null===(i=null==n?void 0:n.claims)||void 0===i?void 0:i.sub)?n.claims.sub:C.EMPTY_STRING;if(t===le.Adfs)return s;if(e)try{var a=ye(e,o);if(!re.isEmpty(a.uid)&&!re.isEmpty(a.utid))return""+a.uid+A.CLIENT_INFO_SEPARATOR+a.utid}catch(e){}return r.verbose("No client info in response"),s},e.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var o=!0;if(r){var n=e.idTokenClaims||{},i=t.idTokenClaims||{};o=n.iat===i.iat&&n.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&o},e}();function Te(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("end_session_endpoint")&&e.hasOwnProperty("issuer")}!function(e){e.AAD="AAD",e.OIDC="OIDC"}(ke||(ke={}));var Se,_e=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var o=Number(t)||0;return e.nowSeconds()+r>o},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise(function(r){return setTimeout(function(){return r(t)},e)})},e}(),Ie=function(){function e(){this.expiresAt=_e.nowSeconds()+86400}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=_e.nowSeconds()+86400},e.prototype.isExpired=function(){return this.expiresAt<=_e.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&0===e.indexOf("authority-metadata")&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("end_session_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")},e}(),Ee=function(){function e(e){this.networkInterface=e}return e.prototype.detectRegion=function(e){return f(this,void 0,void 0,function(){var t,r,o,n;return g(this,function(i){switch(i.label){case 0:if(t=e)return[3,7];i.label=1;case 1:return i.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(C.IMDS_VERSION)];case 2:return(r=i.sent()).status===j.httpSuccess&&(t=r.body),r.status!==j.httpBadRequest?[3,5]:[4,this.getCurrentVersion()];case 3:return(o=i.sent())?[4,this.getRegionFromIMDS(o)]:[2,null];case 4:(n=i.sent()).status===j.httpSuccess&&(t=n.body),i.label=5;case 5:return[3,7];case 6:return i.sent(),[2,null];case 7:return[2,t||null]}})})},e.prototype.getRegionFromIMDS=function(t){return f(this,void 0,void 0,function(){return g(this,function(r){return[2,this.networkInterface.sendGetRequestAsync(C.IMDS_ENDPOINT+"?api-version="+t+"&format=text",e.IMDS_OPTIONS,C.IMDS_TIMEOUT)]})})},e.prototype.getCurrentVersion=function(){return f(this,void 0,void 0,function(){var t;return g(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(C.IMDS_ENDPOINT+"?format=json",e.IMDS_OPTIONS)];case 1:return(t=r.sent()).status===j.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return r.sent(),[2,null];case 3:return[2]}})})},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),xe=function(){function e(e,t,r,o){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=o,this.regionDiscovery=new Ee(t)}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===C.ADFS?le.Adfs:le.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new pe(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw te.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw te.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw te.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw te.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw te.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new pe(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(function(e,o){var n=r[o];e!==n&&(t=t.replace("/"+n+"/","/"+e+"/"))}),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===le.Adfs||this.protocolMode===ke.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return f(this,void 0,void 0,function(){var e,t,r,o;return g(this,function(n){switch(n.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new Ie).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=n.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=n.sent(),t!==D.CACHE&&r!==D.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e,[2]}})})},e.prototype.updateEndpointMetadata=function(t){var r;return f(this,void 0,void 0,function(){var o,n,i;return g(this,function(s){switch(s.label){case 0:return(o=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(o,!1),[2,D.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,D.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return(o=s.sent())?(null===(r=this.authorityOptions.azureRegionConfiguration)||void 0===r?void 0:r.azureRegion)?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion)]:[3,3]:[3,4];case 2:n=s.sent(),(i=this.authorityOptions.azureRegionConfiguration.azureRegion===C.AZURE_REGION_AUTO_DISCOVER_FLAG?n:this.authorityOptions.azureRegionConfiguration.azureRegion)&&(o=e.replaceWithRegionalInformation(o,i)),s.label=3;case 3:return t.updateEndpointMetadata(o,!0),[2,D.NETWORK];case 4:throw te.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})},e.prototype.isAuthoritySameType=function(e){return new pe(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw he.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return f(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint)];case 1:return[2,Te((e=t.sent()).body)?e.body:null];case 2:return t.sent(),[2,null];case 3:return[2]}})})},e.prototype.updateCloudDiscoveryMetadata=function(e){return f(this,void 0,void 0,function(){var t;return g(this,function(r){switch(r.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,D.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,D.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,D.NETWORK];throw he.createUntrustedAuthorityError()}})})},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(r)return r}catch(e){throw he.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return f(this,void 0,void 0,function(){var t,r,o,n;return g(this,function(i){switch(i.label){case 0:t=""+C.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",r=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t)];case 2:return o=i.sent(),0===(n=function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(o.body)?o.body.metadata:[]).length?[2,null]:(r=e.getCloudDiscoveryMetadataFromNetworkResponse(n,this.hostnameAndPort),[3,4]);case 3:return i.sent(),[2,null];case 4:return r||(r=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}})})},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter(function(t){return pe.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort}).length>0},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var o=e[r];if(o.aliases.indexOf(t)>-1)return o}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw te.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return C.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var o=new pe(e);o.validateAsUri();var n=o.getUrlComponents(),i=t+"."+n.HostNameAndPort;this.isPublicCloudAuthority(n.HostNameAndPort)&&(i=t+"."+C.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=pe.constructAuthorityUriFromObject(p(p({},o.getUrlComponents()),{HostNameAndPort:i})).urlString;return r?s+"?"+r:s},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,"allowestsrnonmsi=true"),t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r),t},e}(),Oe=function(){function e(){}return e.createDiscoveredInstance=function(t,r,o,n){return f(this,void 0,void 0,function(){var i,s;return g(this,function(a){switch(a.label){case 0:i=e.createInstance(t,r,o,n),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,i.resolveEndpointsAsync()];case 2:return a.sent(),[2,i];case 3:throw s=a.sent(),te.createEndpointDiscoveryIncompleteError(s);case 4:return[2]}})})},e.createInstance=function(e,t,r,o){if(re.isEmpty(e))throw he.createUrlEmptyError();return new xe(e,t,r,o)},e}(),Ae=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},e.prototype.generateType=function(){switch(this.credentialType){case R.ID_TOKEN:return N.ID_TOKEN;case R.ACCESS_TOKEN:return N.ACCESS_TOKEN;case R.REFRESH_TOKEN:return N.REFRESH_TOKEN;default:throw te.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(R.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(R.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?R.ACCESS_TOKEN_WITH_AUTH_SCHEME:R.ACCESS_TOKEN:-1!==e.indexOf(R.ID_TOKEN.toLowerCase())?R.ID_TOKEN:-1!==e.indexOf(R.REFRESH_TOKEN.toLowerCase())?R.REFRESH_TOKEN:C.NOT_DEFINED},e.generateCredentialCacheKey=function(e,t,r,o,n,i,s){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,o,n,s),this.generateTargetForCacheKey(i)].join(A.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(A.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,o){return[e,e===R.REFRESH_TOKEN&&o||t,r||""].join(A.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},e}(),Re=function(){function e(e){var t=this,r=e?re.trimArrayEntries(m(e)):[],o=r?re.removeEmptyStringsFromArray(r):[];this.validateInputScopes(o),this.scopes=new Set,o.forEach(function(e){return t.scopes.add(e)})}return e.fromString=function(t){return new e((t||"").split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw he.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!re.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(function(e){return t.containsScope(e)})},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return S.forEach(function(r){e.containsScope(r)&&(t+=1)}),this.scopes.size===t},e.prototype.appendScope=function(e){re.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(e){return t.appendScope(e)})}catch(e){throw te.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(re.isEmpty(e))throw te.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;S.forEach(function(t){e.scopes.delete(t)})},e.prototype.unionScopeSets=function(e){if(!e)throw te.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach(function(e){return t.add(e.toLowerCase())}),this.scopes.forEach(function(e){return t.add(e.toLowerCase())}),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw te.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),o=this.getScopeCount();return t.size<o+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach(function(t){return e.push(t)}),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}(),Pe=function(){function e(t,r){if(re.isEmpty(t))throw te.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=re.decodeAuthToken(e);try{var o=r.JWSPayload,n=t.base64Decode(o);return JSON.parse(n)}catch(e){throw te.createTokenParsingError(e)}},e}(),Ne=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,r=this.getAccountsFilteredBy(),o=Object.keys(r).map(function(e){return r[e]});return o.length<1?[]:o.map(function(r){var o=e.toObject(new Ce,r).getAccountInfo(),n=t.readIdTokenFromCache(t.clientId,o);return n&&!o.idTokenClaims&&(o.idTokenClaims=new Pe(n.secret,t.cryptoImpl).claims),o})},e.prototype.saveCacheRecord=function(e){if(!e)throw te.createNullOrUndefinedCacheRecord();e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)},e.prototype.saveAccessToken=function(e){var t=this,r=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),o=Re.fromString(e.target),n=Object.keys(r.accessTokens).map(function(e){return r.accessTokens[e]});n&&n.forEach(function(e){Re.fromString(e.target).intersectingScopeSets(o)&&t.removeCredential(e)}),this.setAccessTokenCredential(e)},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},e.prototype.getAccountsFilteredByInternal=function(e,t,r){var o=this,n=this.getKeys(),i={};return n.forEach(function(n){var s=o.getAccount(n);s&&(e&&!o.matchHomeAccountId(s,e)||t&&!o.matchEnvironment(s,t)||r&&!o.matchRealm(s,r)||(i[n]=s))}),i},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion)},e.prototype.getCredentialsFilteredByInternal=function(e,t,r,o,n,i,s,a){var c=this,l=this.getKeys(),d={idTokens:{},accessTokens:{},refreshTokens:{}};return l.forEach(function(l){var u=Ae.getCredentialType(l);if(u!==C.NOT_DEFINED){var h=c.getSpecificCredential(l,u);if(h&&(!a||c.matchOboAssertion(h,a))&&(!e||c.matchHomeAccountId(h,e))&&(!t||c.matchEnvironment(h,t))&&(!i||c.matchRealm(h,i))&&(!r||c.matchCredentialType(h,r))&&(!o||c.matchClientId(h,o))&&(!n||c.matchFamilyId(h,n))&&(!s||c.matchTarget(h,s)))switch(u){case R.ID_TOKEN:d.idTokens[l]=h;break;case R.ACCESS_TOKEN:case R.ACCESS_TOKEN_WITH_AUTH_SCHEME:d.accessTokens[l]=h;break;case R.REFRESH_TOKEN:d.refreshTokens[l]=h}}}),d},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,o=this.getKeys(),n={};return o.forEach(function(o){if(r.isAppMetadata(o)){var i=r.getAppMetadata(o);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(n[o]=i))}}),n},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),o=null;return r.forEach(function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var n=t.getAuthorityMetadata(r);n&&-1!==n.aliases.indexOf(e)&&(o=n)}}),o},e.prototype.removeAllAccounts=function(){var e=this;return this.getKeys().forEach(function(t){e.getAccount(t)&&e.removeAccount(t)}),!0},e.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw te.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,P.ACCOUNT)},e.prototype.removeAccountContext=function(e){var t=this,r=this.getKeys(),o=e.generateAccountId();return r.forEach(function(e){var r=Ae.getCredentialType(e);if(r!==C.NOT_DEFINED){var n=t.getSpecificCredential(e,r);n&&o===n.generateAccountId()&&t.removeCredential(n)}}),!0},e.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,P.CREDENTIAL)},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach(function(t){e.isAppMetadata(t)&&e.removeItem(t,P.APP_METADATA)}),!0},e.prototype.readCacheRecord=function(e,t,r,o,n){var i=this.readAccountFromCache(e),s=this.readIdTokenFromCache(t,e),a=this.readAccessTokenFromCache(t,e,r,n),c=this.readRefreshTokenFromCache(t,e,!1),l=this.readAppMetadataFromCache(o,t);return i&&s&&(i.idTokenClaims=new Pe(s.secret,this.cryptoImpl).claims),{account:i,idToken:s,accessToken:a,refreshToken:c,appMetadata:l}},e.prototype.readAccountFromCache=function(e){var t=Ce.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:R.ID_TOKEN,clientId:e,realm:t.tenantId},o=this.getCredentialsFilteredBy(r),n=Object.keys(o.idTokens).map(function(e){return o.idTokens[e]}),i=n.length;if(i<1)return null;if(i>1)throw te.createMultipleMatchingTokensInCacheError();return n[0]},e.prototype.readAccessTokenFromCache=function(e,t,r,o){var n=o===U.POP?R.ACCESS_TOKEN_WITH_AUTH_SCHEME:R.ACCESS_TOKEN,i={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:n,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase()},s=this.getCredentialsFilteredBy(i),a=Object.keys(s.accessTokens).map(function(e){return s.accessTokens[e]}),c=a.length;if(c<1)return null;if(c>1)throw te.createMultipleMatchingTokensInCacheError();return a[0]},e.prototype.readRefreshTokenFromCache=function(e,t,r){var o=r?"1":void 0,n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:R.REFRESH_TOKEN,clientId:e,familyId:o},i=this.getCredentialsFilteredBy(n),s=Object.keys(i.refreshTokens).map(function(e){return i.refreshTokens[e]});return s.length<1?null:s[0]},e.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},o=this.getAppMetadataFilteredBy(r),n=Object.keys(o).map(function(e){return o[e]}),i=n.length;if(i<1)return null;if(i>1)throw te.createMultipleMatchingAppMetadataInCacheError();return n[0]},e.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||"1"!==r.familyId)},e.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==R.ACCESS_TOKEN&&e.credentialType!==R.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var r=Re.fromString(e.target),o=Re.fromString(t);return o.containsOnlyOIDCScopes()?o.removeScope(C.OFFLINE_ACCESS_SCOPE):o.removeOIDCScopes(),r.containsScopeSet(o)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf("appmetadata")},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf("authority-metadata")},e.prototype.generateAuthorityMetadataCacheKey=function(e){return"authority-metadata-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case R.ID_TOKEN:return this.getIdTokenCredential(e);case R.ACCESS_TOKEN:case R.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case R.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.setAccount=function(){throw ee.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw ee.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw ee.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw ee.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw ee.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw ee.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw ee.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw ee.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw ee.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw ee.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw ee.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw ee.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw ee.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw ee.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw ee.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw ee.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw ee.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw ee.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw ee.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw ee.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){throw ee.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},t}(Ne),Le={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Ue={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:W.Info,correlationId:""},Me={sendGetRequestAsync:function(){return f(this,void 0,void 0,function(){return g(this,function(e){throw ee.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return f(this,void 0,void 0,function(){return g(this,function(e){throw ee.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},je={sku:C.SKU,version:"4.4.0",cpu:"",os:""},He={clientSecret:"",clientAssertion:void 0},Fe=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return f(this,void 0,void 0,function(){var o,n;return g(this,function(i){switch(i.label){case 0:ge.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return o=i.sent(),[3,4];case 3:throw(n=i.sent())instanceof ee?n:te.createNetworkError(t,n);case 4:return ge.postProcess(this.cacheManager,e,o),[2,o]}})})},e}();!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(Se||(Se={}));var qe,Be=function(){function e(e){var t,r,o,n,i,s,a,c,l,d,u,h,f;this.config=(o=(t=e).authOptions,n=t.systemOptions,i=t.loggerOptions,s=t.storageInterface,a=t.networkInterface,c=t.cryptoInterface,l=t.clientCredentials,d=t.libraryInfo,u=t.serverTelemetryManager,h=t.persistencePlugin,f=t.serializableCache,{authOptions:(r=o,p({clientCapabilities:[]},r)),systemOptions:p(p({},Le),n),loggerOptions:p(p({},Ue),i),storageInterface:s||new De(o.clientId,ue),networkInterface:a||Me,cryptoInterface:c||ue,clientCredentials:l||He,libraryInfo:p(p({},je),d),serverTelemetryManager:u||null,persistencePlugin:h||null,serializableCache:f||null}),this.logger=new de(this.config.loggerOptions,"@azure/msal-common","4.4.0"),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Fe(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[v.CONTENT_TYPE]=C.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Se.HOME_ACCOUNT_ID:try{var r=we(e.credential);t[v.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Se.UPN:t[v.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,o){return f(this,void 0,void 0,function(){var n;return g(this,function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(o,e,{body:t,headers:r})];case 1:return n=i.sent(),this.config.serverTelemetryManager&&n.status<500&&429!==n.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,n]}})})},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw te.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e}(),$e=function(){function e(){}return e.validateRedirectUri=function(e){if(re.isEmpty(e))throw he.createRedirectUriEmptyError()},e.validatePrompt=function(e){if([I.LOGIN,I.SELECT_ACCOUNT,I.CONSENT,I.NONE].indexOf(e)<0)throw he.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw he.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(re.isEmpty(e)||re.isEmpty(t))throw he.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([L.PLAIN,L.S256].indexOf(e)<0)throw he.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach(function(t,r){e[r]&&delete e[r]}),e):{}},e}(),ze=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(w.RESPONSE_TYPE,encodeURIComponent(C.CODE_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(w.RESPONSE_MODE,encodeURIComponent(e||E.QUERY))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?m(e||[],T):e||[],o=new Re(r);this.parameters.set(w.SCOPE,encodeURIComponent(o.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(w.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){$e.validateRedirectUri(e),this.parameters.set(w.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){$e.validateRedirectUri(e),this.parameters.set(w.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(w.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(_.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(_.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(v.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(v.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(_.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);$e.validateClaims(r),this.parameters.set(w.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(w.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(w.X_CLIENT_SKU,e.sku),this.parameters.set(w.X_CLIENT_VER,e.version),this.parameters.set(w.X_CLIENT_OS,e.os),this.parameters.set(w.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){$e.validatePrompt(e),this.parameters.set(""+w.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){re.isEmpty(e)||this.parameters.set(w.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(w.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if($e.validateCodeChallengeParams(e,t),!e||!t)throw he.createInvalidCodeChallengeParamsError();this.parameters.set(w.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(w.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(w.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(w.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(w.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(w.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(w.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(w.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(w.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(w.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(w.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(w.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this;$e.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach(function(r){t.parameters.set(r,e[r])})},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw he.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(k.ACCESS_TOKEN)||(r[k.ACCESS_TOKEN]={}),r[k.ACCESS_TOKEN][k.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(M.username,e)},e.prototype.addPassword=function(e){this.parameters.set(M.password,e)},e.prototype.addPopToken=function(e){re.isEmpty(e)||(this.parameters.set(w.TOKEN_TYPE,U.POP),this.parameters.set(w.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(w.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(w.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(w.X_MS_LIB_CAPABILITY,"retry-after, h429")},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach(function(t,r){e.push(r+"="+t)}),e.join("&")},e}(),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.createIdTokenEntity=function(e,r,o,n,i,s){var a=new t;return a.credentialType=R.ID_TOKEN,a.homeAccountId=e,a.environment=r,a.clientId=n,a.secret=o,a.realm=i,a.oboAssertion=s,a},t.isIdTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===R.ID_TOKEN},t}(Ae),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.createAccessTokenEntity=function(e,r,o,n,i,s,a,c,l,d,u,h){var p,f=new t;f.homeAccountId=e,f.credentialType=R.ACCESS_TOKEN,f.secret=o;var g=_e.nowSeconds();if(f.cachedAt=g.toString(),f.expiresOn=a.toString(),f.extendedExpiresOn=c.toString(),d&&(f.refreshOn=d.toString()),f.environment=r,f.clientId=n,f.realm=i,f.target=s,f.oboAssertion=h,f.tokenType=re.isEmpty(u)?U.BEARER:u,f.tokenType===U.POP){f.credentialType=R.ACCESS_TOKEN_WITH_AUTH_SCHEME;var m=Pe.extractTokenClaims(o,l);if(!(null===(p=null==m?void 0:m.cnf)||void 0===p?void 0:p.kid))throw te.createTokenClaimsRequiredError();f.keyId=m.cnf.kid}return f},t.isAccessTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===R.ACCESS_TOKEN||e.credentialType===R.ACCESS_TOKEN_WITH_AUTH_SCHEME)},t}(Ae),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.createRefreshTokenEntity=function(e,r,o,n,i,s){var a=new t;return a.clientId=n,a.credentialType=R.REFRESH_TOKEN,a.environment=r,a.homeAccountId=e,a.secret=o,a.oboAssertion=s,i&&(a.familyId=i),a},t.isRefreshTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===R.REFRESH_TOKEN},t}(Ae),We=function(e,t,r,o,n){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=o||null,this.appMetadata=n||null},Qe=function(){function e(){}return e.setRequestState=function(t,r,o){var n=e.generateLibraryState(t,o);return re.isEmpty(r)?n:""+n+C.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw te.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var o=JSON.stringify(r);return e.base64Encode(o)},e.parseRequestState=function(e,t){if(!e)throw te.createNoCryptoObjectError("parseRequestState");if(re.isEmpty(t))throw te.createInvalidStateError(t,"Null, undefined or empty state");try{var r=decodeURIComponent(t).split(C.RESOURCE_DELIM),o=r[0],n=r.length>1?r.slice(1).join(C.RESOURCE_DELIM):"",i=e.base64Decode(o),s=JSON.parse(i);return{userRequestState:re.isEmpty(n)?"":n,libraryState:s}}catch(e){throw te.createInvalidStateError(t,e)}},e}();!function(e){e.SW="sw",e.UHW="uhw"}(qe||(qe={}));var Je,Ye=function(){function e(e){this.cryptoUtils=e}return e.prototype.generateCnf=function(e){return f(this,void 0,void 0,function(){var t,r;return g(this,function(o){switch(o.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return t=o.sent(),r={kid:t,xms_ksl:qe.SW},[2,this.cryptoUtils.base64Encode(JSON.stringify(r))]}})})},e.prototype.signPopToken=function(e,t){var r;return f(this,void 0,void 0,function(){var o,n,i,s,a,c;return g(this,function(l){switch(l.label){case 0:if(o=Pe.extractTokenClaims(e,this.cryptoUtils),n=t.resourceRequestMethod,i=t.resourceRequestUri,s=t.shrClaims,a=i?new pe(i):void 0,c=null==a?void 0:a.getUrlComponents(),!(null===(r=null==o?void 0:o.cnf)||void 0===r?void 0:r.kid))throw te.createTokenClaimsRequiredError();return[4,this.cryptoUtils.signJwt({at:e,ts:_e.nowSeconds(),m:null==n?void 0:n.toUpperCase(),u:null==c?void 0:c.HostNameAndPort,nonce:this.cryptoUtils.createNewGuid(),p:null==c?void 0:c.AbsolutePath,q:(null==c?void 0:c.QueryString)?[[],c.QueryString]:void 0,client_claims:s||void 0},o.cnf.kid)];case 1:return[2,l.sent()]}})})},e}(),Xe=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return["appmetadata",e,t].join(A.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,o){var n=new e;return n.clientId=t,n.environment=r,o&&(n.familyId=o),n},e.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf("appmetadata")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},e}(),Ze=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),et=function(){function e(e,t,r,o,n,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=o,this.serializableCache=n,this.persistencePlugin=i}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?te.createStateNotFoundError("Cached State"):te.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw te.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(be.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new be(e.error||C.EMPTY_STRING,e.error_description,e.suberror);throw new fe(e.error||C.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&ye(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(be.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new be(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new fe(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,o,n,i,s,a){return f(this,void 0,void 0,function(){var c,l,d,u,h;return g(this,function(p){switch(p.label){case 0:if(t.id_token&&(c=new Pe(t.id_token||C.EMPTY_STRING,this.cryptoObj),i&&!re.isEmpty(i.nonce)&&c.claims.nonce!==i.nonce))throw te.createNonceMismatchError();this.homeAccountIdentifier=Ce.generateHomeAccountId(t.client_info||C.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,c),i&&i.state&&(l=Qe.parseRequestState(this.cryptoObj,i.state)),d=this.generateCacheRecord(t,r,o,c,n.scopes,s,i),p.label=1;case 1:return p.trys.push([1,,4,7]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),u=new Ze(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(u)]):[3,3];case 2:p.sent(),p.label=3;case 3:return a&&d.account&&(h=d.account.generateAccountKey(),!this.cacheStorage.getAccount(h))?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,d,!1,n,c,l)]):(this.cacheStorage.saveCacheRecord(d),[3,7]);case 4:return this.persistencePlugin&&this.serializableCache&&u?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(u)]):[3,6];case 5:p.sent(),p.label=6;case 6:return[7];case 7:return[2,e.generateAuthenticationResult(this.cryptoObj,r,d,!1,n,c,l)]}})})},e.prototype.generateCacheRecord=function(e,t,r,o,n,i,s){var a,c,l=t.getPreferredCache();if(re.isEmpty(l))throw te.createInvalidCacheEnvironmentError();!re.isEmpty(e.id_token)&&o&&(a=Ve.createIdTokenEntity(this.homeAccountIdentifier,l,e.id_token||C.EMPTY_STRING,this.clientId,o.claims.tid||C.EMPTY_STRING,i),c=this.generateAccountEntity(e,o,t,i,s));var d=null;if(!re.isEmpty(e.access_token)){var u=e.scope?Re.fromString(e.scope):new Re(n||[]),h=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,p=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,f=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,g=r+h,m=g+p,v=f&&f>0?r+f:void 0;d=Ke.createAccessTokenEntity(this.homeAccountIdentifier,l,e.access_token||C.EMPTY_STRING,this.clientId,o?o.claims.tid||C.EMPTY_STRING:t.tenant,u.printScopes(),g,m,this.cryptoObj,v,e.token_type,i)}var b=null;re.isEmpty(e.refresh_token)||(b=Ge.createRefreshTokenEntity(this.homeAccountIdentifier,l,e.refresh_token||C.EMPTY_STRING,this.clientId,e.foci,i));var y=null;return re.isEmpty(e.foci)||(y=Xe.createAppMetadataEntity(this.clientId,l,e.foci)),new We(c,a,d,b,y)},e.prototype.generateAccountEntity=function(e,t,r,o,n){var i=r.authorityType,s=n?n.cloud_graph_host_name:"",a=n?n.msgraph_host:"";if(i===le.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Ce.createGenericAccount(r,this.homeAccountIdentifier,t,o,s,a);if(re.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw te.createClientInfoEmptyError();return e.client_info?Ce.createAccount(e.client_info,this.homeAccountIdentifier,r,t,o,s,a):Ce.createGenericAccount(r,this.homeAccountIdentifier,t,o,s,a)},e.generateAuthenticationResult=function(e,t,r,o,n,i,s){var a,c,l;return f(this,void 0,void 0,function(){var d,u,h,p,f,m,v;return g(this,function(g){switch(g.label){case 0:return d="",u=[],h=null,f=C.EMPTY_STRING,r.accessToken?r.accessToken.tokenType!==U.POP?[3,2]:[4,new Ye(e).signPopToken(r.accessToken.secret,n)]:[3,4];case 1:return d=g.sent(),[3,3];case 2:d=r.accessToken.secret,g.label=3;case 3:u=Re.fromString(r.accessToken.target).asArray(),h=new Date(1e3*Number(r.accessToken.expiresOn)),p=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),g.label=4;case 4:return r.appMetadata&&(f="1"===r.appMetadata.familyId?"1":C.EMPTY_STRING),m=(null==i?void 0:i.claims.oid)||(null==i?void 0:i.claims.sub)||C.EMPTY_STRING,v=(null==i?void 0:i.claims.tid)||C.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:m,tenantId:v,scopes:u,account:r.account?r.account.getAccountInfo():null,idToken:i?i.rawToken:C.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:d,fromCache:o,expiresOn:h,extExpiresOn:p,familyId:f,tokenType:(null===(a=r.accessToken)||void 0===a?void 0:a.tokenType)||C.EMPTY_STRING,state:s?s.userRequestState:C.EMPTY_STRING,cloudGraphHostName:(null===(c=r.account)||void 0===c?void 0:c.cloudGraphHostName)||C.EMPTY_STRING,msGraphHost:(null===(l=r.account)||void 0===l?void 0:l.msGraphHost)||C.EMPTY_STRING}]}})})},e}(),tt=function(e){function t(t){return e.call(this,t)||this}return h(t,e),t.prototype.getAuthCodeUrl=function(e){return f(this,void 0,void 0,function(){var t;return g(this,function(r){return t=this.createAuthCodeUrlQueryString(e),[2,pe.appendQueryString(this.authority.authorizationEndpoint,t)]})})},t.prototype.acquireToken=function(e,t){return f(this,void 0,void 0,function(){var r,o,n;return g(this,function(i){switch(i.label){case 0:if(this.logger.info("in acquireToken call"),!e||re.isEmpty(e.code))throw te.createTokenRequestCannotBeMadeError();return r=_e.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return o=i.sent(),(n=new et(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(o.body),[4,n.handleServerTokenResponse(o.body,this.authority,r,e,t)];case 2:return[2,i.sent()]}})})},t.prototype.handleFragmentResponse=function(e,t){var r=new et(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),o=new pe(e),n=pe.getDeserializedHash(o.getHash());if(r.validateServerAuthorizationCodeResponse(n,t,this.cryptoUtils),!n.code)throw te.createNoAuthCodeInServerResponseError();return p(p({},n),{code:n.code})},t.prototype.getLogoutUri=function(e){if(!e)throw he.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(Ce.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=this.createLogoutUrlQueryString(e);return re.isEmpty(t)?this.authority.endSessionEndpoint:this.authority.endSessionEndpoint+"?"+t},t.prototype.executeTokenRequest=function(e,t){return f(this,void 0,void 0,function(){var r,o,n,i,s,a,c;return g(this,function(l){switch(l.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes},[4,this.createTokenRequestBody(t)];case 1:if(o=l.sent(),n=this.createTokenQueryParameters(t),i=void 0,t.clientInfo)try{s=ye(t.clientInfo,this.cryptoUtils),i={credential:""+s.uid+A.CLIENT_INFO_SEPARATOR+s.utid,type:Se.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return a=this.createTokenRequestHeaders(i||t.ccsCredential),c=re.isEmpty(n)?e.tokenEndpoint:e.tokenEndpoint+"?"+n,[2,this.executePostToTokenEndpoint(c,o,a,r)]}})})},t.prototype.createTokenQueryParameters=function(e){var t=new ze;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return f(this,void 0,void 0,function(){var t,r,o,n,i,s;return g(this,function(a){switch(a.label){case 0:return(t=new ze).addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(x.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme!==U.POP?[3,2]:[4,new Ye(this.cryptoUtils).generateCnf(e)];case 1:o=a.sent(),t.addPopToken(o),a.label=2;case 2:if(n=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(n),(!re.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),i=void 0,e.clientInfo)try{s=ye(e.clientInfo,this.cryptoUtils),i={credential:""+s.uid+A.CLIENT_INFO_SEPARATOR+s.utid,type:Se.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case Se.HOME_ACCOUNT_ID:try{s=we(i.credential),t.addCcsOid(s)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Se.UPN:t.addCcsUpn(i.credential)}return[2,t.createQueryString()]}})})},t.prototype.createAuthCodeUrlQueryString=function(e){var t=new ze;t.addClientId(this.config.authOptions.clientId);var r=m(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri);var o=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(o),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==I.SELECT_ACCOUNT)if(e.sid&&e.prompt===I.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){var n=this.extractAccountSid(e.account);if(n&&e.prompt===I.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(n);try{var i=we(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{i=we(e.account.homeAccountId),t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!re.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.createLogoutUrlQueryString=function(e){var t=new ze;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),t.createQueryString()},t.prototype.extractAccountSid=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},t}(Be),rt=function(e){function t(t){return e.call(this,t)||this}return h(t,e),t.prototype.acquireToken=function(e){return f(this,void 0,void 0,function(){var t,r,o;return g(this,function(n){switch(n.label){case 0:return t=_e.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return r=n.sent(),(o=new et(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,o.handleServerTokenResponse(r.body,this.authority,t,e,void 0,void 0,!0)]}})})},t.prototype.acquireTokenByRefreshToken=function(e){return f(this,void 0,void 0,function(){var t,r;return g(this,function(o){if(!e)throw he.createEmptyTokenRequestError();if(!e.account)throw te.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(o){if(t=o instanceof te&&"no_tokens_found"===o.errorCode,r=o instanceof fe&&"invalid_grant"===o.errorCode&&"client_mismatch"===o.subError,t||r)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw o}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]})})},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return f(this,void 0,void 0,function(){var r,o;return g(this,function(n){if(!(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw te.createNoTokensFoundError();return o=p(p({},e),{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||U.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Se.HOME_ACCOUNT_ID}}),[2,this.acquireToken(o)]})})},t.prototype.executeTokenRequest=function(e,t){return f(this,void 0,void 0,function(){var r,o,n,i,s;return g(this,function(a){switch(a.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return r=a.sent(),o=this.createTokenQueryParameters(e),n=this.createTokenRequestHeaders(e.ccsCredential),i={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes},s=pe.appendQueryString(t.tokenEndpoint,o),[2,this.executePostToTokenEndpoint(s,r,n,i)]}})})},t.prototype.createTokenQueryParameters=function(e){var t=new ze;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return f(this,void 0,void 0,function(){var t,r,o,n,i,s,a;return g(this,function(c){switch(c.label){case 0:return(t=new ze).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(x.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(o=this.config.clientCredentials.clientAssertion,t.addClientAssertion(o.assertion),t.addClientAssertionType(o.assertionType)),e.authenticationScheme!==U.POP?[3,2]:(n=new Ye(this.cryptoUtils),s=(i=t).addPopToken,[4,n.generateCnf(e)]);case 1:s.apply(i,[c.sent()]),c.label=2;case 2:if((!re.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Se.HOME_ACCOUNT_ID:try{a=we(e.ccsCredential.credential),t.addCcsOid(a)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Se.UPN:t.addCcsUpn(e.ccsCredential.credential)}return[2,t.createQueryString()]}})})},t}(Be),ot=function(e){function t(t){return e.call(this,t)||this}return h(t,e),t.prototype.acquireToken=function(e){return f(this,void 0,void 0,function(){var t;return g(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof te&&"token_refresh_required"===t.errorCode)return[2,new rt(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}})})},t.prototype.acquireCachedToken=function(e){return f(this,void 0,void 0,function(){var t,r,o,n;return g(this,function(i){switch(i.label){case 0:if(!e)throw he.createEmptyTokenRequestError();if(!e.account)throw te.createNoAccountInSilentRequestError();if(t=new Re(e.scopes||[]),r=e.authority||this.authority.getPreferredCache(),o=e.authenticationScheme||U.BEARER,n=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,t,r,o),e.forceRefresh||!re.isEmptyObj(e.claims)||!n.accessToken||_e.isTokenExpired(n.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)||_e.wasClockTurnedBack(n.accessToken.cachedAt)||n.accessToken.refreshOn&&_e.isTokenExpired(n.accessToken.refreshOn,0))throw te.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(n,e)];case 1:return[2,i.sent()]}})})},t.prototype.generateResultFromCacheRecord=function(e,t){return f(this,void 0,void 0,function(){var r;return g(this,function(o){switch(o.label){case 0:return e.idToken&&(r=new Pe(e.idToken.secret,this.config.cryptoInterface)),[4,et.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,o.sent()]}})})},t}(Be),nt=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(V.CACHE_KEY),o=!0;return t&&(o=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&o},e}(),it=function(){function e(e,t){this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.forceRefresh=e.forceRefresh||!1,this.wrapperSKU=e.wrapperSKU||C.EMPTY_STRING,this.wrapperVer=e.wrapperVer||C.EMPTY_STRING,this.telemetryCacheKey=V.CACHE_KEY+A.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=this.forceRefresh?1:0,t=""+this.apiId+V.VALUE_SEPARATOR+e,r=[this.wrapperSKU,this.wrapperVer].join(V.VALUE_SEPARATOR);return[V.SCHEMA_VERSION,t,r].join(V.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),o=t.failedRequests.slice(0,2*r).join(V.VALUE_SEPARATOR),n=t.errors.slice(0,r).join(V.VALUE_SEPARATOR),i=t.errors.length,s=[i,r<i?V.OVERFLOW_TRUE:V.OVERFLOW_FALSE].join(V.VALUE_SEPARATOR);return[V.SCHEMA_VERSION,t.cacheHits,o,n,s].join(V.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=V.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),re.isEmpty(e.subError)?re.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(V.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new nt;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var o=new nt;o.failedRequests=t.failedRequests.slice(2*r),o.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}},e.maxErrorsToSend=function(e){var t,r=0,o=0,n=e.errors.length;for(t=0;t<n;t++){var i=e.failedRequests[2*t]||C.EMPTY_STRING,s=e.failedRequests[2*t+1]||C.EMPTY_STRING,a=e.errors[t]||C.EMPTY_STRING;if(!((o+=i.toString().length+s.toString().length+a.length+3)<V.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e}(),st=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf("throttling"));var o=!0;return t&&(o=t.hasOwnProperty("throttleTime")),r&&o},e}(),at=function(e){function t(r,o){var n=e.call(this,r,o)||this;return n.name="BrowserConfigurationAuthError",Object.setPrototypeOf(n,t.prototype),n}return i(t,e),t.createRedirectUriEmptyError=function(){return new t("redirect_uri_empty","A redirect URI is required for all calls, and none has been set.")},t.createPostLogoutRedirectUriEmptyError=function(){return new t("post_logout_uri_empty","A post logout redirect has not been set.")},t.createStorageNotSupportedError=function(e){return new t("storage_not_supported","Given storage configuration option was not supported. Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t("no_redirect_callbacks","No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.")},t.createStubPcaInstanceCalledError=function(){return new t("stubbed_public_client_application_called","Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors")},t.createInMemoryRedirectUnavailableError=function(){return new t("in_mem_redirect_unavailable","Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true.")},t}(ee),ct=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==H.LocalStorage&&e!==H.SessionStorage)throw at.createStorageNotSupportedError(e);if(!window[e])throw at.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),lt=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach(function(t,r){e.push(r)}),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),dt=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(re.isEmpty(t))return null;try{return Qe.parseRequestState(e,t).libraryState.meta}catch(e){throw te.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new pe(e);return pe.getDeserializedHash(t.getHash())},e}(),ut=function(e){function t(t,r,o,n){var i=e.call(this,t,o)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=n,i.internalStorage=new lt,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return i(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case H.LocalStorage:case H.SessionStorage:try{return new ct(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=H.MemoryStorage,new lt},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case H.LocalStorage:case H.SessionStorage:try{return new ct(H.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case H.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=C.CACHE_PREFIX+"."+b.ID_TOKEN,r=C.CACHE_PREFIX+"."+b.CLIENT_INFO,o=C.CACHE_PREFIX+"."+b.ERROR,n=C.CACHE_PREFIX+"."+b.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(o),this.browserStorage.getItem(n)];[b.ID_TOKEN,b.CLIENT_INFO,b.ERROR,b.ERROR_DESC].forEach(function(t,r){return e.migrateCacheEntry(t,i[r])})},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);return r&&Ce.isAccountEntity(r)?Ne.toObject(new Ce,r):null},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Ve.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Ne.toObject(new Ve,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Ke.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Ne.toObject(new Ke,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Ge.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Ne.toObject(new Ge,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Xe.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Ne.toObject(new Xe,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&nt.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Ne.toObject(new nt,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Ie.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Ne.toObject(new Ie,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter(function(t){return e.isAuthorityMetadata(t)})},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&st.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Ne.toObject(new st,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var o=this.getItemCookie(r);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),o}var n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===H.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n},t.prototype.setTemporaryCache=function(e,t,r){var o=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(o,t))},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e)),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return d(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){var e=this;this.removeAllAccounts(),this.removeAppMetadata(),this.getKeys().forEach(function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(C.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)}),this.internalStorage.clear()},t.prototype.setItemCookie=function(e,t,r){var o=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(o+="expires="+this.getCookieExpirationTime(r)+";"),this.cacheConfig.secureCookies&&(o+="Secure;"),document.cookie=o},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var n=r[o];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return""},t.prototype.clearMsalCookies=function(){var e=this,t=C.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach(function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var o=r.split("=")[0];e.clearItemCookie(o)}})},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):re.startsWith(e,C.CACHE_PREFIX)||re.startsWith(e,b.ADAL_ID_TOKEN)?e:C.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=Qe.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(q.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=Qe.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(q.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=Qe.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(q.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var o=this.generateAuthorityKey(r);return this.getTemporaryCache(o)},t.prototype.updateCacheEntries=function(e,t,r,o,n){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);var a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,r,!1),n){var c={credential:n.homeAccountId,type:Se.HOME_ACCOUNT_ID};this.setTemporaryCache(q.CCS_CREDENTIAL,JSON.stringify(c),!0)}else re.isEmpty(o)||(c={credential:o,type:Se.UPN},this.setTemporaryCache(q.CCS_CREDENTIAL,JSON.stringify(c),!0))},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),re.isEmpty(e)||this.getKeys().forEach(function(r){-1!==r.indexOf(e)&&t.removeItem(r)}),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(q.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(q.ORIGIN_URI)),this.removeItem(this.generateCacheKey(q.URL_HASH)),this.removeItem(this.generateCacheKey(q.INTERACTION_STATUS_KEY)),this.removeItem(this.generateCacheKey(q.CCS_CREDENTIAL))},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||"")}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(function(r){if(-1!==r.indexOf(q.REQUEST_STATE)){var o=t.temporaryCacheStorage.getItem(r);if(o){var n=dt.extractBrowserRequestState(t.cryptoImpl,o);n&&n.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+o),t.resetRequestCache(o))}}}),this.clearMsalCookies()},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(q.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(q.REQUEST_PARAMS,!0);if(!r)throw oe.createNoTokenRequestCacheError();var o=this.validateAndParseJson(t.base64Decode(r));if(!o)throw oe.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(q.REQUEST_PARAMS)),re.isEmpty(o.authority)){var n=this.generateAuthorityKey(e),i=this.getTemporaryCache(n);if(!i)throw oe.createNoCachedAuthorityError();o.authority=i}return o},t}(Ne),ht={sendGetRequestAsync:function(){return Promise.reject(ee.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(ee.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},pt=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return a(this,void 0,void 0,function(){var r,o,n;return c(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:F.GET,headers:this.getFetchHeaders(t)})];case 1:return r=i.sent(),[3,3];case 2:throw o=i.sent(),window.navigator.onLine?oe.createGetRequestFailedError(o,e):oe.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),n={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(n.body=i.sent(),n.status=r.status,n)];case 5:throw i.sent(),oe.createFailedToParseNetworkResponseError(e);case 6:return[2]}})})},e.prototype.sendPostRequestAsync=function(e,t){return a(this,void 0,void 0,function(){var r,o,n,i;return c(this,function(s){switch(s.label){case 0:r=t&&t.body||"",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(e,{method:F.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return o=s.sent(),[3,4];case 3:throw n=s.sent(),window.navigator.onLine?oe.createPostRequestFailedError(n,e):oe.createNoNetworkConnectivityError();case 4:return s.trys.push([4,6,,7]),i={headers:this.getHeaderDict(o.headers)},[4,o.json()];case 5:return[2,(i.body=s.sent(),i.status=o.status,i)];case 6:throw s.sent(),oe.createFailedToParseNetworkResponseError(e);case 7:return[2]}})})},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach(function(e){t.append(e,r[e])}),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach(function(e,r){t[r]=e}),t},e}(),ft=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return a(this,void 0,void 0,function(){return c(this,function(r){return[2,this.sendRequestAsync(e,F.GET,t)]})})},e.prototype.sendPostRequestAsync=function(e,t){return a(this,void 0,void 0,function(){return c(this,function(r){return[2,this.sendRequestAsync(e,F.POST,t)]})})},e.prototype.sendRequestAsync=function(e,t,r){var o=this;return new Promise(function(n,i){var s=new XMLHttpRequest;if(s.open(t,e,!0),o.setXhrHeaders(s,r),s.onload=function(){(s.status<200||s.status>=300)&&(t===F.POST?i(oe.createPostRequestFailedError("Failed with status "+s.status,e)):i(oe.createGetRequestFailedError("Failed with status "+s.status,e)));try{var r=JSON.parse(s.responseText),a={headers:o.getHeaderDict(s),body:r,status:s.status};n(a)}catch(t){i(oe.createFailedToParseNetworkResponseError(e))}},s.onerror=function(){window.navigator.onLine?t===F.POST?i(oe.createPostRequestFailedError("Failed with status "+s.status,e)):i(oe.createGetRequestFailedError("Failed with status "+s.status,e)):i(oe.createNoNetworkConnectivityError())},t===F.POST&&r&&r.body)s.send(r.body);else{if(t!==F.GET)throw oe.createHttpMethodNotImplementedError(t);s.send()}})},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach(function(t){e.setRequestHeader(t,r[t])})}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach(function(e){var t=e.split(": "),o=t.shift(),n=t.join(": ");o&&n&&(r[o]=n)}),r},e}(),gt=function(){function e(){}return e.clearHash=function(e){e.location.hash=C.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,C.EMPTY_STRING,""+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new pe(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new pt:new ft},e.blockReloadInHiddenIframes=function(){if(pe.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw oe.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var o=e.isInIframe();if(t===$.Redirect&&o&&!r)throw oe.createRedirectInIframeError(o)},e.blockAcquireTokenInPopups=function(){if(window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("msal."))throw oe.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw oe.createNonBrowserEnvironmentError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),o=e.indexOf("Edge/");return t>0||r>0||o>0},e}(),mt=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(function(e){setTimeout(function(){e(!0)},t.timeout)})},e}(),vt=function(){function e(e,t,r,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.browserRequestLogger=o}return e.prototype.handleCodeResponse=function(e,t,r,o){return a(this,void 0,void 0,function(){var n,i,s,a,l,d,u;return c(this,function(c){switch(c.label){case 0:if(this.browserRequestLogger.verbose("InteractionHandler.handleCodeResponse called"),re.isEmpty(e))throw oe.createEmptyHashError(e);if(n=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(n)))throw te.createStateNotFoundError("Cached State");return s=this.authModule.handleFragmentResponse(e,i),a=this.browserStorage.generateNonceKey(i),l=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,r,o)]:[3,2];case 1:c.sent(),c.label=2;case 2:return s.nonce=l||void 0,s.state=i,s.client_info?this.authCodeRequest.clientInfo=s.client_info:(d=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=d),[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return u=c.sent(),this.browserStorage.cleanRequestByState(t),[2,u]}})})},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return a(this,void 0,void 0,function(){var o,n;return c(this,function(i){switch(i.label){case 0:return o="https://"+e+"/"+t.tenant+"/",[4,Oe.createDiscoveredInstance(o,r,this.browserStorage,t.options)];case 1:return n=i.sent(),this.authModule.updateAuthority(n),[2]}})})},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(q.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),bt=function(e){function t(t,r,o,n,i){var s=e.call(this,t,r,o,n)||this;return s.browserCrypto=i,s}return i(t,e),t.prototype.initiateAuthRequest=function(e,t){return a(this,void 0,void 0,function(){var r;return c(this,function(o){switch(o.label){case 0:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest called"),re.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(q.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(q.INTERACTION_STATUS_KEY,"interaction_in_progress",!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.browserRequestLogger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:B.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:return o.sent(),[2];case 2:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 5:return o.sent(),[2];case 6:return[3,8];case 7:throw this.browserRequestLogger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),oe.createEmptyNavigationUriError();case 8:return[2]}})})},t.prototype.handleCodeResponse=function(e,t,r,o,n){return a(this,void 0,void 0,function(){var i,s,a,l,d,u,h;return c(this,function(c){switch(c.label){case 0:if(this.browserRequestLogger.verbose("RedirectHandler.handleCodeResponse called"),re.isEmpty(e))throw oe.createEmptyHashError(e);if(this.browserStorage.removeItem(this.browserStorage.generateCacheKey(q.INTERACTION_STATUS_KEY)),i=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(i)))throw te.createStateNotFoundError("Cached State");return a=this.authModule.handleFragmentResponse(e,s),l=this.browserStorage.generateNonceKey(s),d=this.browserStorage.getTemporaryCache(l),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,r,o)]:[3,2];case 1:c.sent(),c.label=2;case 2:return a.nonce=d||void 0,a.state=s,a.client_info?this.authCodeRequest.clientInfo=a.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),n&&ge.removeThrottle(this.browserStorage,n,this.authCodeRequest.authority,this.authCodeRequest.scopes),[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return h=c.sent(),this.browserStorage.cleanRequestByState(t),[2,h]}})})},t}(vt),yt=function(){function e(e,t){this.browserStorage=e,this.logger=t,this.unloadWindow=this.unloadWindow.bind(this)}return e.prototype.openPopup=function(t,r,o){try{var n=void 0;if(o?(n=o,this.logger.verbosePii("Navigating popup window to: "+t),n.location.assign(t)):void 0===o&&(this.logger.verbosePii("Opening popup window to: "+t),n=e.openSizedPopup(t,r)),!n)throw oe.createEmptyWindowCreatedError();return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(q.INTERACTION_STATUS_KEY)),oe.createPopupWindowError(e.toString())}},e.openSizedPopup=function(e,t){var r=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=Math.max(0,n/2-241.5+r),a=Math.max(0,i/2-300+o);return window.open(e,t,"width=483, height=600, top="+a+", left="+s+", scrollbars=yes")},e.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType($.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},e.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(q.INTERACTION_STATUS_KEY))},e.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise(function(r,o){var n=setInterval(function(){if(e.closed)return t.cleanPopup(),clearInterval(n),void o(oe.createUserCancelledError());var i=C.EMPTY_STRING;try{i=e.location.href}catch(e){}re.isEmpty(i)||"about:blank"===i||(clearInterval(n),r())},50)})},e.generatePopupName=function(e,t){return"msal."+e+"."+t.scopes.join("-")+"."+t.authority+"."+t.correlationId},e.generateLogoutPopupName=function(e,t){return"msal."+e+"."+(t.account&&t.account.homeAccountId)+"."+t.correlationId},e}(),wt=function(e){function t(t,r,o,n){var i=e.call(this,t,r,o,n)||this;return i.popupUtils=new yt(r,n),i}return i(t,e),t.prototype.initiateAuthRequest=function(e,t){if(re.isEmpty(e))throw this.browserRequestLogger.error("Navigate url is empty"),oe.createEmptyNavigationUriError();return this.browserStorage.setTemporaryCache(q.INTERACTION_STATUS_KEY,"interaction_in_progress",!0),this.browserRequestLogger.infoPii("Navigate to: "+e),this.popupUtils.openPopup(e,t.popupName,t.popup)},t.prototype.monitorPopupForHash=function(e){var t=this;return this.popupUtils.monitorPopupForSameOrigin(e).then(function(){var r=e.location.hash;if(gt.clearHash(e),t.popupUtils.cleanPopup(e),!r)throw oe.createEmptyHashError(e.location.href);if(pe.hashContainsKnownProperties(r))return r;throw oe.createHashDoesNotContainKnownPropertiesError()})},t}(vt),kt=function(e){function t(t,r,o,n,i){var s=e.call(this,t,r,o,n)||this;return s.navigateFrameWait=i,s}return i(t,e),t.prototype.initiateAuthRequest=function(e){return a(this,void 0,void 0,function(){var t;return c(this,function(r){switch(r.label){case 0:if(re.isEmpty(e))throw this.browserRequestLogger.info("Navigate url is empty"),oe.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=this.loadFrameSync(e),r.label=3;case 3:return[2,t]}})})},t.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise(function(o,n){t<6e3&&r.browserRequestLogger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default (6000ms). This may result in timeouts.");var i=window.performance.now()+t,s=setInterval(function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(s),void n(oe.createMonitorIframeTimeoutError());var t=C.EMPTY_STRING,a=e.contentWindow;try{t=a?a.location.href:C.EMPTY_STRING}catch(e){}if(!re.isEmpty(t)){var c=a?a.location.hash:C.EMPTY_STRING;return pe.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(s),void o(c)):void 0}},50)})},t.prototype.loadFrame=function(e){var t=this;return new Promise(function(r,o){var n=t.createHiddenIframe();setTimeout(function(){n?(n.src=e,r(n)):o("Unable to load iframe")},t.navigateFrameWait)})},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(vt);!function(e){e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(Je||(Je={}));var Ct,Tt=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.emitEvent=function(e,t,r,o){var n=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:o||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach(function(t,r){n.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])})}},e}(),St=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.loginRedirect=function(e){return a(this,void 0,void 0,function(){return c(this,function(t){return this.logger.verbose("loginRedirect called"),[2,this.acquireTokenRedirect(e||G)]})})},t.prototype.loginPopup=function(e){return this.logger.verbose("loginPopup called"),this.acquireTokenPopup(e||G)},t.prototype.acquireTokenSilent=function(e){return a(this,void 0,void 0,function(){var t,r,o,n,i,a,l,d;return c(this,function(c){switch(c.label){case 0:if(this.preflightBrowserEnvironmentCheck($.Silent),this.logger.verbose("acquireTokenSilent called",e.correlationId),!(t=e.account||this.getActiveAccount()))throw oe.createNoAccountError();r=s(s(s({},e),this.initializeBaseRequest(e)),{account:t,forceRefresh:e.forceRefresh||!1}),o=this.logger.clone("@azure/msal-browser","2.15.0",r.correlationId),this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_START,$.Silent,e),c.label=1;case 1:return c.trys.push([1,4,,9]),n=this.initializeServerTelemetryManager(B.acquireTokenSilent_silentFlow,r.correlationId),[4,this.createSilentFlowClient(n,r.authority,r.correlationId)];case 2:return i=c.sent(),o.verbose("Silent auth client created"),[4,i.acquireCachedToken(r)];case 3:return a=c.sent(),this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_SUCCESS,$.Silent,a),[2,a];case 4:c.sent(),c.label=5;case 5:return c.trys.push([5,7,,8]),[4,this.acquireTokenByRefreshToken(r)];case 6:return l=c.sent(),this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_SUCCESS,$.Silent,l),[2,l];case 7:throw d=c.sent(),this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_FAILURE,$.Silent,null,d),d;case 8:return[3,9];case 9:return[2]}})})},t}(function(){function e(e){var t,r,o,n,i,a,c,l,d,u,h,p;this.isBrowserEnvironment="undefined"!=typeof window,this.config=(t=e,r=this.isBrowserEnvironment,o=t.auth,n=t.cache,i=t.system,a={clientId:"",authority:""+C.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:ke.AAD},c={cacheLocation:H.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},l={loggerCallback:function(){},logLevel:W.Info,piiLoggingEnabled:!1},d=s(s({},Le),{loggerOptions:l,networkClient:r?gt.getBrowserNetworkClient():ht,navigationClient:new mt,loadFrameTimeout:0,windowHashTimeout:i&&i.loadFrameTimeout||6e4,iframeHashTimeout:i&&i.loadFrameTimeout||6e3,navigateFrameWait:r&&gt.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1}),{auth:s(s({},a),o),cache:s(s({},c),n),system:s(s({},d),i)}),this.activeLocalAccountId=null,this.logger=new de(this.config.system.loggerOptions,"@azure/msal-browser","2.15.0"),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.browserCrypto=this.isBrowserEnvironment?new ce:ue,this.eventHandler=new Tt(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new ut(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(u=this.config.auth.clientId,h=this.logger,p={cacheLocation:H.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},new ut(u,p,ue,h))}return e.prototype.handleRedirectPromise=function(e){return a(this,void 0,void 0,function(){var t,r,o,n=this;return c(this,function(i){return this.eventHandler.emitEvent(Je.HANDLE_REDIRECT_START,$.Redirect),this.logger.verbose("handleRedirectPromise called"),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||C.EMPTY_STRING,void 0===(o=this.redirectResponse.get(r))?(this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),o=this.handleRedirectResponse(e).then(function(e){return e&&(t.length<n.getAllAccounts().length?(n.eventHandler.emitEvent(Je.LOGIN_SUCCESS,$.Redirect,e),n.logger.verbose("handleRedirectResponse returned result, login success")):(n.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_SUCCESS,$.Redirect,e),n.logger.verbose("handleRedirectResponse returned result, acquire token success"))),n.eventHandler.emitEvent(Je.HANDLE_REDIRECT_END,$.Redirect),e}).catch(function(e){throw t.length>0?n.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_FAILURE,$.Redirect,null,e):n.eventHandler.emitEvent(Je.LOGIN_FAILURE,$.Redirect,null,e),n.eventHandler.emitEvent(Je.HANDLE_REDIRECT_END,$.Redirect),e}),this.redirectResponse.set(r,o)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,o]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])})})},e.prototype.handleRedirectResponse=function(e){return a(this,void 0,void 0,function(){var t,r,o,n,i,s,a,l,d;return c(this,function(c){switch(c.label){case 0:if(!this.interactionInProgress())return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType($.Redirect),[2,null];try{r=this.validateAndExtractStateFromHash(t,$.Redirect),gt.clearHash(window),this.logger.verbose("State extracted from hash")}catch(e){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+e),this.browserStorage.cleanRequestByInteractionType($.Redirect),[2,null]}return o=this.browserStorage.getTemporaryCache(q.ORIGIN_URI,!0)||"",n=pe.removeHashFromUrl(o),i=pe.removeHashFromUrl(window.location.href),n===i&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(t,r)]):[3,2];case 1:return s=c.sent(),o.indexOf("#")>-1&&gt.replaceHash(o),[2,s];case 2:return this.config.auth.navigateToLoginRequestUrl?[3,3]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(t,r)]);case 3:return gt.isInIframe()?[3,8]:(this.browserStorage.setTemporaryCache(q.URL_HASH,t,!0),a={apiId:B.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},l=!0,o&&"null"!==o?[3,5]:(d=gt.getHomepage(),this.browserStorage.setTemporaryCache(q.ORIGIN_URI,d,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(d,a)]));case 4:return l=c.sent(),[3,7];case 5:return this.logger.verbose("Navigating to loginRequestUrl: "+o),[4,this.navigationClient.navigateInternal(o,a)];case 6:l=c.sent(),c.label=7;case 7:if(!l)return[2,this.handleHash(t,r)];c.label=8;case 8:return[2,null]}})})},e.prototype.getRedirectResponseHash=function(e){this.logger.verbose("getRedirectResponseHash called");var t=pe.hashContainsKnownProperties(e),r=this.browserStorage.getTemporaryCache(q.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(q.URL_HASH)),t?(this.logger.verbose("Hash contains known properties, returning response hash"),e):(this.logger.verbose("Hash does not contain known properties, returning cached hash"),r)},e.prototype.validateAndExtractStateFromHash=function(e,t,r){this.logger.verbose("validateAndExtractStateFromHash called",r);var o=pe.getDeserializedHash(e);if(!o.state)throw oe.createHashDoesNotContainStateError();var n=dt.extractBrowserRequestState(this.browserCrypto,o.state);if(!n)throw oe.createUnableToParseStateError();if(n.interactionType!==t)throw oe.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),o.state},e.prototype.handleHash=function(e,t){return a(this,void 0,void 0,function(){var r,o,n,i,s,a;return c(this,function(c){switch(c.label){case 0:r=this.browserStorage.getCachedRequest(t,this.browserCrypto),(o=this.logger.clone("@azure/msal-browser","2.15.0",r.correlationId)).verbose("handleHash called, retrieved cached request"),n=this.initializeServerTelemetryManager(B.handleRedirectPromise,r.correlationId),c.label=1;case 1:if(c.trys.push([1,4,,5]),!(i=this.browserStorage.getCachedAuthority(t)))throw oe.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(n,i,r.correlationId)];case 2:return s=c.sent(),o.verbose("Auth code client created"),[4,new bt(s,this.browserStorage,r,o,this.browserCrypto).handleCodeResponse(e,t,s.authority,this.networkClient,this.config.auth.clientId)];case 3:return[2,c.sent()];case 4:throw a=c.sent(),n.cacheFailedRequest(a),this.browserStorage.cleanRequestByInteractionType($.Redirect),a;case 5:return[2]}})})},e.prototype.acquireTokenRedirect=function(e){return a(this,void 0,void 0,function(){var t,r,o,n,i,s,a,l,d,u;return c(this,function(c){switch(c.label){case 0:this.preflightBrowserEnvironmentCheck($.Redirect),this.logger.verbose("acquireTokenRedirect called"),(t=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_START,$.Redirect,e):this.eventHandler.emitEvent(Je.LOGIN_START,$.Redirect,e),r=this.preflightInteractiveRequest(e,$.Redirect),o=this.logger.clone("@azure/msal-browser","2.15.0",r.correlationId),n=this.initializeServerTelemetryManager(B.acquireTokenRedirect,r.correlationId),c.label=1;case 1:return c.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return i=c.sent(),[4,this.createAuthCodeClient(n,r.authority,r.correlationId)];case 3:return s=c.sent(),o.verbose("Auth code client created"),a=new bt(s,this.browserStorage,i,o,this.browserCrypto),[4,s.getAuthCodeUrl(r)];case 4:return l=c.sent(),d=this.getRedirectStartPage(e.redirectStartPage),o.verbosePii("Redirect start page: "+d),[2,a.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:d,onRedirectNavigate:e.onRedirectNavigate})];case 5:throw u=c.sent(),t?this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_FAILURE,$.Redirect,null,u):this.eventHandler.emitEvent(Je.LOGIN_FAILURE,$.Redirect,null,u),n.cacheFailedRequest(u),this.browserStorage.cleanRequestByState(r.state),u;case 6:return[2]}})})},e.prototype.acquireTokenPopup=function(e){var t;try{this.preflightBrowserEnvironmentCheck($.Popup),this.logger.verbose("acquireTokenPopup called",e.correlationId),t=this.preflightInteractiveRequest(e,$.Popup)}catch(e){return Promise.reject(e)}var r=yt.generatePopupName(this.config.auth.clientId,t);if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token",t.correlationId),this.acquireTokenPopupAsync(t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token",t.correlationId);var o=yt.openSizedPopup("about:blank",r);return this.acquireTokenPopupAsync(t,r,o)},e.prototype.acquireTokenPopupAsync=function(e,t,r){return a(this,void 0,void 0,function(){var o,n,i,s,a,l,d,u,h,p,f,g,m;return c(this,function(c){switch(c.label){case 0:this.logger.verbose("acquireTokenPopupAsync called",e.correlationId),(o=this.getAllAccounts()).length>0?this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_START,$.Popup,e):this.eventHandler.emitEvent(Je.LOGIN_START,$.Popup,e),n=this.logger.clone("@azure/msal-browser","2.15.0",e.correlationId),i=this.initializeServerTelemetryManager(B.acquireTokenPopup,e.correlationId),c.label=1;case 1:return c.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(e)];case 2:return s=c.sent(),[4,this.createAuthCodeClient(i,e.authority,e.correlationId)];case 3:return a=c.sent(),n.verbose("Auth code client created"),[4,a.getAuthCodeUrl(e)];case 4:return l=c.sent(),d=new wt(a,this.browserStorage,s,n),u={popup:r,popupName:t},h=d.initiateAuthRequest(l,u),this.eventHandler.emitEvent(Je.POPUP_OPENED,$.Popup,{popupWindow:h},null),[4,d.monitorPopupForHash(h)];case 5:return p=c.sent(),f=this.validateAndExtractStateFromHash(p,$.Popup,e.correlationId),ge.removeThrottle(this.browserStorage,this.config.auth.clientId,s.authority,s.scopes),[4,d.handleCodeResponse(p,f,a.authority,this.networkClient)];case 6:return g=c.sent(),o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(Je.LOGIN_SUCCESS,$.Popup,g):this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_SUCCESS,$.Popup,g),[2,g];case 7:throw m=c.sent(),o.length>0?this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_FAILURE,$.Popup,null,m):this.eventHandler.emitEvent(Je.LOGIN_FAILURE,$.Popup,null,m),r&&r.close(),i.cacheFailedRequest(m),this.browserStorage.cleanRequestByState(e.state),m;case 8:return[2]}})})},e.prototype.ssoSilent=function(e){return a(this,void 0,void 0,function(){var t,r;return c(this,function(o){switch(o.label){case 0:this.preflightBrowserEnvironmentCheck($.Silent),this.logger.verbose("ssoSilent called",e.correlationId),this.eventHandler.emitEvent(Je.SSO_SILENT_START,$.Silent,e),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.acquireTokenByIframe(e,B.ssoSilent)];case 2:return t=o.sent(),this.eventHandler.emitEvent(Je.SSO_SILENT_SUCCESS,$.Silent,t),[2,t];case 3:throw r=o.sent(),this.eventHandler.emitEvent(Je.SSO_SILENT_FAILURE,$.Silent,null,r),r;case 4:return[2]}})})},e.prototype.acquireTokenByIframe=function(e,t){return a(this,void 0,void 0,function(){var r,o,n,i,a,l,d;return c(this,function(c){switch(c.label){case 0:if(this.logger.verbose("acquireTokenByIframe called",e.correlationId),re.isEmpty(e.loginHint)&&re.isEmpty(e.sid)&&(!e.account||re.isEmpty(e.account.username)))throw oe.createSilentSSOInsufficientInfoError();if(e.prompt&&e.prompt!==I.NONE)throw oe.createSilentPromptValueError(e.prompt);r=this.initializeAuthorizationRequest(s(s({},e),{prompt:I.NONE}),$.Silent),o=this.logger.clone("@azure/msal-browser","2.15.0",r.correlationId),n=this.initializeServerTelemetryManager(t,r.correlationId),c.label=1;case 1:return c.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return i=c.sent(),[4,this.createAuthCodeClient(n,r.authority,r.correlationId)];case 3:return a=c.sent(),o.verbose("Auth code client created"),[4,a.getAuthCodeUrl(r)];case 4:return l=c.sent(),[4,this.silentTokenHelper(l,i,a,o)];case 5:return[2,c.sent()];case 6:throw d=c.sent(),n.cacheFailedRequest(d),this.browserStorage.cleanRequestByState(r.state),d;case 7:return[2]}})})},e.prototype.acquireTokenByRefreshToken=function(e){return a(this,void 0,void 0,function(){var t,r,o,n,i,a,l,d;return c(this,function(c){switch(c.label){case 0:this.eventHandler.emitEvent(Je.ACQUIRE_TOKEN_NETWORK_START,$.Silent,e),gt.blockReloadInHiddenIframes(),t=s(s({},e),this.initializeBaseRequest(e)),r=this.logger.clone("@azure/msal-browser","2.15.0",t.correlationId),o=this.initializeServerTelemetryManager(B.acquireTokenSilent_silentFlow,t.correlationId),c.label=1;case 1:return c.trys.push([1,4,,7]),[4,this.createRefreshTokenClient(o,t.authority,t.correlationId)];case 2:return n=c.sent(),r.verbose("Refresh token client created"),[4,n.acquireTokenByRefreshToken(t)];case 3:return[2,c.sent()];case 4:return i=c.sent(),o.cacheFailedRequest(i),a=i instanceof fe,l=i instanceof be,d="invalid_grant"===i.errorCode,a&&d&&!l?(r.verbose("Refresh token expired or invalid, attempting acquire token by iframe"),[4,this.acquireTokenByIframe(e,B.acquireTokenSilent_authCode)]):[3,6];case 5:return[2,c.sent()];case 6:throw i;case 7:return[2]}})})},e.prototype.silentTokenHelper=function(e,t,r,o){return a(this,void 0,void 0,function(){var n,i,s,a;return c(this,function(c){switch(c.label){case 0:return[4,(n=new kt(r,this.browserStorage,t,o,this.config.system.navigateFrameWait)).initiateAuthRequest(e)];case 1:return i=c.sent(),[4,n.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 2:return s=c.sent(),a=this.validateAndExtractStateFromHash(s,$.Silent,t.correlationId),[2,n.handleCodeResponse(s,a,r.authority,this.networkClient)]}})})},e.prototype.logout=function(e){return a(this,void 0,void 0,function(){return c(this,function(t){return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead."),[2,this.logoutRedirect(e)]})})},e.prototype.logoutRedirect=function(e){return a(this,void 0,void 0,function(){var t,r,o,n,i,s,a;return c(this,function(c){switch(c.label){case 0:this.preflightBrowserEnvironmentCheck($.Redirect),this.logger.verbose("logoutRedirect called",null==e?void 0:e.correlationId),t=this.initializeLogoutRequest(e),r=this.logger.clone("@azure/msal-browser","2.15.0",t.correlationId),o=this.initializeServerTelemetryManager(B.logout,t.correlationId),c.label=1;case 1:return c.trys.push([1,9,,10]),this.eventHandler.emitEvent(Je.LOGOUT_START,$.Redirect,e),[4,this.createAuthCodeClient(o,e&&e.authority,null==t?void 0:t.correlationId)];case 2:return n=c.sent(),r.verbose("Auth code client created"),i=n.getLogoutUri(t),t.account&&!Ce.accountInfoIsEqual(t.account,this.getActiveAccount(),!1)||(r.verbose("Setting active account to null"),this.setActiveAccount(null)),s={apiId:B.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.eventHandler.emitEvent(Je.LOGOUT_SUCCESS,$.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,4]:(r.verbose("Logout onRedirectNavigate did not return false, navigating"),[4,this.navigationClient.navigateExternal(i,s)]):[3,6];case 3:return c.sent(),[2];case 4:r.verbose("Logout onRedirectNavigate returned false, stopping navigation"),c.label=5;case 5:return[3,8];case 6:return[4,this.navigationClient.navigateExternal(i,s)];case 7:return c.sent(),[2];case 8:return[3,10];case 9:throw a=c.sent(),o.cacheFailedRequest(a),this.eventHandler.emitEvent(Je.LOGOUT_FAILURE,$.Redirect,null,a),a;case 10:return this.eventHandler.emitEvent(Je.LOGOUT_END,$.Redirect),[2]}})})},e.prototype.logoutPopup=function(e){var t;try{this.preflightBrowserEnvironmentCheck($.Popup),this.logger.verbose("logoutPopup called",null==e?void 0:e.correlationId),t=this.initializeLogoutRequest(e)}catch(e){return Promise.reject(e)}var r,o=yt.generateLogoutPopupName(this.config.auth.clientId,t);this.config.system.asyncPopups?this.logger.verbose("asyncPopups set to true",t.correlationId):(this.logger.verbose("asyncPopup set to false, opening popup",t.correlationId),r=yt.openSizedPopup("about:blank",o));var n=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.logoutPopupAsync(t,o,n,r,i)},e.prototype.logoutPopupAsync=function(e,t,r,o,n){return a(this,void 0,void 0,function(){var i,s,a,l,d,u,h,p,f,g;return c(this,function(c){switch(c.label){case 0:this.logger.verbose("logoutPopupAsync called",e.correlationId),this.eventHandler.emitEvent(Je.LOGOUT_START,$.Popup,e),i=this.logger.clone("@azure/msal-browser","2.15.0",e.correlationId),s=this.initializeServerTelemetryManager(B.logoutPopup,e.correlationId),c.label=1;case 1:return c.trys.push([1,7,,8]),this.browserStorage.setTemporaryCache(q.INTERACTION_STATUS_KEY,"interaction_in_progress",!0),[4,this.createAuthCodeClient(s,r,e.correlationId)];case 2:a=c.sent(),i.verbose("Auth code client created"),l=a.getLogoutUri(e),e.account&&!Ce.accountInfoIsEqual(e.account,this.getActiveAccount(),!1)||(i.verbose("Setting active account to null"),this.setActiveAccount(null)),this.eventHandler.emitEvent(Je.LOGOUT_SUCCESS,$.Popup,e),d=new yt(this.browserStorage,this.logger),u=d.openPopup(l,t,o),this.eventHandler.emitEvent(Je.POPUP_OPENED,$.Popup,{popupWindow:u},null),c.label=3;case 3:return c.trys.push([3,5,,6]),[4,d.monitorPopupForSameOrigin(u)];case 4:return c.sent(),i.verbose("Popup successfully redirected to postLogoutRedirectUri"),[3,6];case 5:return h=c.sent(),i.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+h),[3,6];case 6:return d.cleanPopup(u),n?(p={apiId:B.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},f=pe.getAbsoluteUrl(n,gt.getCurrentUri()),i.verbose("Redirecting main window to url specified in the request"),i.verbosePii("Redirecing main window to: "+f),this.navigationClient.navigateInternal(f,p)):i.verbose("No main window navigation requested"),[3,8];case 7:throw g=c.sent(),o&&o.close(),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(q.INTERACTION_STATUS_KEY)),this.eventHandler.emitEvent(Je.LOGOUT_FAILURE,$.Popup,null,g),s.cacheFailedRequest(g),g;case 8:return this.eventHandler.emitEvent(Je.LOGOUT_END,$.Popup),[2]}})})},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!re.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter(function(t){return t.username.toLowerCase()===e.toLowerCase()})[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!re.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter(function(t){return t.homeAccountId===e})[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!re.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter(function(t){return t.localAccountId===e})[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){e?(this.logger.verbose("setActiveAccount: Active account set"),this.activeLocalAccountId=e.localAccountId):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.activeLocalAccountId=null)},e.prototype.getActiveAccount=function(){return this.activeLocalAccountId?this.getAccountByLocalId(this.activeLocalAccountId):(this.logger.verbose("getActiveAccount: No active account"),null)},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||gt.getCurrentUri();return pe.getAbsoluteUrl(t,gt.getCurrentUri())},e.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return pe.getAbsoluteUrl(t,gt.getCurrentUri())},e.prototype.getDiscoveredAuthority=function(e,t){return a(this,void 0,void 0,function(){var r;return c(this,function(o){switch(o.label){case 0:return this.logger.verbose("getDiscoveredAuthority called",t),r={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority",t),[4,Oe.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,r)]):[3,2];case 1:return[2,o.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority",t),[4,Oe.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,r)];case 3:return[2,o.sent()]}})})},e.prototype.interactionInProgress=function(){return"interaction_in_progress"===this.browserStorage.getTemporaryCache(q.INTERACTION_STATUS_KEY,!0)},e.prototype.createAuthCodeClient=function(e,t,r){return a(this,void 0,void 0,function(){var o;return c(this,function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return o=n.sent(),[2,new tt(o)]}})})},e.prototype.createSilentFlowClient=function(e,t,r){return a(this,void 0,void 0,function(){var o;return c(this,function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return o=n.sent(),[2,new ot(o)]}})})},e.prototype.createRefreshTokenClient=function(e,t,r){return a(this,void 0,void 0,function(){var o;return c(this,function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return o=n.sent(),[2,new rt(o)]}})})},e.prototype.getClientConfiguration=function(e,t,r){return a(this,void 0,void 0,function(){var o;return c(this,function(n){switch(n.label){case 0:return this.logger.verbose("getClientConfiguration called",r),[4,this.getDiscoveredAuthority(t,r)];case 1:return o=n.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:r},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:"msal.js.browser",version:"2.15.0",cpu:"",os:""}}]}})})},e.prototype.preflightInteractiveRequest=function(e,t){if(this.logger.verbose("preflightInteractiveRequest called, validating app environment",null==e?void 0:e.correlationId),gt.blockReloadInHiddenIframes(),this.interactionInProgress())throw oe.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},e.prototype.preflightBrowserEnvironmentCheck=function(e){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),gt.blockNonBrowserEnvironment(this.isBrowserEnvironment),gt.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),gt.blockReloadInHiddenIframes(),gt.blockAcquireTokenInPopups(),e===$.Redirect&&this.config.cache.cacheLocation===H.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw at.createInMemoryRedirectUnavailableError()},e.prototype.initializeBaseRequest=function(e){this.logger.verbose("Initializing BaseAuthRequest",e.correlationId);var t=e.authority||this.config.auth.authority,r=d(e&&e.scopes||[]),o=e&&e.correlationId||this.browserCrypto.createNewGuid();return e.authenticationScheme?this.logger.verbose('Authentication Scheme set to "'+e.authenticationScheme+'" as configured in Auth request',e.correlationId):(e.authenticationScheme=U.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request',e.correlationId)),s(s({},e),{correlationId:o,authority:t,scopes:r})},e.prototype.initializeServerTelemetryManager=function(e,t,r){this.logger.verbose("initializeServerTelemetryManager called",t);var o={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:r||!1,wrapperSKU:this.wrapperSKU,wrapperVer:this.wrapperVer};return new it(o,this.browserStorage)},e.prototype.initializeAuthorizationRequest=function(e,t){this.logger.verbose("initializeAuthorizationRequest called",e.correlationId);var r=this.getRedirectUri(e.redirectUri),o={interactionType:t},n=Qe.setRequestState(this.browserCrypto,e&&e.state||"",o),i=s(s({},this.initializeBaseRequest(e)),{redirectUri:r,state:n,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:E.FRAGMENT}),a=e.account||this.getActiveAccount();if(a&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+a),i.account=a),re.isEmpty(i.loginHint)){var c=this.browserStorage.getTemporaryCache(b.ADAL_ID_TOKEN);if(c){var l=new Pe(c,this.browserCrypto);this.browserStorage.removeItem(b.ADAL_ID_TOKEN),l.claims&&l.claims.upn&&(this.logger.verbose("No SSO params used and ADAL token retrieved, setting ADAL upn as loginHint"),i.loginHint=l.claims.upn)}}return this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||"",i.account||null),i},e.prototype.initializeAuthorizationCodeRequest=function(e){return a(this,void 0,void 0,function(){var t,r;return c(this,function(o){switch(o.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=o.sent(),r=s(s({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=C.S256_CODE_CHALLENGE_METHOD,[2,r]}})})},e.prototype.initializeLogoutRequest=function(e){if(this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId),this.interactionInProgress())throw oe.createInteractionInProgressError();var t=s({correlationId:this.browserCrypto.createNewGuid()},e);return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=pe.getAbsoluteUrl(e.postLogoutRedirectUri,gt.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=pe.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,gt.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=pe.getAbsoluteUrl(gt.getCurrentUri(),gt.getCurrentUri())),t},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.wrapperSKU=e,this.wrapperVer=t},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e}()),_t=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};!function(e){e.SELECT_ACCOUNT="select_account",e.LOGIN="login",e.CONSENT="consent"}(Ct||(Ct={}));class It extends o.IProvider{constructor(e){super(),this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.homeAccountKey="275f3731-e4a4-468a-bf9c-baca24b31e26",this.initProvider(e)}get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}initProvider(e){return _t(this,void 0,void 0,function*(){if(!e.clientId)throw new Error("clientId must be provided");{const t=e.options||{auth:{clientId:e.clientId}};this.ms_config=t,this.ms_config.auth.clientId=e.clientId,e.authority&&(this.ms_config.auth.authority=e.authority),e.redirectUri&&(this.ms_config.auth.redirectUri=e.redirectUri),this.ms_config.cache=t.cache||{},this.ms_config.cache.cacheLocation=t.cache.cacheLocation||"localStorage",void 0!==this.ms_config.cache.storeAuthStateInCookie&&null!==this.ms_config.cache.storeAuthStateInCookie||(this.ms_config.cache.storeAuthStateInCookie=!0),e.redirectUri&&(this.ms_config.auth.redirectUri=e.redirectUri),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,this._loginType=void 0!==e.loginType?e.loginType:o.LoginType.Redirect,this._loginHint=void 0!==e.loginHint?e.loginHint:null,this._sid=void 0!==e.sid?e.sid:null,this._domainHint=void 0!==e.domainHint?e.domainHint:null,this.scopes=void 0!==e.scopes?e.scopes:["user.read"],this._publicClientApplication=new St(this.ms_config),this._prompt=void 0!==e.prompt?e.prompt:Ct.SELECT_ACCOUNT,this.graph=Object(o.createFromProvider)(this);try{const e=yield this._publicClientApplication.handleRedirectPromise();null!==e?this.handleResponse(null==e?void 0:e.account):this.trySilentSignIn()}catch(e){throw e}}})}trySilentSignIn(){return _t(this,void 0,void 0,function*(){let e={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){e.sid=this._sid,e.loginHint=this._loginHint;try{this.setState(o.ProviderState.Loading);const t=yield this._publicClientApplication.ssoSilent(e);t&&this.handleResponse(null==t?void 0:t.account)}catch(e){this.setState(o.ProviderState.SignedOut)}}else{const e=this.getAccount();if(e&&(yield this.getAccessToken(null)))return void this.handleResponse(e);this.setState(o.ProviderState.SignedOut)}})}login(){return _t(this,void 0,void 0,function*(){const e={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType==o.LoginType.Popup){const t=yield this._publicClientApplication.loginPopup(e);this.handleResponse(null==t?void 0:t.account)}else{const t=Object.assign({},e);this._publicClientApplication.loginRedirect(t)}})}getAllAccounts(){let e=[];return this._publicClientApplication.getAllAccounts().forEach(t=>{e.push({username:t.username,id:t.homeAccountId})}),e}setActiveAccount(e){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(e.id)),this.setStoredAccount(),super.setActiveAccount(e)}handleResponse(e){null!==e?(this.setActiveAccount({username:e.name,id:e.homeAccountId}),this.setState(o.ProviderState.SignedIn)):this.setState(o.ProviderState.SignedOut),this.clearRequestedScopes()}setStoredAccount(){this.clearStoredAccount(),window[this.ms_config.cache.cacheLocation].setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){let e=null;return e=window[this.ms_config.cache.cacheLocation].getItem(this.homeAccountKey),this._publicClientApplication.getAccountByHomeId(e)}clearStoredAccount(){window[this.ms_config.cache.cacheLocation].removeItem(this.homeAccountKey)}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let r=t.indexOf("openid");-1!==r&&t.splice(r,1),r=t.indexOf("profile"),-1!==r&&t.splice(r,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){const e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){const t=this.getDeniedScopes();if(t&&t.filter(t=>-1!==e.indexOf(t)).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){return this.getStoredAccount()||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return _t(this,void 0,void 0,function*(){const e={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType==o.LoginType.Redirect?(this._publicClientApplication.logoutRedirect(e),this.setState(o.ProviderState.SignedOut)):(yield this._publicClientApplication.logoutPopup(Object.assign({},e)),this.setState(o.ProviderState.SignedOut))})}getAccessToken(e){return _t(this,void 0,void 0,function*(){const t=e&&e.scopes||this.scopes,r={scopes:t,account:this.getAccount()};try{const e=r;return(yield this._publicClientApplication.acquireTokenSilent(e)).accessToken}catch(e){if(e instanceof be)if(this._loginType===o.LoginType.Redirect){if(this.areScopesDenied(t))throw e;this.setRequestedScopes(t),this._publicClientApplication.acquireTokenRedirect(r)}else try{return(yield this._publicClientApplication.acquireTokenPopup(r)).accessToken}catch(e){throw e}else this.setState(o.ProviderState.SignedOut)}throw null})}}var Et=r("hkiJ"),xt=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},Ot=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let At=class extends o.MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const e={clientId:this.clientId};if(this.loginType&&this.loginType.length>1){let t=this.loginType.toLowerCase();t=t[0].toUpperCase()+t.slice(1);const r=o.LoginType[t];e.loginType=r}if(this.authority&&(e.authority=this.authority),this.scopes){const t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}if(this.redirectUri&&(e.redirectUri=this.redirectUri),this.prompt){let t=this.prompt.toUpperCase();const r=Ct[t];e.prompt=r}if(this.prompt){let t=this.prompt.toUpperCase();const r=Ct[t];e.prompt=r}this.provider=new It(e),o.Providers.globalProvider=this.provider}}};xt([Object(Et.f)({attribute:"client-id",type:String}),Ot("design:type",Object)],At.prototype,"clientId",void 0),xt([Object(Et.f)({attribute:"login-type",type:String}),Ot("design:type",Object)],At.prototype,"loginType",void 0),xt([Object(Et.f)({attribute:"scopes",type:String}),Ot("design:type",Object)],At.prototype,"scopes",void 0),xt([Object(Et.f)({attribute:"authority",type:String}),Ot("design:type",Object)],At.prototype,"authority",void 0),xt([Object(Et.f)({attribute:"redirect-uri",type:String}),Ot("design:type",Object)],At.prototype,"redirectUri",void 0),xt([Object(Et.f)({attribute:"prompt",type:String}),Ot("design:type",String)],At.prototype,"prompt",void 0),At=xt([Object(Et.c)("mgt-msal2-provider")],At)},Uekq:function(e,t,r){"use strict";r.r(t),r.d(t,"MgtPersonCard",function(){return _});var o=r("hkiJ"),n=r("IVvM"),i=r("cmRh"),s=r("Vxif"),a=r("LgXN"),c=r("o4Lv"),l=r("598n"),d=r("P7nI"),u=r("pLaE"),h=r("g1To"),p=r("fy+Q"),f=r("vzno"),g=r("v0KA"),m=r("axWM"),v=r("2U3X"),b=r("9iOx"),y=r("wvst"),w=(r("0Owk"),r("2V34"));for(var k in w)["default","MgtPersonCard"].indexOf(k)<0&&function(e){r.d(t,e,function(){return w[e]})}(k);var C,T=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},S=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let _=C=class extends i.MgtTemplatedComponent{constructor(){super(),this._chatInput="",this._currentSection=null,this._history=[],this.sections=[]}static get styles(){return p.a}get strings(){return y.a}static get requiredScopes(){return C.getScopes()}static getScopes(){const e=[];return this.config.sections.files&&e.push("Sites.Read.All"),this.config.sections.mailMessages&&e.push("Mail.ReadBasic"),this.config.sections.organization&&(e.push("User.Read.All"),"boolean"!=typeof this.config.sections.organization&&this.config.sections.organization.showWorksWith&&e.push("People.Read.All")),this.config.sections.profile&&e.push("User.Read.All"),this.config.useContactApis&&e.push("Contacts.Read"),e.indexOf("User.Read.All")<0&&(e.push("User.ReadBasic.All"),e.push("User.Read")),e.indexOf("People.Read.All")<0&&e.push("People.Read"),[...new Set(e)]}static get config(){return this._config}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.personImage=null,this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this.state=null,this.requestStateUpdate())}get internalPersonDetails(){return this.state&&this.state.person||this.personDetails}attributeChangedCallback(e,t,r){if(super.attributeChangedCallback(e,t,r),t!==r)switch(e){case"person-query":this.personDetails=null,this.state=null,this.requestStateUpdate()}}navigate(e){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this.state}),this._personDetails=e,this.state=null,this.personImage=null,this._currentSection=null,this.sections=[],this.requestStateUpdate()}goBack(){if(!this._history||!this._history.length)return;const e=this._history.pop();this._currentSection=null,this.state=e.state,this._personDetails=e.state,this.personImage=e.personImage,this.loadSections()}clearHistory(){if(this._currentSection=null,!this._history||!this._history.length)return;const e=this._history[0];this._history=[],this.state=e.state,this._personDetails=e.state,this.personImage=e.personImage,this.loadSections()}render(){if(!this.internalPersonDetails)return this.renderNoData();const e=this.internalPersonDetails,t=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:t});const r=this._history&&this._history.length?o.d`
            <div class="nav">
              <div class="nav__back" @click=${()=>this.goBack()}>${Object(d.b)(d.a.Back)}</div>
            </div>
          `:null;let n=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:t});if(!n){const t=this.renderPerson(),r=this.renderContactIcons(e);n=o.d`
        ${t} ${r}
      `}const i=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();return o.d`
      <div class="root" dir=${this.direction}>
        ${r}
        <div class="person-details-container">${n}</div>
        <div class="expanded-details-container">${i}</div>
      </div>
    `}renderNoData(){return this.renderTemplate("no-data",null)||o.d``}renderPerson(){return o.d`
      <mgt-person
        class="person-image"
        .personDetails=${this.internalPersonDetails}
        .personImage=${this.getImage()}
        .personPresence=${this.personPresence}
        .showPresence=${this.showPresence}
        .avatarSize=${"large"}
        .view=${a.a.threelines}
        .line2Property=${"jobTitle"}
        .line3Property=${"department"}
      ></mgt-person>
    `}renderPersonSubtitle(e){if((e=e||this.internalPersonDetails).department)return o.d`
      <div class="department">${e.department}</div>
    `}renderContactIcons(e){if(this.isExpanded)return;const t=e=e||this.internalPersonDetails;let r,n;return Object(s.e)(e)&&(r=o.d`
        <div class="icon" @click=${()=>this.emailUser()}>
          ${Object(d.b)(d.a.SmallEmail)}
          <span>${this.strings.sendEmailLinkSubtitle}</span>
        </div>
      `),t.userPrincipalName&&(n=o.d`
        <div class="icon" @click=${()=>this.chatUser()}>
          ${Object(d.b)(d.a.SmallChat)}
          <span>${this.strings.startChatLinkSubtitle}</span>
        </div>
      `),o.d`
      <div class="base-icons">
        ${r} ${n}
      </div>
    `}renderExpandedDetailsButton(){return o.d`
      <div class="expanded-details-button" @click=${()=>this.showExpandedDetails()}>
        ${Object(d.b)(d.a.ExpandDown)}
      </div>
    `}renderExpandedDetails(e){if(!this.state&&this.isStateLoading)return o.d`
        <div class="loading">
          <mgt-spinner></mgt-spinner>
        </div>
      `;e=e||this.internalPersonDetails;const t=this.renderSectionNavigation(),r=this.renderCurrentSection();return o.d`
      <div class="section-nav">
        ${t}
      </div>
      <div class="section-host" @wheel=${e=>this.handleSectionScroll(e)}>
        ${r}
      </div>
    `}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;const e=this._currentSection?this.sections.indexOf(this._currentSection):-1,t=this.sections.map((t,r,i)=>{const s=Object(n.a)({active:r===e,"section-nav__icon":!0});return o.d`
        <button class=${s} @click=${()=>this.updateCurrentSection(t)}>${t.renderIcon()}</button>
      `}),r=Object(n.a)({active:-1===e,"section-nav__icon":!0});return o.d`
      <button class=${r} @click=${()=>this.updateCurrentSection(null)}>
        ${Object(d.b)(d.a.Overview)}
      </button>
      ${t}
    `}renderOverviewSection(){const e=this.sections.map(e=>o.d`
        <div class="section">
          <div class="section__header">
            <div class="section__title">${e.displayName}</div>
            <a class="section__show-more" @click=${()=>this.updateCurrentSection(e)}
              >${this.strings.showMoreSectionButton}</a
            >
          </div>
          <div class="section__content">${e.asCompactView()}</div>
        </div>
      `),t=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this.state});return t&&e.splice(1,0,o.d`
          <div class="section">
            <div class="additional-details">${t}</div>
          </div>
        `),o.d`
      <div class="sections">
        ${e}
      </div>
    `}renderCurrentSection(){if(this.sections&&this.sections.length||this.hasTemplate("additional-details"))return 1!==this.sections.length||this.hasTemplate("additional-details")?this._currentSection?o.d`
      ${this._currentSection.asFullView()}
    `:this.renderOverviewSection():o.d`
        ${this.sections[0].asFullView()}
      `}loadState(){return e=this,void 0,r=function*(){if(this.state)return;if(!this.personDetails&&this.inheritDetails){let e=this.parentElement;for(;e&&"MGT-PERSON"!==e.tagName;)e=e.parentElement;e&&e.personDetails&&(this.personDetails=e.personDetails,this.personImage=e.personImage)}const e=i.Providers.globalProvider;if(!e||e.state!==i.ProviderState.SignedIn)return;const t=e.graph.forComponent(this);if(this.isStateLoading=!0,this._me||(this._me=yield i.Providers.me()),this.personDetails){const e=this.personDetails,r=e.userPrincipalName||e.id;if(r&&!Object(s.e)(e)){const e=yield Object(l.a)(t,r);this.personDetails=e,this.personImage=this.getImage()}}else if(this.userId||"me"===this.personQuery){const e=yield Object(l.a)(t,this.userId);this.personDetails=e,this.personImage=this.getImage()}else if(this.personQuery){const e=yield Object(s.d)(t,this.personQuery,1);e&&e.length&&(this.personDetails=e[0],Object(c.b)(t,this.personDetails,C.config.useContactApis).then(e=>{e&&(this.personDetails.personImage=e,this.personImage=e)}))}const r={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{this.personDetails&&this.personDetails.id?Object(u.a)(t,this.personDetails.id).then(e=>{this.personPresence=e}):this.personPresence=r}catch(e){this.personPresence=r}this.state=yield Object(h.a)(t,this.personDetails,this._me===this.personDetails.id,C.config),this.loadSections(),this.isStateLoading=!1},new((t=void 0)||(t=Promise))(function(o,n){function i(e){try{a(r.next(e))}catch(e){n(e)}}function s(e){try{a(r.throw(e))}catch(e){n(e)}}function a(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t(function(e){e(r)})).then(i,s)}a((r=r.apply(e,[])).next())});var e,t,r}sendQuickMessage(){const e=this._chatInput.trim();e&&e.length&&this.chatUser(e)}emailUser(){const e=this.internalPersonDetails;if(e){const t=Object(s.e)(e);t&&window.open("mailto:"+t,"_blank")}}callUser(){const e=this.personDetails,t=this.personDetails;if(e&&e.businessPhones&&e.businessPhones.length){const t=e.businessPhones[0];t&&window.open("tel:"+t,"_blank")}else if(t&&t.phones&&t.phones.length){const e=this.getPersonBusinessPhones(t)[0];e&&window.open("tel:"+e,"_blank")}}chatUser(e=null){const t=this.personDetails;if(t&&t.userPrincipalName){let r="https://teams.microsoft.com/l/chat/0/0?users="+t.userPrincipalName;e&&e.length&&(r+="&message="+e);const o=()=>window.open(r,"_blank");i.TeamsHelper.isAvailable?i.TeamsHelper.executeDeepLink(r,e=>{e||o()}):o()}}showExpandedDetails(){const e=this.renderRoot.querySelector(".root");e&&e.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;const e=new f.a(this.internalPersonDetails);if(e.hasData&&this.sections.push(e),!this.state)return;const{person:t,directReports:r,messages:o,files:n,profile:i}=this.state;if(C.config.sections.organization&&(t&&t.manager||r&&r.length)&&this.sections.push(new v.a(this.state,this._me)),C.config.sections.mailMessages&&o&&o.length&&this.sections.push(new m.a(o)),C.config.sections.files&&n&&n.length&&this.sections.push(new g.a(n)),C.config.sections.profile&&i){const e=new b.a(i);e.hasData&&this.sections.push(e)}}getImage(){if(this.personImage)return this.personImage;const e=this.personDetails;return e&&e.personImage?e.personImage:null}getPersonBusinessPhones(e){const t=e.phones,r=[];for(const e of t)"business"===e.type&&r.push(e.number);return r}updateCurrentSection(e){this.renderRoot.querySelector(".section-host").scrollTop=0,this._currentSection=e,this.requestUpdate()}handleSectionScroll(e){const t=this.renderRoot.querySelector(".section-host");t&&(e.deltaY<0&&0===t.scrollTop||e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1||e.stopPropagation())}};_._config={sections:{files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0},useContactApis:!0},T([Object(o.f)({attribute:"person-details",type:Object}),S("design:type",Object),S("design:paramtypes",[Object])],_.prototype,"personDetails",null),T([Object(o.f)({attribute:"person-query"}),S("design:type",String)],_.prototype,"personQuery",void 0),T([Object(o.f)({attribute:"user-id"}),S("design:type",String),S("design:paramtypes",[String])],_.prototype,"userId",null),T([Object(o.f)({attribute:"person-image",type:String}),S("design:type",String)],_.prototype,"personImage",void 0),T([Object(o.f)({attribute:"fetch-image",type:Boolean}),S("design:type",Boolean)],_.prototype,"fetchImage",void 0),T([Object(o.f)({attribute:"is-expanded",type:Boolean}),S("design:type",Boolean)],_.prototype,"isExpanded",void 0),T([Object(o.f)({attribute:"inherit-details",type:Boolean}),S("design:type",Boolean)],_.prototype,"inheritDetails",void 0),T([Object(o.f)({attribute:"show-presence",type:Boolean}),S("design:type",Boolean)],_.prototype,"showPresence",void 0),T([Object(o.f)({attribute:"person-presence",type:Object}),S("design:type",Object)],_.prototype,"personPresence",void 0),T([Object(o.e)(),S("design:type",Object)],_.prototype,"state",void 0),T([Object(o.e)(),S("design:type",Boolean)],_.prototype,"isStateLoading",void 0),_=C=T([Object(o.c)("mgt-person-card"),S("design:paramtypes",[])],_)},Vcri:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var o=r("2cRh"),n=r("JaDF"),i="interaction_required",s="consent_required",a="login_required",c=function(e){function t(r,o){var n=e.call(this,r,o)||this;return n.name="InteractionRequiredAuthError",Object.setPrototypeOf(n,t.prototype),n}return o.d(t,e),t.isInteractionRequiredError=function(e){return e&&[i,s,a].indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(a,e)},t.createInteractionRequiredAuthError=function(e){return new t(i,e)},t.createConsentRequiredAuthError=function(e){return new t(s,e)},t}(n.a)},VkLk:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var o=r("2cRh"),n=function(e){function t(r,o){var n=e.call(this,o)||this;return Object.setPrototypeOf(n,t.prototype),n.errorCode=r,n.errorMessage=o,n.name="AuthError",n}return o.d(t,e),t.createUnexpectedError=function(e){return new t("unexpected_error","Unexpected error in authentication.: "+e)},t.createNoWindowObjectError=function(e){return new t("no_window_object","No window object available. Details: "+e)},t}(Error)},Vxif:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return n}),r.d(t,"d",function(){return u}),r.d(t,"f",function(){return h}),r.d(t,"e",function(){return p}),r.d(t,"c",function(){return f}),r.d(t,"g",function(){return g});var o,n,i=r("cmRh"),s=r("uHnN"),a=r("/vu6"),c=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};!function(e){e[e.any=0]="any",e.person="person",e.group="group"}(o||(o={})),function(e){e.any="any",e.user="user",e.contact="contact"}(n||(n={}));const l=()=>i.CacheService.config.people.invalidationPeriod||i.CacheService.config.defaultInvalidationPeriod,d=()=>i.CacheService.config.people.isEnabled&&i.CacheService.config.isEnabled;function u(e,t,r=10,o=n.any){return c(this,void 0,void 0,function*(){let s,c=`${t}:${r}:${o}`;if(d()){s=i.CacheService.getCache(a.a.people,a.a.people.stores.peopleQuery);const e=d()?yield s.getValue(c):null;if(e&&l()>Date.now()-e.timeCached)return e.results.map(e=>JSON.parse(e))}let u,h="personType/class eq 'Person'";o!==n.any&&(o===n.user?h+="and personType/subclass eq 'OrganizationUser'":h+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')");try{if(u=yield e.api("/me/people").search('"'+t+'"').top(r).filter(h).middlewareOptions(Object(i.prepScopes)("people.read")).get(),d()&&u){const e={maxResults:r,results:null};e.results=u.value.map(e=>JSON.stringify(e)),s.putValue(t,e)}}catch(e){}return u?u.value:null})}function h(e,t=n.any){return c(this,void 0,void 0,function*(){let r,o="*:"+t;if(d()){r=i.CacheService.getCache(a.a.people,a.a.people.stores.peopleQuery);const e=yield r.getValue(o);if(e&&l()>Date.now()-e.timeCached)return e.results.map(e=>JSON.parse(e))}let s,c="personType/class eq 'Person'";t!==n.any&&(t===n.user?c+="and personType/subclass eq 'OrganizationUser'":c+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')");try{s=yield e.api("/me/people").middlewareOptions(Object(i.prepScopes)("people.read")).filter(c).get(),d()&&s&&r.putValue(o,{maxResults:10,results:s.value.map(e=>JSON.stringify(e))})}catch(e){}return s?s.value:null})}function p(e){const t=e,r=e,o=e;return r.mail?Object(s.c)(r.mail):t.scoredEmailAddresses&&t.scoredEmailAddresses.length?Object(s.c)(t.scoredEmailAddresses[0].address):o.emailAddresses&&o.emailAddresses.length?Object(s.c)(o.emailAddresses[0].address):null}function f(e,t){return c(this,void 0,void 0,function*(){let r;if(d()){r=i.CacheService.getCache(a.a.people,a.a.people.stores.contacts);const e=yield r.getValue(t);if(e&&l()>Date.now()-e.timeCached)return JSON.parse(e.person)}const o=yield e.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${t}')`).middlewareOptions(Object(i.prepScopes)("contacts.read")).get();return d()&&o&&r.putValue(t,{person:JSON.stringify(o.value)}),o?o.value:null})}function g(e,t,r,o){return c(this,void 0,void 0,function*(){let n;const s=`${t}${r}`;if(d()){n=i.CacheService.getCache(a.a.people,a.a.people.stores.peopleQuery);const e=yield n.getValue(s);if(e&&l()>Date.now()-e.timeCached)return e.results.map(e=>JSON.parse(e))}let c=e.api(r).version(t);o&&o.length&&(c=c.middlewareOptions(Object(i.prepScopes)(...o)));let u=yield c.get();if(u&&Array.isArray(u.value)&&u["@odata.nextLink"]){let r=1,o=u;for(;o&&o["@odata.nextLink"];){r++;const n=o["@odata.nextLink"].split(t)[1];o=yield e.client.api(n).version(t).get(),o&&o.value&&o.value.length&&(o.value=u.value.concat(o.value),u=o)}}if(d()&&u){const e={results:null};Array.isArray(u.value)?e.results=u.value.map(e=>JSON.stringify(e)):e.results=[JSON.stringify(u)],n.putValue(s,e)}return u?Array.isArray(u.value)?u.value:[u]:null})}},WCxG:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var o=r("2cRh"),n=r("BdEk"),i=r("zUnT"),s=r("ghBn"),a=r("5q4X");class c{constructor(e){this.authenticationProvider=e}execute(e){return o.b(this,void 0,void 0,function*(){try{let t,r,o;e.middlewareControl instanceof n.a&&(t=e.middlewareControl.getMiddlewareOptions(s.a)),void 0!==t&&(r=t.authenticationProvider,o=t.authenticationProviderOptions),void 0===r&&(r=this.authenticationProvider);const l="Bearer "+(yield r.getAccessToken(o));return Object(i.a)(e.request,e.options,c.AUTHORIZATION_HEADER,l),a.b.updateFeatureUsageFlag(e,a.a.AUTHENTICATION_HANDLER_ENABLED),yield this.nextMiddleware.execute(e)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}c.AUTHORIZATION_HEADER="Authorization"},WcTu:function(e,t,r){"use strict";r.d(t,"b",function(){return l.a}),r.d(t,"a",function(){return f});var o=r("hkiJ"),n=r("JpLj"),i=r("Vxif"),s=r("pLaE"),a=r("sh+J"),c=r("cmRh"),l=(r("iNQq"),r("+pM/"));const d=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family);color:var(--color,#000);font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}
`];var u=r("cy2K"),h=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let f=class extends c.MgtTemplatedComponent{constructor(){super(),this.personCardInteraction=l.a.hover,this.scopes=[],this._version="v1.0",this.showMax=3}static get styles(){return d}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(e){Object(c.arraysAreEqual)(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}get peopleQueries(){return this._peopleQueries}set peopleQueries(e){Object(c.arraysAreEqual)(this._peopleQueries,e)||(this._peopleQueries=e,this.requestStateUpdate(!0))}get resource(){return this._resource}set resource(e){this._resource!==e&&(this._resource=e,this.requestStateUpdate(!0))}get version(){return this._version}set version(e){this._version!==e&&(this._version=e,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...u.a.requiredScopes])]}clearState(){this.people=null}requestStateUpdate(e){return e&&(this.people=null),super.requestStateUpdate(e)}render(){return this.isLoadingState?this.renderLoading():this.people&&0!==this.people.length?this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||o.d``}renderPeople(){const e=this.people.slice(0,this.showMax);return o.d`
      <ul class="people-list">
        ${Object(n.a)(e,e=>e.id?e.id:e.displayName,e=>o.d`
            <li class="people-person">
              ${this.renderPerson(e)}
            </li>
          `)}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){const e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||o.d`
        <li class="overflow"><span>+${e}<span></li>
      `}renderPerson(e){let t={activity:"Offline",availability:"Offline",id:null};return this.showPresence&&this._peoplePresence&&(t=this._peoplePresence[e.id]),this.renderTemplate("person",{person:e},e.id)||o.d`
        <mgt-person
          .personDetails=${e}
          .fetchImage=${!0}
          .avatarSize=${"small"}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${t}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||o.d``}loadState(){return e=this,void 0,r=function*(){if(!this.people){const e=c.Providers.globalProvider;if(e&&e.state===c.ProviderState.SignedIn){const t=e.graph.forComponent(this);this.groupId?this.people=yield Object(a.a)(t,null,this.groupId,this.showMax,i.a.person):this.userIds?this.people=yield Object(a.h)(t,this.userIds):this.peopleQueries?this.people=yield Object(a.g)(t,this.peopleQueries):this.resource?this.people=yield Object(i.g)(t,this.version,this.resource,this.scopes):this.people=yield Object(i.f)(t),this.showPresence?this._peoplePresence=yield Object(s.b)(t,this.people):this._peoplePresence=null}}},new((t=void 0)||(t=Promise))(function(o,n){function i(e){try{a(r.next(e))}catch(e){n(e)}}function s(e){try{a(r.throw(e))}catch(e){n(e)}}function a(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t(function(e){e(r)})).then(i,s)}a((r=r.apply(e,[])).next())});var e,t,r}};h([Object(o.f)({attribute:"group-id",type:String}),p("design:type",String),p("design:paramtypes",[Object])],f.prototype,"groupId",null),h([Object(o.f)({attribute:"user-ids",converter:(e,t)=>e.split(",").map(e=>e.trim())}),p("design:type",Array),p("design:paramtypes",[Array])],f.prototype,"userIds",null),h([Object(o.f)({attribute:"people",type:Object}),p("design:type",Array)],f.prototype,"people",void 0),h([Object(o.f)({attribute:"people-queries",converter:(e,t)=>e.split(",").map(e=>e.trim())}),p("design:type",Array),p("design:paramtypes",[Array])],f.prototype,"peopleQueries",null),h([Object(o.f)({attribute:"show-max",type:Number}),p("design:type",Number)],f.prototype,"showMax",void 0),h([Object(o.f)({attribute:"show-presence",type:Boolean}),p("design:type",Boolean)],f.prototype,"showPresence",void 0),h([Object(o.f)({attribute:"person-card",converter:(e,t)=>(e=e.toLowerCase(),void 0===l.a[e]?l.a.hover:l.a[e])}),p("design:type",Number)],f.prototype,"personCardInteraction",void 0),h([Object(o.f)({attribute:"resource",type:String}),p("design:type",String),p("design:paramtypes",[Object])],f.prototype,"resource",null),h([Object(o.f)({attribute:"version",type:String}),p("design:type",String),p("design:paramtypes",[Object])],f.prototype,"version",null),h([Object(o.f)({attribute:"scopes",converter:e=>e?e.toLowerCase().split(","):null,reflect:!0}),p("design:type",Array)],f.prototype,"scopes",void 0),f=h([Object(o.c)("mgt-people"),p("design:paramtypes",[])],f)},Wozh:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var o=r("ZMEg"),n=r("J0Kn"),i=r("tAiM"),s=r("+BgG");const a="https://proxy.apisandbox.msdn.microsoft.com/svc?url=";class c extends i.a{constructor(e){const t=[new n.a(e),new n.g(new n.h),new n.i,new l,new n.e];super(n.d.initWithMiddleware({baseUrl:a+"https://graph.microsoft.com/",middleware:Object(s.a)(...t)}))}forComponent(e){return this}}class l{execute(e){return t=this,void 0,o=function*(){try{const t=e.request,r=a.length;e.request=t.substring(0,r)+escape(t.substring(r))}catch(e){}return yield this._nextMiddleware.execute(e)},new((r=void 0)||(r=Promise))(function(e,n){function i(e){try{a(o.next(e))}catch(e){n(e)}}function s(e){try{a(o.throw(e))}catch(e){n(e)}}function a(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r(function(e){e(o)})).then(i,s)}a((o=o.apply(t,[])).next())});var t,r,o}setNext(e){this._nextMiddleware=e}}var d=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};class u extends o.a{constructor(e=!1){super(),this.graph=new c(this),e?this.setState(o.c.SignedIn):this.setState(o.c.SignedOut)}login(){return d(this,void 0,void 0,function*(){this.setState(o.c.Loading),yield new Promise(e=>setTimeout(e,3e3)),this.setState(o.c.SignedIn)})}logout(){return d(this,void 0,void 0,function*(){this.setState(o.c.Loading),yield new Promise(e=>setTimeout(e,3e3)),this.setState(o.c.SignedOut)})}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}}},XEV4:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var o=r("2cRh"),n=r("vY9u"),i=r("BdEk"),s=r("zUnT"),a=r("PYfE"),c=r("5q4X");class l{constructor(e=new a.a){this.options=e}isRedirect(e){return-1!==l.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(l.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(l.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const r=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,o=r.exec(e);let n,i;null!==o&&(n=o[0]);const s=r.exec(t);return null!==s&&(i=s[0]),void 0!==n&&void 0!==i&&n!==i}updateRequestUrl(e,t){return o.b(this,void 0,void 0,function*(){t.request="string"==typeof t.request?e:yield Object(s.b)(e,t.request)})}getOptions(e){let t;return e.middlewareControl instanceof i.a&&(t=e.middlewareControl.getMiddlewareOptions(a.a)),void 0===t&&(t=Object.assign(new a.a,this.options)),t}executeWithRedirect(e,t,r){return o.b(this,void 0,void 0,function*(){try{yield this.nextMiddleware.execute(e);const o=e.response;if(!(t<r.maxRedirects&&this.isRedirect(o)&&this.hasLocationHeader(o)&&r.shouldRedirect(o)))return;if(++t,o.status===l.STATUS_CODE_SEE_OTHER)e.options.method=n.a.GET,delete e.options.body;else{const t=this.getLocationHeader(o);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(o.url,t)&&delete e.options.headers[l.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,r)}catch(e){throw e}})}execute(e){return o.b(this,void 0,void 0,function*(){try{const t=0,r=this.getOptions(e);return e.options.redirect=l.MANUAL_REDIRECT,c.b.updateFeatureUsageFlag(e,c.a.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,t,r)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}l.REDIRECT_STATUS_CODES=[301,302,303,307,308],l.STATUS_CODE_SEE_OTHER=303,l.LOCATION_HEADER="Location",l.AUTHORIZATION_HEADER="Authorization",l.MANUAL_REDIRECT="manual"},Xzjw:function(e,t,r){"use strict";r.d(t,"a",function(){return o});class o{constructor(e=o.DEFAULT_DELAY,t=o.DEFAULT_MAX_RETRIES,r=o.DEFAULT_SHOULD_RETRY){if(e>o.MAX_DELAY&&t>o.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${o.MAX_DELAY} and ${o.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>o.MAX_DELAY){const e=new Error("Delay should not be more than "+o.MAX_DELAY);throw e.name="MaxLimitExceeded",e}if(t>o.MAX_MAX_RETRIES){const e=new Error("MaxRetries should not be more than "+o.MAX_MAX_RETRIES);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,o.MAX_DELAY),this.maxRetries=Math.min(t,o.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return o.MAX_DELAY}}o.DEFAULT_DELAY=3,o.DEFAULT_MAX_RETRIES=3,o.MAX_DELAY=180,o.MAX_MAX_RETRIES=10,o.DEFAULT_SHOULD_RETRY=()=>!0},ZMEg:function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"b",function(){return o}),r.d(t,"c",function(){return n});var o,n,i=r("PL2B");class s{constructor(){this._loginChangedDispatcher=new i.a,this._activeAccountChangedDispatcher=new i.a,this._state=n.Loading}get state(){return this._state}get name(){return"MgtIProvider"}setState(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}onStateChanged(e){this._loginChangedDispatcher.add(e)}removeStateChangedHandler(e){this._loginChangedDispatcher.remove(e)}setActiveAccount(e){this.fireActiveAccountChanged()}onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}removeActiveAccountChangedHandler(e){this._activeAccountChangedDispatcher.remove(e)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...e){return this.getAccessToken({scopes:e})}}!function(e){e[e.Popup=0]="Popup",e[e.Redirect=1]="Redirect"}(o||(o={})),function(e){e[e.Loading=0]="Loading",e[e.SignedOut=1]="SignedOut",e[e.SignedIn=2]="SignedIn"}(n||(n={}))},ZgJh:function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"a",function(){return h});var o,n=r("hkiJ"),i=r("cmRh"),s=r("o4Lv"),a=r("/vu6"),c=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};!function(e){e.json="json",e.image="image"}(o||(o={}));const u=()=>i.CacheService.config.response.isEnabled&&i.CacheService.config.isEnabled;let h=class extends i.MgtTemplatedComponent{constructor(){super(...arguments),this.scopes=[],this.version="v1.0",this.type=o.json,this.maxPages=3,this.pollingRate=0,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.isPolling=!1,this.isRefreshing=!1}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),this.requestStateUpdate()}refresh(e=!1){this.isRefreshing=!0,this.requestStateUpdate(e),this.isRefreshing=!1}clearState(){this.response=null}render(){if(this.isLoadingState&&!this.isPolling)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&this.response&&this.response.value){let e;if(Array.isArray(this.response.value)){let t=null;this.isLoadingState&&!this.isPolling&&(t=this.renderTemplate("loading",null)),e=n.d`
          ${this.response.value.map(e=>this.renderTemplate("value",e,e.id))} ${t}
        `}else e=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){const t=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?n.d`
            ${t}${e}
          `:n.d`
            ${e}${t}
          `}return e}return this.response&&this.renderTemplate("default",this.response)||n.d``}loadState(){return d(this,void 0,void 0,function*(){const e=i.Providers.globalProvider;if(this.error=null,e&&e.state===i.ProviderState.SignedIn){if(this.resource){try{let t;const r=`${this.version}${this.resource}`;let n=null;if(this.shouldRetrieveCache()){t=i.CacheService.getCache(a.a.get,a.a.get.stores.responses);const e=u()?yield t.getValue(r):null;e&&(this.cacheInvalidationPeriod||i.CacheService.config.response.invalidationPeriod||i.CacheService.config.defaultInvalidationPeriod)>Date.now()-e.timeCached&&(n=JSON.parse(e.response))}if(!n){let c=this.resource,l=!1;this.response&&this.response["@odata.deltaLink"]?(c=this.response["@odata.deltaLink"],l=!0):l=new URL(c,"https://graph.microsoft.com").pathname.endsWith("delta");const d=e.graph.forComponent(this);let u=d.api(c).version(this.version);if(this.scopes&&this.scopes.length&&(u=u.middlewareOptions(Object(i.prepScopes)(...this.scopes))),this.type===o.json){if(n=yield u.get(),l&&this.response&&Array.isArray(this.response.value)&&Array.isArray(n.value)&&(n.value=this.response.value.concat(n.value)),this.isPolling||Object(i.equals)(this.response,n)||(this.response=n),n&&Array.isArray(n.value)&&n["@odata.nextLink"]){let e=1,t=n;for(;(e<this.maxPages||this.maxPages<=0||l&&this.pollingRate)&&t&&t["@odata.nextLink"];){e++;const r=t["@odata.nextLink"].split(this.version)[1];t=yield d.client.api(r).version(this.version).get(),t&&t.value&&t.value.length&&(t.value=n.value.concat(t.value),n=t,this.isPolling||(this.response=n))}}}else{if(-1===this.resource.indexOf("/photo/$value"))throw new Error("Only /photo/$value endpoints support the image type");const e=this.resource.replace("/photo/$value",""),t=yield Object(s.c)(d,e,this.scopes);t&&(n={image:t.photo})}this.shouldUpdateCache()&&n&&(t=i.CacheService.getCache(a.a.get,a.a.get.stores.responses),t.putValue(r,{response:JSON.stringify(n)}))}Object(i.equals)(this.response,n)||(this.response=n)}catch(e){this.error=e}this.response&&(this.error=null,this.pollingRate&&setTimeout(()=>d(this,void 0,void 0,function*(){this.isPolling=!0,yield this.loadState(),this.isPolling=!1}),this.pollingRate))}else this.response=null;this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}})}shouldRetrieveCache(){return u()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}shouldUpdateCache(){return u()&&this.cacheEnabled}};c([Object(n.f)({attribute:"resource",reflect:!0,type:String}),l("design:type",String)],h.prototype,"resource",void 0),c([Object(n.f)({attribute:"scopes",converter:(e,t)=>e?e.toLowerCase().split(","):null,reflect:!0}),l("design:type",Array)],h.prototype,"scopes",void 0),c([Object(n.f)({attribute:"version",reflect:!0,type:String}),l("design:type",String)],h.prototype,"version",void 0),c([Object(n.f)({attribute:"type",reflect:!0,type:o}),l("design:type",String)],h.prototype,"type",void 0),c([Object(n.f)({attribute:"max-pages",reflect:!0,type:Number}),l("design:type",Number)],h.prototype,"maxPages",void 0),c([Object(n.f)({attribute:"polling-rate",reflect:!0,type:Number}),l("design:type",Number)],h.prototype,"pollingRate",void 0),c([Object(n.f)({attribute:"cache-enabled",reflect:!0,type:Boolean}),l("design:type",Boolean)],h.prototype,"cacheEnabled",void 0),c([Object(n.f)({attribute:"cache-invalidation-period",reflect:!0,type:Number}),l("design:type",Number)],h.prototype,"cacheInvalidationPeriod",void 0),c([Object(n.f)({attribute:!1}),l("design:type",Object)],h.prototype,"response",void 0),c([Object(n.f)({attribute:!1}),l("design:type",Object)],h.prototype,"error",void 0),h=c([Object(n.c)("mgt-get")],h)},amkZ:function(e,t,r){"use strict";r.r(t);var o=r("nD1+"),n=r("O3Bf"),i=r("FIo/"),s=r("ZgJh"),a=r("3wPE"),c=r("jhrh"),l=r("WcTu"),d=r("Uekq"),u=r("cy2K"),h=r("t1eO"),p=r("LrYD"),f=r("R/m1");for(var g in r.d(t,"MgtAgenda",function(){return o.a}),r.d(t,"MgtFile",function(){return n.a}),r.d(t,"MgtFileList",function(){return i.a}),r.d(t,"ResponseType",function(){return s.b}),r.d(t,"MgtGet",function(){return s.a}),r.d(t,"MgtLogin",function(){return a.a}),r.d(t,"GroupType",function(){return c.a}),r.d(t,"PersonType",function(){return c.c}),r.d(t,"UserType",function(){return c.d}),r.d(t,"MgtPeoplePicker",function(){return c.b}),r.d(t,"PersonCardInteraction",function(){return l.b}),r.d(t,"MgtPeople",function(){return l.a}),d)["default","MgtAgenda","MgtFile","MgtFileList","ResponseType","MgtGet","MgtLogin","GroupType","PersonType","UserType","MgtPeoplePicker","PersonCardInteraction","MgtPeople"].indexOf(g)<0&&function(e){r.d(t,e,function(){return d[e]})}(g);r.d(t,"PersonViewType",function(){return u.b}),r.d(t,"avatarType",function(){return u.c}),r.d(t,"MgtPerson",function(){return u.a}),r.d(t,"TasksSource",function(){return h.b}),r.d(t,"MgtTasks",function(){return h.a}),r.d(t,"MgtTeamsChannelPicker",function(){return p.a}),r.d(t,"MgtTodo",function(){return f.a})},axWM:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var o=r("hkiJ"),n=r("/yih"),i=r("P7nI"),s=r("uHnN");const a=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--color,#000);font-size:16px}:host .root .message .message__detail .message__from{font-size:12px;color:var(--color-sub1,#323130)}:host .root .message .message__detail .message__message{font-size:12px;color:var(--color-sub2,#797775)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{font-size:12px;color:var(--color-sub2,#797775);margin-left:10px;white-space:nowrap}
`],c={emailsSectionTitle:"Emails"};let l=class extends n.a{constructor(e){super(),this._messages=e}static get styles(){return a}get strings(){return c}get displayName(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return Object(i.b)(i.a.Messages)}renderCompactView(){let e;if(this.isLoadingState)e=this.renderLoading();else if(this._messages&&this._messages.length){const t=this._messages?this._messages.slice(0,3).map(e=>this.renderMessage(e)):[];e=o.d`
        ${t}
      `}else e=this.renderNoData();return o.d`
      <div class="root compact">
        ${e}
      </div>
    `}renderFullView(){let e;return e=this.isLoadingState?this.renderLoading():this._messages&&this._messages.length?o.d`
        ${this._messages.slice(0,5).map(e=>this.renderMessage(e))}
      `:this.renderNoData(),o.d`
      <div class="root">
        <div class="title">${this.strings.emailsSectionTitle}</div>
        ${e}
      </div>
    `}renderMessage(e){return o.d`
      <div class="message" @click=${()=>this.handleMessageClick(e)}>
        <div class="message__detail">
          <div class="message__subject">${e.subject}</div>
          <div class="message__from">${e.from.emailAddress.name}</div>
          <div class="message__message">${e.bodyPreview}</div>
        </div>
        <div class="message__date">${Object(s.f)(new Date(e.receivedDateTime))}</div>
      </div>
    `}handleMessageClick(e){window.open(e.webLink,"_blank")}};l=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}([Object(o.c)("mgt-person-card-messages"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",t)}(0,[Array])],l)},ayeG:function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"b",function(){return o});var o,n=r("PL2B"),i=r("ZMEg");class s{static get globalProvider(){return this._globalProvider}static set globalProvider(e){e!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),e&&(e.onStateChanged(this.handleProviderStateChanged),e.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=e,this._eventDispatcher.fire(o.ProviderChanged))}static onProviderUpdated(e){this._eventDispatcher.add(e)}static removeProviderUpdatedListener(e){this._eventDispatcher.remove(e)}static onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}static removeActiveAccountChangedListener(e){this._activeAccountChangedDispatcher.remove(e)}static me(){return e=this,void 0,r=function*(){if(!this._me){const e=this.client;if(e)try{const t=yield e.api("me").get();t&&t.id&&(this._me=t)}catch(e){}}return this._me},new((t=void 0)||(t=Promise))(function(o,n){function i(e){try{a(r.next(e))}catch(e){n(e)}}function s(e){try{a(r.throw(e))}catch(e){n(e)}}function a(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t(function(e){e(r)})).then(i,s)}a((r=r.apply(e,[])).next())});var e,t,r}static get client(){return s.globalProvider&&s.globalProvider.state===i.c.SignedIn?s.globalProvider.graph.client:null}static handleProviderStateChanged(){s.globalProvider&&s.globalProvider.state===i.c.SignedIn||(s._me=null),s._eventDispatcher.fire(o.ProviderStateChanged)}static handleActiveAccountChanged(){s._activeAccountChangedDispatcher.fire(null)}}s._eventDispatcher=new n.a,s._activeAccountChangedDispatcher=new n.a,function(e){e[e.ProviderChanged=0]="ProviderChanged",e[e.ProviderStateChanged=1]="ProviderStateChanged"}(o||(o={}))},b9Ts:function(e,t,r){"use strict";r.d(t,"a",function(){return o});class o{constructor(e){this.componentName="string"==typeof e?e:e.tagName.toLowerCase()}}},bJc1:function(e,t,r){"use strict";r.d(t,"a",function(){return o});class o{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(e){this._microsoftTeamsLib=e}static get isAvailable(){return!(!this.microsoftTeamsLib||(window.parent!==window.self||!window.nativeInterface)&&"embedded-page-container"!==window.name&&"extension-tab-frame"!==window.name)}static executeDeepLink(e,t){const r=this.microsoftTeamsLib;r.initialize(),r.executeDeepLink(e,t)}}},bYMx:function(e,t){},cmRh:function(e,t,r){"use strict";r.r(t);var o=r("2hCA");r.d(t,"BatchResponse",function(){return o.a});var n=r("S/Up");for(var i in n)["default","BatchResponse"].indexOf(i)<0&&function(e){r.d(t,e,function(){return n[e]})}(i);var s=r("tAiM");r.d(t,"Graph",function(){return s.a}),r.d(t,"createFromProvider",function(){return s.b});var a=r("o1Rx");r.d(t,"BetaGraph",function(){return a.a});var c=r("yNap");r.d(t,"ComponentMediaQuery",function(){return c.a}),r.d(t,"MgtBaseComponent",function(){return c.b});var l=r("wAtJ");r.d(t,"MgtBaseProvider",function(){return l.a});var d=r("NgJg");r.d(t,"MgtTemplatedComponent",function(){return d.a});var u=r("ZMEg");r.d(t,"IProvider",function(){return u.a}),r.d(t,"LoginType",function(){return u.b}),r.d(t,"ProviderState",function(){return u.c});var h=r("ayeG");r.d(t,"Providers",function(){return h.a}),r.d(t,"ProvidersChangedState",function(){return h.b});var p=r("yLr0");r.d(t,"SimpleProvider",function(){return p.a});var f=r("8d8z");r.d(t,"CacheService",function(){return f.a}),r.d(t,"CacheStore",function(){return f.b});var g=r("PL2B");r.d(t,"EventDispatcher",function(){return g.a});var m=r("GogD");r.d(t,"equals",function(){return m.b}),r.d(t,"arraysAreEqual",function(){return m.a});var v=r("+BgG");r.d(t,"prepScopes",function(){return v.b}),r.d(t,"chainMiddleware",function(){return v.a});var b=r("bJc1");r.d(t,"TeamsHelper",function(){return b.a});var y=r("bYMx");for(var i in y)["default","BatchResponse","Graph","createFromProvider","BetaGraph","ComponentMediaQuery","MgtBaseComponent","MgtBaseProvider","MgtTemplatedComponent","IProvider","LoginType","ProviderState","Providers","ProvidersChangedState","SimpleProvider","CacheService","CacheStore","EventDispatcher","equals","arraysAreEqual","prepScopes","chainMiddleware","TeamsHelper"].indexOf(i)<0&&function(e){r.d(t,e,function(){return y[e]})}(i);var w=r("jTv9");r.d(t,"TemplateHelper",function(){return w.a});var k=r("EJ2E");r.d(t,"GraphPageIterator",function(){return k.a});var C=r("d4nO");r.d(t,"LocalizationHelper",function(){return C.a});var T=r("Wozh");r.d(t,"MockProvider",function(){return T.a});var S=r("2ngi");r.d(t,"MgtMockProvider",function(){return S.a})},cy2K:function(e,t,r){"use strict";r.d(t,"b",function(){return k}),r.d(t,"c",function(){return C}),r.d(t,"a",function(){return I});var o=r("hkiJ"),n=r("IVvM"),i=r("Vxif"),s=r("o4Lv"),a=r("pLaE"),c=r("598n"),l=r("sh+J"),d=r("LgXN"),u=r("cmRh"),h=(r("iNQq"),r("P7nI"));function p(){return void 0!==window.getWindowSegments}const f=[o.b`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132))}.root.visible .flyout{display:inline-block;animation-name:fadeIn;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}@keyframes fadeIn{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`];var g=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},m=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let v=class extends u.MgtBaseComponent{constructor(){super(),this._edgePadding=24,this._renderedOnce=!1,this.avoidHidingAnchor=!0,this.handleWindowEvent=this.handleWindowEvent.bind(this),this.handleResize=this.handleResize.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.addEventListener("expanded",()=>{window.requestAnimationFrame(()=>{this.updateFlyout()})})}static get styles(){return f}get isOpen(){return this._isOpen}set isOpen(e){const t=this._isOpen;t!==e&&(this._isOpen=e,window.requestAnimationFrame(()=>{this.setupWindowEvents(this.isOpen);const e=this._flyout;!this.isOpen&&e&&(e.style.width=null,e.style.setProperty("--mgt-flyout-set-width",null),e.style.setProperty("--mgt-flyout-set-height",null),e.style.maxHeight=null,e.style.top=null,e.style.left=null,e.style.bottom=null)}),this.requestUpdate("isOpen",t),this.dispatchEvent(new Event(e?"opened":"closed")))}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(e){super.updated(e),window.requestAnimationFrame(()=>{this.updateFlyout()})}render(){const e={dir:this.direction,root:!0,visible:this.isOpen},t=this.renderAnchor();let r=null;return(this.isOpen||this._renderedOnce)&&(this._renderedOnce=!0,r=o.d`
        <div class="flyout" @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `),o.d`
      <div class=${Object(n.a)(e)}>
        <div class="anchor">
          ${t}
        </div>
        <div class="scout-top"></div>
        <div class="scout-bottom"></div>
        ${r}
      </div>
    `}renderAnchor(){return o.d`
      <slot></slot>
    `}renderFlyout(){return o.d`
      <slot name="flyout"></slot>
    `}updateFlyout(){if(!this.isOpen)return;const e=this._anchor,t=this._flyout;if(t&&e){const r=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth,o=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let n,i,s,a=0,c=0;const l=t.getBoundingClientRect(),d=e.getBoundingClientRect(),u=this._topScout.getBoundingClientRect(),h=this._bottomScout.getBoundingClientRect(),f={height:o,left:0,top:0,width:r};if(p()){const e=(p()?window:null).getWindowSegments();let t;const r=d.left+d.width/2,o=d.top+d.height/2;for(const n of e)if(r>=n.left&&o>=n.top){t=n;break}t&&(f.left=t.left,f.top=t.top,f.width=t.width,f.height=t.height)}l.width+2*this._edgePadding>f.width?l.width>f.width?(s=f.width,a=0):a=(f.width-l.width)/2:a=d.left+l.width+this._edgePadding>f.width?d.left-(d.left+l.width+this._edgePadding-f.width):d.left<this._edgePadding?this._edgePadding:d.left;const g=f.height-(d.top+d.height),m=d.top;this.avoidHidingAnchor?g<=l.height?m<l.height?m>g?(n=f.height-d.top,i=m):(c=d.bottom,i=g):(n=f.height-d.top,i=m):(c=d.bottom,i=g):l.height+2*this._edgePadding>f.height?l.height>=f.height?(i=f.height,c=0):c=(f.height-l.height)/2:c=d.top+d.height+l.height+this._edgePadding>f.height?f.height-l.height-this._edgePadding:Math.max(d.top+d.height,this._edgePadding),0===u.top&&0===u.left||(a-=u.left,void 0!==n?n+=h.top-o:c-=u.top),"rtl"===this.direction?a>100&&this.offsetLeft>100&&(t.style.left=f.width-a+l.left-l.width-30+"px"):t.style.left=a+f.left+"px",void 0!==n?(t.style.top="unset",t.style.bottom=n+"px"):(t.style.bottom="unset",t.style.top=c+f.top+"px"),s&&(t.style.width=s+"px",t.style.setProperty("--mgt-flyout-set-width",s+"px"),window.requestAnimationFrame(()=>this.updateFlyout())),i?(t.style.maxHeight=i+"px",t.style.setProperty("--mgt-flyout-set-height",i+"px")):(t.style.maxHeight=null,t.style.setProperty("--mgt-flyout-set-height","unset"))}}setupWindowEvents(e){e&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}handleWindowEvent(e){const t=this._flyout;if(t)if(e.composedPath){const r=e.composedPath();if(r.includes(t)||"pointerdown"===e.type&&r.includes(this))return}else{let r=e.target;for(;r;)if(r=r.parentElement,r===t||"pointerdown"===e.type&&r===this)return}this.close()}handleResize(e){this.close()}handleKeyUp(e){"Escape"===e.key&&this.close()}handleFlyoutWheel(e){e.preventDefault()}};g([Object(o.f)({attribute:"light-dismiss",type:Boolean}),m("design:type",Boolean)],v.prototype,"isLightDismiss",void 0),g([Object(o.f)({attribute:null,type:Boolean}),m("design:type",Boolean)],v.prototype,"avoidHidingAnchor",void 0),g([Object(o.f)({attribute:"isOpen",type:Boolean}),m("design:type",Boolean),m("design:paramtypes",[Boolean])],v.prototype,"isOpen",null),v=g([Object(o.c)("mgt-flyout"),m("design:paramtypes",[])],v);var b=r("+pM/");const y=[o.b`
@charset "UTF-8";:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host([hidden]){display:none}:host{display:inline-block;font-family:var(--font-family,var(--default-font-family));vertical-align:top}:host .root{display:block}:host svg,mgt-person svg{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;color:var(--color,var(--color-sub1,#323130))}:host .person-root .user-avatar,mgt-person .person-root .user-avatar{position:relative;width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));display:flex;justify-content:center;align-items:center;flex-shrink:0;cursor:var(--avatar-cursor,default)}:host .person-root .user-avatar .user-presence,mgt-person .person-root .user-avatar .user-presence{margin:0;position:absolute;left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);top:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);border:2px solid var(--presence-background-color,var(--background-color,#fff));border-radius:50%}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#b4009e}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg{color:#b4009e;width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-basic,mgt-person .person-root .user-avatar .user-presence .presence-basic{width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);border-style:solid;border-width:2px;border-radius:50%;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);vertical-align:top;display:flex;align-items:center}:host .person-root .user-avatar .user-presence .presence-basic.presence-offline,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-offline{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#8a8886}:host .person-root .user-avatar .user-presence .presence-basic.presence-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-available{background-color:#6bb700;border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-available{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-away,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-away{background-color:#fa4;border-color:#fa4}:host .person-root .user-avatar .user-presence .presence-basic.presence-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-dnd{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-busy{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-offline::before,mgt-person .person-root .user-avatar .user-presence .presence-offline::before{content:"";color:#8a8886;font-weight:700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-available::before,mgt-person .person-root .user-avatar .user-presence .presence-available::before{content:"";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-available::before{content:"";color:#6bb700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-away::before,mgt-person .person-root .user-avatar .user-presence .presence-away::before{content:"";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-dnd::before{content:"";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-dnd::before{content:"";color:#c50f1f;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar.initials,mgt-person .person-root .user-avatar.initials{color:var(--initials-color,#fff);border-radius:var(--avatar-border-radius,50%);font-weight:400}:host .person-root .user-avatar.initials .contact-icon,:host .person-root .user-avatar.initials .initials-text,mgt-person .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .initials-text{cursor:var(--avatar-cursor,default);margin-top:-1px;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .4)}:host .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .contact-icon{display:inline}:host .person-root .user-avatar.small,mgt-person .person-root .user-avatar.small{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root .user-avatar.small .contact-icon,:host .person-root .user-avatar.small .initials-text,mgt-person .person-root .user-avatar.small .contact-icon,mgt-person .person-root .user-avatar.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}:host .person-root .user-avatar.small .user-presence,mgt-person .person-root .user-avatar.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}:host .person-root .user-avatar.small .user-presence .presence-basic,mgt-person .person-root .user-avatar.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}:host .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}:host .person-root .user-avatar.small .user-presence .presence-available::before,:host .person-root .user-avatar.small .user-presence .presence-away::before,:host .person-root .user-avatar.small .user-presence .presence-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-offline::before,:host .person-root .user-avatar.small .user-presence .presence-oof-available::before,:host .person-root .user-avatar.small .user-presence .presence-oof-away::before,:host .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-offline::before{content:''}:host .person-root .user-avatar .img-wrapper,mgt-person .person-root .user-avatar .img-wrapper{height:100%;width:100%;display:flex;overflow:hidden;border:var(--avatar-border,0);border-radius:var(--avatar-border-radius,50%);position:relative}:host .person-root .user-avatar .img-wrapper img,mgt-person .person-root .user-avatar .img-wrapper img{position:absolute;display:block;top:-100%;right:-100%;bottom:-100%;left:-100%;margin:auto;height:100%;width:auto}:host .person-root .user-avatar.pinkRed10,mgt-person .person-root .user-avatar.pinkRed10{background-color:var(--initials-background-color,#750b1c)}:host .person-root .user-avatar.red20,mgt-person .person-root .user-avatar.red20{background-color:var(--initials-background-color,#a4262c)}:host .person-root .user-avatar.red10,mgt-person .person-root .user-avatar.red10{background-color:var(--initials-background-color,#d13438)}:host .person-root .user-avatar.orange20,mgt-person .person-root .user-avatar.orange20{background-color:var(--initials-background-color,#ca5010)}:host .person-root .user-avatar.orangeYellow20,mgt-person .person-root .user-avatar.orangeYellow20{background-color:var(--initials-background-color,#986f0b)}:host .person-root .user-avatar.green10,mgt-person .person-root .user-avatar.green10{background-color:var(--initials-background-color,#498205)}:host .person-root .user-avatar.green20,mgt-person .person-root .user-avatar.green20{background-color:var(--initials-background-color,#0b6a0b)}:host .person-root .user-avatar.cyan20,mgt-person .person-root .user-avatar.cyan20{background-color:var(--initials-background-color,#038387)}:host .person-root .user-avatar.cyan30,mgt-person .person-root .user-avatar.cyan30{background-color:var(--initials-background-color,#005b70)}:host .person-root .user-avatar.cyanBlue10,mgt-person .person-root .user-avatar.cyanBlue10{background-color:var(--initials-background-color,#0078d4)}:host .person-root .user-avatar.cyanBlue20,mgt-person .person-root .user-avatar.cyanBlue20{background-color:var(--initials-background-color,#004e8c)}:host .person-root .user-avatar.blue10,mgt-person .person-root .user-avatar.blue10{background-color:var(--initials-background-color,#4f6bed)}:host .person-root .user-avatar.blueMagenta30,mgt-person .person-root .user-avatar.blueMagenta30{background-color:var(--initials-background-color,#5c2e91)}:host .person-root .user-avatar.blueMagenta20,mgt-person .person-root .user-avatar.blueMagenta20{background-color:var(--initials-background-color,#8764b8)}:host .person-root .user-avatar.magenta20,mgt-person .person-root .user-avatar.magenta20{background-color:var(--initials-background-color,#881798)}:host .person-root .user-avatar.magenta10,mgt-person .person-root .user-avatar.magenta10{background-color:var(--initials-background-color,#c239b3)}:host .person-root .user-avatar.magentaPink10,mgt-person .person-root .user-avatar.magentaPink10{background-color:var(--initials-background-color,#e3008c)}:host .person-root .user-avatar.orange30,mgt-person .person-root .user-avatar.orange30{background-color:var(--initials-background-color,#8e562e)}:host .person-root .user-avatar.gray30,mgt-person .person-root .user-avatar.gray30{background-color:var(--initials-background-color,#7a7574)}:host .person-root .user-avatar.gray20,mgt-person .person-root .user-avatar.gray20{background-color:var(--initials-background-color,#69797e)}:host .person-root .details,mgt-person .person-root .details{flex-shrink:1;display:flex;flex-direction:column;overflow:hidden;line-height:1.4;margin:var(--details-spacing,0 0 0 12px)}:host .person-root .details.small,mgt-person .person-root .details.small{margin:var(--details-spacing,0 0 0 6px)}:host .person-root .details>div,mgt-person .person-root .details>div{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}:host .person-root .details .line1,mgt-person .person-root .details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);text-transform:var(text-transform,none)}:host .person-root .details .line2,mgt-person .person-root .details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--email-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none))}:host .person-root .details .line3,mgt-person .person-root .details .line3{color:var(--line3-color,var(--color-sub2,#797775));font-size:var(--line3-font-size,var(--email-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none))}:host .avatar-icon,mgt-person .avatar-icon{display:flex;align-items:center;justify-content:center;line-height:1;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .5);width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));overflow:hidden;border-radius:var(--avatar-border-radius,50%)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,var(--avatar-size,24px));width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}[dir=rtl] .root{direction:rtl}[dir=rtl] svg{direction:rtl}[dir=rtl] .person-root .user-avatar{position:relative}[dir=rtl] .person-root .details{margin:var(--details-spacing,0 12px 0 0)}[dir=rtl] .person-root .details.small{margin:var(--details-spacing,0 6px 0 0)}[dir=rtl] .person-root .user-presence .presence-oof-offline svg{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-offline::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-away::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root.small .contact-icon,[dir=rtl] .person-root.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}[dir=rtl] .person-root.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}[dir=rtl] .person-root.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}[dir=rtl] .person-root.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}
`];var w,k,C,T=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},S=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){e[e.avatar=2]="avatar",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines"}(k||(k={})),function(e){e.photo="photo",e.initials="initials"}(C||(C={}));const _=["businessPhones","displayName","givenName","jobTitle","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id"];let I=w=class extends u.MgtTemplatedComponent{constructor(){super(),this.personCardInteraction=b.a.none,this.line1Property="displayName",this.line2Property="email",this.line3Property="jobTitle",this.view=d.a.image,this.avatarSize="auto",this._isInvalidImageSrc=!1,this._avatarType="photo"}static get styles(){return y}get personQuery(){return this._personQuery}set personQuery(e){e!==this._personQuery&&(this._personQuery=e,this.personDetails=null,this.requestStateUpdate())}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.personDetails||(e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="gray20",this.requestStateUpdate()))}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this.requestStateUpdate())}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="gray20",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetails"))}get personImage(){return this._personImage||this._fetchedImage}set personImage(e){if(e===this._personImage)return;this._isInvalidImageSrc=!e;const t=this._personImage;this._personImage=e,this.requestUpdate("personImage",t)}get avatarType(){return this._avatarType}set avatarType(e){e!==this._avatarType&&(this._avatarType=e,this.requestStateUpdate())}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(e){if(e===this._personPresence)return;const t=this._personPresence;this._personPresence=e,this.requestUpdate("personPresence",t)}static get requiredScopes(){const e=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return w.config.useContactApis&&e.push("contacts.read"),e}get flyout(){return this.renderRoot.querySelector(".flyout")}render(){if(this.isLoadingState&&!this.personDetails&&!this.fallbackDetails)return this.renderLoading();const e=this.personDetails||this.fallbackDetails,t=this.getImage(),r=this.personPresence||this._fetchedPresence;if(!e&&!t)return this.renderNoData();let n=this.renderTemplate("default",{person:e,personImage:t,personPresence:r});if(!n){const i=this.renderDetails(e),s=this.renderAvatar(e,t,r);n=o.d`
        <div class="person-root">
          ${s} ${i}
        </div>
      `}return this.personCardInteraction!==b.a.none&&(n=this.renderFlyout(n,e,t,r)),o.d`
      <div
        class="root"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
      >
        ${n}
      </div>
    `}renderLoading(){return this.renderTemplate("loading",null)||o.d``}clearState(){this._personImage="",this._personDetails=null,this._fetchedImage=null,this._fetchedPresence=null}renderNoData(){const e=this.renderTemplate("no-data",null);if(e)return e;const t={"avatar-icon":!0,"ms-Icon":!0,"ms-Icon--Contact":!0,small:!this.isLargeAvatar()};return o.d`
      <i class=${Object(n.a)(t)}></i>
    `}renderImage(e,t){const r=e&&this.personCardInteraction===b.a.none&&(e.displayName||Object(i.e)(e))||"";if(t&&!this._isInvalidImageSrc&&"photo"===this._avatarType)return o.d`
        <div class="img-wrapper">
          <img alt=${r} src=${t} @error=${()=>this._isInvalidImageSrc=!0} />
        </div>
      `;if(e){const t=this.getInitials(e);return o.d`
        <span class="initials-text" aria-label="${t}">
          ${t&&t.length?o.d`
                ${t}
              `:o.d`
                <i class="ms-Icon ms-Icon--Contact contact-icon"></i>
              `}
        </span>
      `}}renderPresence(e){if(!this.showPresence||!e)return o.d``;let t=null;switch(e.availability){case"DoNotDisturb":switch(e.activity){case"OutOfOffice":t="presence-oof-dnd";break;default:t="presence-dnd"}break;case"BeRightBack":t="presence-away";break;case"Available":switch(e.activity){case"Available":t="presence-available";break;case"OutOfOffice":t="presence-oof-available"}break;case"Busy":switch(e.activity){case"OutOfOffice":t="presence-oof-busy";break;default:t="presence-busy"}break;case"Away":switch(e.activity){case"Away":t="presence-away";break;case"OutOfOffice":t="presence-oof-offline"}break;case"Offline":switch(e.activity){case"Offline":t="presence-offline";break;case"OutOfOffice":t="presence-oof-offline";break;case"OffWork":t="presence-offline"}break;default:t="presence-offline"}const r={"ms-Icon":!0,"presence-basic":!0};r[t]=!0;let i=null;return i="presence-oof-offline"===t?o.d`
        <div class="ms-Icon presence-basic presence-oof-offline-wrapper">
          <i class="presence-oof-offline">
            ${Object(h.b)(h.a.SkypeArrow,"#666666")}
          </i>
        </div>
      `:o.d`
        <i class=${Object(n.a)(r)} aria-hidden="true"></i>
      `,o.d`
      <div class="user-presence" title=${e.activity} aria-label=${e.activity}>
        ${i}
      </div>
    `}renderAvatar(e,t,r){const s=e&&this.personCardInteraction===b.a.none&&(e.displayName||Object(i.e)(e))||"",a={initials:!t||this._isInvalidImageSrc||"initials"===this._avatarType,small:!this.isLargeAvatar(),"user-avatar":!0};t&&!this._isInvalidImageSrc&&"initials"!==this._avatarType||!e||(a[this._personAvatarBg]=!0);const c=this.renderImage(e,t),l=this.renderPresence(r);return o.d`
      <div class=${Object(n.a)(a)} title=${s} aria-label=${s}>
        ${c} ${l}
      </div>
    `}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetails)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetails)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetails)}renderDetails(e){if(!e||this.view===d.a.image||this.view===k.avatar)return o.d``;const t=[];if(this.view>d.a.image)if(this.hasTemplate("line1")){const r=this.renderTemplate("line1",{person:e});t.push(o.d`
          <div class="line1" @click=${()=>this.handleLine1Clicked()}>${r}</div>
        `)}else{const r=this.getTextFromProperty(e,this.line1Property);r&&t.push(o.d`
            <div class="line1" @click=${()=>this.handleLine1Clicked()} aria-label="${r}">${r}</div>
          `)}if(this.view>d.a.oneline)if(this.hasTemplate("line2")){const r=this.renderTemplate("line2",{person:e});t.push(o.d`
          <div class="line2" @click=${()=>this.handleLine2Clicked()}>${r}</div>
        `)}else{const r=this.getTextFromProperty(e,this.line2Property);r&&t.push(o.d`
            <div class="line2" @click=${()=>this.handleLine2Clicked()} aria-label="${r}">${r}</div>
          `)}if(this.view>d.a.twolines)if(this.hasTemplate("line3")){const r=this.renderTemplate("line3",{person:e});t.push(o.d`
          <div class="line3" @click=${()=>this.handleLine3Clicked()}>${r}</div>
        `)}else{const r=this.getTextFromProperty(e,this.line3Property);r&&t.push(o.d`
            <div class="line3" @click=${()=>this.handleLine3Clicked()} aria-label="${r}">${r}</div>
          `)}const r=Object(n.a)({details:!0,small:!this.isLargeAvatar()});return o.d`
      <div class="${r}">
        ${t}
      </div>
    `}renderFlyout(e,t,r,n){const i=this._personCardShouldRender?o.d`
          <div slot="flyout">
            ${this.renderFlyoutContent(t,r,n)}
          </div>
        `:o.d``;return o.d`
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${!1}>
        ${e} ${i}
      </mgt-flyout>
    `}renderFlyoutContent(e,t,r){return this.renderTemplate("person-card",{person:e,personImage:t})||o.d`
        <mgt-person-card
          .personDetails=${e}
          .personImage=${t}
          .personPresence=${r}
          .showPresence=${this.showPresence}
        ></mgt-person-card>
      `}loadState(){return e=this,void 0,r=function*(){const e=u.Providers.globalProvider;if(!e||e.state===u.ProviderState.Loading)return;if(e.state===u.ProviderState.SignedOut)return void(this.personDetails=null);const t=e.graph.forComponent(this);let r=[..._,this.line1Property,this.line2Property,this.line3Property];if(r=r.filter(e=>"email"!==e),this.personDetails){if(!this.personDetails.personImage&&this.fetchImage&&"photo"===this._avatarType&&!this.personImage&&!this._fetchedImage){const e=yield Object(s.b)(t,this.personDetails,w.config.useContactApis);e&&(this.personDetails.personImage=e,this._fetchedImage=e)}}else if(this.userId||"me"===this.personQuery){let e;e="photo"===this._avatarType?yield Object(c.a)(t,this.userId,r):"me"===this.personQuery?yield Object(l.d)(t,r):yield Object(l.e)(t,this.userId,r),this.personDetails=e,this._fetchedImage=this.getImage()}else if(this.personQuery){let e=yield Object(i.d)(t,this.personQuery,1);if(e&&0!==e.length||(e=(yield Object(l.b)(t,this.personQuery,1))||[]),e&&e.length&&(this.personDetails=e[0],"photo"===this._avatarType)){const r=yield Object(s.b)(t,e[0],w.config.useContactApis);r&&(this.personDetails.personImage=r,this._fetchedImage=r)}}const o={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(this.personDetails&&this.personDetails.id){const e="me"!==this.personQuery?this.personDetails.id:null;this._fetchedPresence=yield Object(a.a)(t,e)}else this._fetchedPresence=o}catch(e){this._fetchedPresence=o}},new((t=void 0)||(t=Promise))(function(o,n){function i(e){try{a(r.next(e))}catch(e){n(e)}}function s(e){try{a(r.throw(e))}catch(e){n(e)}}function a(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t(function(e){e(r)})).then(i,s)}a((r=r.apply(e,[])).next())});var e,t,r}getInitials(e){if(e||(e=this.personDetails),e.initials)return e.initials;let t="";if(e.givenName&&(t+=e.givenName[0].toUpperCase()),e.surname&&(t+=e.surname[0].toUpperCase()),!t&&e.displayName){const r=e.displayName.split(/\s+/);for(let e=0;e<2&&e<r.length;e++)r[e][0]&&this.isLetter(r[e][0])&&(t+=r[e][0].toUpperCase())}return t}getColorFromName(e){const t=e.split("").map(e=>e.charCodeAt(0)).join(""),r=["pinkRed10","red20","red10","orange20","orangeYellow20","green10","green20","cyan20","cyan30","cyanBlue10","cyanBlue20","blue10","blueMagenta30","blueMagenta20","magenta20","magenta10","magentaPink10","orange30","gray30","gray20"];return r[parseInt(t,10)%r.length]}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;const e=this.personDetails;return e&&e.personImage?e.personImage:null}isLetter(e){try{return e.match(new RegExp("\\p{L}","u"))}catch(t){return e.toLowerCase()!==e.toUpperCase()}}getTextFromProperty(e,t){if(!t||0===t.length)return null;const r=t.trim().split(",");let o,n=0;for(;!o&&n<r.length;){const t=r[n].trim();switch(t){case"mail":case"email":o=Object(i.e)(e);break;default:o=e[t]}n++}return o}isLargeAvatar(){return"large"===this.avatarSize||"auto"===this.avatarSize&&this.view>d.a.oneline}handleMouseClick(e){this.personCardInteraction===b.a.click&&this.showPersonCard()}handleMouseEnter(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===b.a.hover&&(this._mouseEnterTimeout=setTimeout(this.showPersonCard.bind(this),500))}handleMouseLeave(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=setTimeout(this.hidePersonCard.bind(this),500)}hidePersonCard(){const e=this.flyout;e&&e.close();const t=this.querySelector("mgt-person-card")||this.renderRoot.querySelector("mgt-person-card");t&&(t.isExpanded=!1,t.clearHistory())}showPersonCard(){this._personCardShouldRender||(this._personCardShouldRender=!0);const e=this.flyout;e&&e.open()}};I.config={useContactApis:!0},T([Object(o.f)({attribute:"person-query"}),S("design:type",String),S("design:paramtypes",[String])],I.prototype,"personQuery",null),T([Object(o.f)({attribute:"fallback-details",type:Object}),S("design:type",Object),S("design:paramtypes",[Object])],I.prototype,"fallbackDetails",null),T([Object(o.f)({attribute:"user-id"}),S("design:type",String),S("design:paramtypes",[String])],I.prototype,"userId",null),T([Object(o.f)({attribute:"show-presence",type:Boolean}),S("design:type",Boolean)],I.prototype,"showPresence",void 0),T([Object(o.f)({attribute:"avatar-size",type:String}),S("design:type",String)],I.prototype,"avatarSize",void 0),T([Object(o.f)({attribute:"person-details",type:Object}),S("design:type",Object),S("design:paramtypes",[Object])],I.prototype,"personDetails",null),T([Object(o.f)({attribute:"person-image",type:String}),S("design:type",String),S("design:paramtypes",[String])],I.prototype,"personImage",null),T([Object(o.f)({attribute:"fetch-image",type:Boolean}),S("design:type",Boolean)],I.prototype,"fetchImage",void 0),T([Object(o.f)({attribute:"avatar-type",converter:e=>"initials"===(e=e.toLowerCase())?C.initials:C.photo}),S("design:type",String),S("design:paramtypes",[String])],I.prototype,"avatarType",null),T([Object(o.f)({attribute:"person-presence",type:Object}),S("design:type",Object),S("design:paramtypes",[Object])],I.prototype,"personPresence",null),T([Object(o.f)({attribute:"person-card",converter:(e,t)=>(e=e.toLowerCase(),void 0===b.a[e]?b.a.none:b.a[e])}),S("design:type",Number)],I.prototype,"personCardInteraction",void 0),T([Object(o.f)({attribute:"line1-property"}),S("design:type",String)],I.prototype,"line1Property",void 0),T([Object(o.f)({attribute:"line2-property"}),S("design:type",String)],I.prototype,"line2Property",void 0),T([Object(o.f)({attribute:"line3-property"}),S("design:type",String)],I.prototype,"line3Property",void 0),T([Object(o.f)({converter:e=>e&&0!==e.length?(e=e.toLowerCase(),void 0===d.a[e]?d.a.image:d.a[e]):d.a.image}),S("design:type",Number)],I.prototype,"view",void 0),T([Object(o.e)(),S("design:type",String)],I.prototype,"_fetchedImage",void 0),T([Object(o.e)(),S("design:type",Object)],I.prototype,"_fetchedPresence",void 0),T([Object(o.e)(),S("design:type",Boolean)],I.prototype,"_isInvalidImageSrc",void 0),T([Object(o.e)(),S("design:type",Boolean)],I.prototype,"_personCardShouldRender",void 0),I=w=T([Object(o.c)("mgt-person"),S("design:paramtypes",[])],I)},d4nO:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var o=r("PL2B");class n{static get strings(){return this._strings}static set strings(e){this._strings=e,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){return document.body.getAttribute("dir")||document.documentElement.getAttribute("dir")}static onStringsUpdated(e){this._stringsEventDispatcher.add(e)}static removeOnStringsUpdated(e){this._stringsEventDispatcher.remove(e)}static onDirectionUpdated(e){this._directionEventDispatcher.add(e),this.initDirection()}static removeOnDirectionUpdated(e){this._directionEventDispatcher.remove(e)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver(e=>{e.forEach(e=>{"dir"==e.attributeName&&this._directionEventDispatcher.fire(null)})});const e={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,e),this.mutationObserver.observe(document.documentElement,e)}static updateStringsForTag(e,t){if((e=e.toLowerCase()).startsWith("mgt-")&&(e=e.substring(4)),this._strings&&t){for(let e of Object.entries(t))this._strings[e[0]]&&(t[e[0]]=this._strings[e[0]]);if(this._strings._components&&this._strings._components[e]){let r=this._strings._components[e];for(let e of Object.keys(r))t[e]&&(t[e]=r[e])}}return t}}n._stringsEventDispatcher=new o.a,n._directionEventDispatcher=new o.a,n._isDirectionInit=!1},ePoC:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return i});const o=new WeakMap,n=e=>(...t)=>{const r=e(...t);return o.set(r,!0),r},i=e=>"function"==typeof e&&o.has(e)},"fy+Q":function(e,t,r){"use strict";r.d(t,"a",function(){return o});const o=[r("hkiJ").b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}:host{background:var(--person-card-background-color,var(--background-color-sub1,#faf9f8));width:var(--mgt-flyout-set-width,340px);font-family:var(--default-font-family);overflow:hidden;user-select:none;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border:1px solid var(--background-color-sub1,#faf9f8)}:host .nav{height:0;position:relative;z-index:100}:host .nav .nav__back{padding:8px;height:32px;width:32px;align-items:center;justify-content:center}:host .nav .nav__back svg{fill:#0078d4}:host .nav .nav__back:hover{cursor:pointer}:host .nav .nav__back:hover svg{fill:#000}:host .person-details-container{display:flex;flex-direction:column;width:calc(var(--mgt-flyout-set-width,340px) - 40px);padding:20px}:host .person-details-container .person-image{--presence-background-color:var(--person-card-background-color, var(--background-color-sub1, #faf9f8));--presence-icon-color:var(--person-card-background-color, var(--background-color-sub1, #faf9f8));--avatar-size:75px;--font-size:var(--person-card-display-name-font-size, 20px);--color:var(--person-card-display-name-color, var(--color-sub1, #323130));--line2-font-size:var(--person-card-title-font-size, 14px);--line2-color:var(--person-card-title-color);--line3-font-size:var(--person-card-subtitle-font-size, 12px);--line3-color:var(--person-card-subtitle-color)}:host .person-details-container .base-icons{display:flex;-webkit-align-items:center;align-items:center;max-width:120px;margin-top:16px}:host .person-details-container .base-icons .icon{display:flex;align-items:center;cursor:pointer;font-size:12px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-right:20px}:host .person-details-container .base-icons .icon svg{fill:var(--icon-color,#605e5c)}:host .person-details-container .base-icons .icon span{margin-left:8px;color:#0078d4}:host .person-details-container .base-icons .icon:hover{color:#005a9e}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;align-items:center;height:28px;background:var(--person-card-background-color,var(--background-color-sub1,#faf9f8));border-top:1px solid var(--line-seperator-color,#edebe9)}:host .expanded-details-container .expanded-details-button .expanded-details-svg{margin-bottom:3px}:host .expanded-details-container .expanded-details-button:hover{background-color:var(--background-color--hover,#edebe9)}:host .expanded-details-container .expanded-details-info{padding:18px;display:flex;flex-direction:column}:host .expanded-details-container .expanded-details-info .contact-text{margin:0 0 24px 0;font-weight:600;font-size:var(--person-card-details-title-font-size,14px);color:var(--person-card-details-title-color,var(--color,#000))}:host .expanded-details-container .expanded-details-info .icons{line-height:normal;font-style:normal;font-weight:400;font-size:var(--person-card-details-item-font-size,15px);color:var(--person-card-details-item-color,#201f1e);text-align:left}:host .expanded-details-container .expanded-details-info .icons .details-icon{margin:0 0 10px 0;display:flex;flex-direction:row;align-items:center}:host .expanded-details-container .expanded-details-info .data{display:block;margin:0 0 0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:280px}:host .expanded-details-container .expanded-details-info .normal-subtitle{padding-top:2px}:host .expanded-details-container .expanded-details-info .link-subtitle{color:#0078d4;cursor:pointer}:host .expanded-details-container .expanded-details-info .link-subtitle:hover{opacity:.6}:host .expanded-details-container .section-divider{width:96%;min-height:1px;background:var(--line-seperator-color,#edebe9);align-self:center}:host .section-nav{display:flex;padding:0 14px;border-bottom:1px solid var(--tab-line-color,#edebe9)}:host .section-nav .section-nav__icon{all:initial;box-sizing:border-box;width:48px;padding:12px;display:flex;align-items:center;justify-content:center;border-bottom:2px solid transparent;margin-bottom:-1px;cursor:pointer}:host .section-nav .section-nav__icon svg{width:20px;height:20px;fill:var(--icon-color,#605e5c)}:host .section-nav .section-nav__icon:hover{background:var(--tab-background-color--hover,#edebe9);border-color:var(--tab-line-color--hover,#979593)}:host .section-nav .section-nav__icon.active{border-color:#0078d4}:host .section-nav .section-nav__icon.active svg{fill:#0078d4}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .section-host{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden}:host .quick-message{display:flex;flex-direction:row;border-bottom:1px solid var(--tab-line-color,#edebe9);padding:12px 10px 8px 10px}:host .quick-message .quick-message__input{flex-grow:1;padding-left:8px;border:none;border-radius:2px;color:var(--color-sub1,#323130);background-color:var(--background-color-sub2,#f3f2f1)}:host .quick-message .quick-message__send{all:initial;height:32px;width:32px;display:flex;align-items:center;justify-content:center}:host .quick-message .quick-message__send svg{fill:var(--color-sub2,#797775);height:18px;width:18px}:host .quick-message .quick-message__send:hover svg{fill:var(--color-sub1,#323130)}:host .sections .section{padding:14px 0;display:flex;flex-direction:column;position:relative}:host .sections .section:not(:last-child):after{position:absolute;content:'';width:90%;transform:translateX(-50%);border-bottom:1px solid var(--tab-line-color,#edebe9);left:50%;bottom:0}:host .sections .section .section__header{display:flex;flex-direction:row;padding:0 20px}:host .sections .section .section__title{flex-grow:1;color:var(--title-color-subtitle,#323130);font-size:14px;font-weight:600}:host .sections .section .section__show-more{color:#0078d4;font-size:12px;font-weight:600;align-self:center}:host .sections .section .section__show-more:hover{cursor:pointer;color:#005a9e}:host .sections .section .section__content{margin-top:14px}:host .sections .section .additional-details{padding:0 20px}[dir=rtl] .base-icons span{margin-right:8px}[dir=rtl] .nav__back{width:20px!important;-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}
`]},g1To:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var o=r("Vxif"),n=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};const i="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id";function s(e,t,r,s){return n(this,void 0,void 0,function*(){const a=t.id,c=Object(o.e)(t),l="classification"in t||"personType"in t&&("PersonalContact"===t.personType.subclass||"Group"===t.personType.class),d=e.createBatch();let u;l||s.sections.organization&&(function(e,t){const r=`manager($levels=max;$select=${i})`;e.get("person",`users/${t}?$expand=${r}&$select=${i}&$count=true`,["user.read.all"],{ConsistencyLevel:"eventual"}),e.get("directReports",`users/${t}/directReports?$select=${i}`)}(d,a),"boolean"!=typeof s.sections.organization&&s.sections.organization.showWorksWith&&function(e,t){e.get("people",`users/${t}/people?$filter=personType/class eq 'Person'`,["People.Read.All"])}(d,a)),s.sections.mailMessages&&c&&function(e,t){e.get("messages",`me/messages?$search="from:${t}"`,["Mail.ReadBasic"])}(d,c),s.sections.files&&function(e,t){let r;r=t?`me/insights/shared?$filter=lastshared/sharedby/address eq '${t}'`:"me/insights/used",e.get("files",r,["Sites.Read.All"])}(d,r?null:c);const h={};try{u=yield d.executeAll()}catch(e){}if(u)for(const[e,t]of u)h[e]=t.content.value||t.content;if(!l&&s.sections.profile)try{const t=yield function(e,t){return n(this,void 0,void 0,function*(){return yield e.api(`/users/${t}/profile`).version("beta").get()})}(e,a);t&&(h.profile=t)}catch(e){}return h})}},gHVf:function(e,t,r){"use strict";r.d(t,"a",function(){return o});const o="2.2.0"},ghBn:function(e,t,r){"use strict";r.d(t,"a",function(){return o});class o{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}},hkiJ:function(e,t,r){"use strict";r.d(t,"c",function(){return k}),r.d(t,"f",function(){return T}),r.d(t,"e",function(){return S}),r.d(t,"d",function(){return u.f}),r.d(t,"b",function(){return O}),r.d(t,"a",function(){return R});var o=r("2RF3"),n=r("SkKE");function i(e,t){const{element:{content:r},parts:o}=e,n=document.createTreeWalker(r,133,null,!1);let i=a(o),s=o[i],c=-1,l=0;const d=[];let u=null;for(;n.nextNode();){c++;const e=n.currentNode;for(e.previousSibling===u&&(u=null),t.has(e)&&(d.push(e),null===u&&(u=e)),null!==u&&l++;void 0!==s&&s.index===c;)s.index=null!==u?-1:s.index-l,i=a(o,i),s=o[i]}d.forEach(e=>e.parentNode.removeChild(e))}const s=e=>{let t=11===e.nodeType?0:1;const r=document.createTreeWalker(e,133,null,!1);for(;r.nextNode();)t++;return t},a=(e,t=-1)=>{for(let r=t+1;r<e.length;r++){const t=e[r];if(Object(n.d)(t))return r}return-1};var c=r("mgLx"),l=r("R8cf"),d=r("r6WH"),u=r("0i3K");const h=(e,t)=>`${e}--${t}`;let p=!0;void 0===window.ShadyCSS?p=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),p=!1);const f=e=>t=>{const r=h(t.type,e);let o=l.a.get(r);void 0===o&&(o={stringsArray:new WeakMap,keyString:new Map},l.a.set(r,o));let i=o.stringsArray.get(t.strings);if(void 0!==i)return i;const s=t.strings.join(n.f);if(i=o.keyString.get(s),void 0===i){const r=t.getTemplateElement();p&&window.ShadyCSS.prepareTemplateDom(r,e),i=new n.a(t,r),o.keyString.set(s,i)}return o.stringsArray.set(t.strings,i),i},g=["html","svg"],m=new Set;window.JSCompiler_renameProperty=(e,t)=>e;const v={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},b=(e,t)=>t!==e&&(t==t||e==e),y={attribute:!0,type:String,converter:v,reflect:!1,hasChanged:b};class w extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,r)=>{const o=this._attributeNameForProperty(r,t);void 0!==o&&(this._attributeToPropertyMap.set(o,r),e.push(o))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=y){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const r="symbol"==typeof e?Symbol():"__"+e,o=this.getPropertyDescriptor(e,r,t);void 0!==o&&Object.defineProperty(this.prototype,e,o)}static getPropertyDescriptor(e,t,r){return{get(){return this[t]},set(o){const n=this[e];this[t]=o,this.requestUpdateInternal(e,n,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||y}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const r of t)this.createProperty(r,e[r])}}static _attributeNameForProperty(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,r=b){return r(e,t)}static _propertyValueFromAttribute(e,t){const r=t.type,o=t.converter||v,n="function"==typeof o?o:o.fromAttribute;return n?n(e,r):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const r=t.type,o=t.converter;return(o&&o.toAttribute||v.toAttribute)(e,r)}initialize(){this._updateState=0,this._updatePromise=new Promise(e=>this._enableUpdatingResolver=e),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,r){t!==r&&this._attributeToProperty(e,r)}_propertyToAttribute(e,t,r=y){const o=this.constructor,n=o._attributeNameForProperty(e,r);if(void 0!==n){const e=o._propertyValueToAttribute(t,r);if(void 0===e)return;this._updateState=8|this._updateState,null==e?this.removeAttribute(n):this.setAttribute(n,e),this._updateState=-9&this._updateState}}_attributeToProperty(e,t){if(8&this._updateState)return;const r=this.constructor,o=r._attributeToPropertyMap.get(e);if(void 0!==o){const e=r.getPropertyOptions(o);this._updateState=16|this._updateState,this[o]=r._propertyValueFromAttribute(t,e),this._updateState=-17&this._updateState}}requestUpdateInternal(e,t,r){let o=!0;if(void 0!==e){const n=this.constructor;r=r||n.getPropertyOptions(e),n._valueHasChanged(this[e],t,r.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==r.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,r))):o=!1}!this._hasRequestedUpdate&&o&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this.requestUpdateInternal(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}w.finalized=!0;const k=e=>t=>"function"==typeof t?((e,t)=>(window.customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:r,elements:o}=t;return{kind:r,elements:o,finisher(t){window.customElements.define(e,t)}}})(e,t),C=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?Object.assign(Object.assign({},t),{finisher(r){r.createProperty(t.key,e)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(r){r.createProperty(t.key,e)}};function T(e){return(t,r)=>void 0!==r?((e,t,r)=>{t.constructor.createProperty(r,e)})(e,t,r):C(e,t)}function S(e){return T({attribute:!1,hasChanged:null==e?void 0:e.hasChanged})}const _=Element.prototype;_.msMatchesSelector||_.webkitMatchesSelector;const I=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,E=Symbol();class x{constructor(e,t){if(t!==E)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(I?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const O=(e,...t)=>{const r=t.reduce((t,r,o)=>t+(e=>{if(e instanceof x)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(r)+e[o+1],e[0]);return new x(r,E)};(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const A={};class R extends w{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const t=(e,r)=>e.reduceRight((e,r)=>Array.isArray(r)?t(r,e):(e.add(r),e),r),r=t(e,new Set),o=[];r.forEach(e=>o.unshift(e)),this._styles=o}else this._styles=void 0===e?[]:[e];this._styles=this._styles.map(e=>{if(e instanceof CSSStyleSheet&&!I){const t=Array.prototype.slice.call(e.cssRules).reduce((e,t)=>e+t.cssText,"");return new x(String(t),E)}return e})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?I?this.renderRoot.adoptedStyleSheets=e.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==A&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){return A}}R.finalized=!0,R.render=(e,t,r)=>{if(!r||"object"!=typeof r||!r.scopeName)throw new Error("The `scopeName` option is required.");const n=r.scopeName,u=c.a.has(t),v=p&&11===t.nodeType&&!!t.host,b=v&&!m.has(n),y=b?document.createDocumentFragment():t;if(Object(c.b)(e,y,Object.assign({templateFactory:f(n)},r)),b){const e=c.a.get(y);c.a.delete(y),((e,t,r)=>{m.add(e);const o=r?r.element:document.createElement("template"),n=t.querySelectorAll("style"),{length:c}=n;if(0===c)return void window.ShadyCSS.prepareTemplateStyles(o,e);const d=document.createElement("style");for(let e=0;e<c;e++){const t=n[e];t.parentNode.removeChild(t),d.textContent+=t.textContent}(e=>{g.forEach(t=>{const r=l.a.get(h(t,e));void 0!==r&&r.keyString.forEach(e=>{const{element:{content:t}}=e,r=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{r.add(e)}),i(e,r)})})})(e);const u=o.content;r?function(e,t,r=null){const{element:{content:o},parts:n}=e;if(null==r)return void o.appendChild(t);const i=document.createTreeWalker(o,133,null,!1);let c=a(n),l=0,d=-1;for(;i.nextNode();)for(d++,i.currentNode===r&&(l=s(t),r.parentNode.insertBefore(t,r));-1!==c&&n[c].index===d;){if(l>0){for(;-1!==c;)n[c].index+=l,c=a(n,c);return}c=a(n,c)}}(r,d,u.firstChild):u.insertBefore(d,u.firstChild),window.ShadyCSS.prepareTemplateStyles(o,e);const p=u.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==p)t.insertBefore(p.cloneNode(!0),t.firstChild);else if(r){u.insertBefore(d,u.firstChild);const e=new Set;e.add(d),i(r,e)}})(n,y,e.value instanceof d.a?e.value.template:void 0),Object(o.b)(t,t.firstChild),t.appendChild(y),c.a.set(t,e)}!u&&v&&window.ShadyCSS.styleElement(t.host)},R.shadowRootOptions={mode:"open"}},iNQq:function(e,t,r){"use strict";const o=[r("hkiJ").b`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--task-border:2px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:2px solid #797775;--task-complete-border:2px dotted #797775;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-background-color:#ffffff}.mgt-dark{--file-background-color:#424242}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242}
`],n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");;\n}\n")),document.head.appendChild(n);const i=document.createElement("style");i.innerHTML=o.toString(),document.head.appendChild(i)},jTv9:function(e,t,r){"use strict";r.d(t,"a",function(){return o});class o{static renderTemplate(e,t,r,o){let n;if(t.$parentTemplateContext&&(r=Object.assign(Object.assign({},r),{$parent:t.$parentTemplateContext})),t.content&&t.content.childNodes.length){const i=t.content.cloneNode(!0);n=this.renderNode(i,e,r,o)}else if(t.childNodes.length){const i=document.createElement("div");for(let e=0;e<t.childNodes.length;e++)i.appendChild(this.simpleCloneNode(t.childNodes[e]));n=this.renderNode(i,e,r,o)}n&&e.appendChild(n)}static setBindingSyntax(e,t){this._startExpression=e,this._endExpression=t;const r=this.escapeRegex(this._startExpression),o=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${r}\\s*([$\\w\\.()\\[\\]]+)\\s*${o}`,"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(e){if(!e)return null;const t=e.cloneNode(!1);for(let r=0;r<e.childNodes.length;r++){const o=this.simpleCloneNode(e.childNodes[r]);o&&t.appendChild(o)}return t}static expandExpressionsAsString(e,t,r){return e.replace(this.expression,(e,o)=>{const n=this.evalInContext(o||this.trimExpression(e),Object.assign(Object.assign({},t),r));return n?"object"==typeof n?JSON.stringify(n):n.toString():""})}static renderNode(e,t,r,o){if("#text"===e.nodeName)return e.textContent=this.expandExpressionsAsString(e.textContent,r,o),e;if("TEMPLATE"===e.nodeName)return e.$parentTemplateContext=r,e;let n=e;if(n.attributes)for(let e=0;e<n.attributes.length;e++){const i=n.attributes[e];if("data-props"===i.name){const e=this.trimExpression(i.value);for(const i of e.split(",")){const e=i.trim().split(":");if(2===e.length){const i=e[0].trim(),s=this.evalInContext(e[1].trim(),Object.assign(Object.assign({},r),o));i.startsWith("@")?"function"==typeof s&&n.addEventListener(i.substring(1),e=>s(e,r,t)):n[i]=s}}}else n.setAttribute(i.name,this.expandExpressionsAsString(i.value,r,o))}const i=[],s=[];let a=!1;for(let n=0;n<e.childNodes.length;n++){const c=e.childNodes[n],l=c;let d=!1;if(l.dataset){let e=!1;if(l.dataset.if){const t=l.dataset.if;this.evalBoolInContext(this.trimExpression(t),Object.assign(Object.assign({},r),o))?(l.removeAttribute("data-if"),a=!0,d=!0):(s.push(l),e=!0)}else void 0!==l.dataset.else&&(a?(s.push(l),e=!0):l.removeAttribute("data-else"));l.dataset.for&&!e?i.push(l):e||this.renderNode(c,t,r,o)}else this.renderNode(c,t,r,o);d||"#text"===c.nodeName||(a=!1)}for(const e of s)n.removeChild(e);for(let e=0;e<i.length;e++){const s=i[e],a=s.dataset.for,c=this.trimExpression(a).split(/\s+(in|of)\s+/i);if(3===c.length){const e=c[0],i=c[2],a=this.evalInContext(i,Object.assign(Object.assign({},r),o));if(Array.isArray(a)){s.removeAttribute("data-for");for(let i=0;i<a.length;i++){const c=Object.assign({$index:i},r);c[e]=a[i];const l=s.cloneNode(!0);this.renderNode(l,t,c,o),n.insertBefore(l,s)}}n.removeChild(s)}}return e}static evalBoolInContext(e,t){return t=Object.assign(Object.assign({},t),this.globalContext),new Function("with(this) { return !!("+e+")}").call(t)}static evalInContext(e,t){t=Object.assign(Object.assign({},t),this.globalContext);const r=new Function("with(this) { return "+e+";}");let o;try{o=r.call(t)}catch(e){}return o}static trimExpression(e){return(e=e.trim()).startsWith(this._startExpression)&&e.endsWith(this._endExpression)&&(e=(e=e.substr(this._startExpression.length,e.length-this._startExpression.length-this._endExpression.length)).trim()),e}}o._globalContext={}},jhrh:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"c",function(){return p.a}),r.d(t,"d",function(){return p.b}),r.d(t,"b",function(){return S});var o,n=r("hkiJ"),i=r("IVvM"),s=r("JpLj"),a=r("cmRh"),c=r("/vu6"),l=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};!function(e){e[e.any=0]="any",e[e.unified=1]="unified",e[e.security=2]="security",e[e.mailenabledsecurity=4]="mailenabledsecurity",e[e.distribution=8]="distribution"}(o||(o={}));const d=()=>a.CacheService.config.groups.invalidationPeriod||a.CacheService.config.defaultInvalidationPeriod,u=()=>a.CacheService.config.groups.isEnabled&&a.CacheService.config.isEnabled;function h(e,t,r=10,n=o.any){return l(this,void 0,void 0,function*(){let i;const s=t||"*"+n;if(u()){i=a.CacheService.getCache(c.a.groups,c.a.groups.stores.groupsQuery);const e=yield i.getValue(s);if(e&&d()>Date.now()-e.timeCached&&e.top>=r)return e.groups.map(e=>JSON.parse(e)).slice(0,r+1)}let l="";if(""!==t&&(l=`(startswith(displayName,'${t}') or startswith(mailNickname,'${t}') or startswith(mail,'${t}'))`),n!==o.any){const e=[];o.unified===(n&o.unified)&&e.push("groupTypes/any(c:c+eq+'Unified')"),o.security===(n&o.security)&&e.push("(mailEnabled eq false and securityEnabled eq true)"),o.mailenabledsecurity===(n&o.mailenabledsecurity)&&e.push("(mailEnabled eq true and securityEnabled eq true)"),o.distribution===(n&o.distribution)&&e.push("(mailEnabled eq true and securityEnabled eq false)"),l+=(""!==t?" and ":"")+e.join(" or ")}const h=yield e.api("groups").filter(l).top(r).middlewareOptions(Object(a.prepScopes)("Group.Read.All")).get();return u()&&h&&i.putValue(s,{groups:h.value.map(e=>JSON.stringify(e)),top:r}),h?h.value:null})}var p=r("Vxif"),f=r("sh+J"),g=r("LgXN"),m=(r("iNQq"),r("0Owk"),r("uHnN")),v=r("cy2K"),b=r("+pM/");const y=[n.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}:host{border-radius:2px;font-family:var(--default-font-family);height:38px;display:contents;height:100%;overflow:hidden}:host .root,mgt-people-picker .root{display:block}.people-picker{background-color:var(--input-background-color,#fff);border-top:var(--input-border-top,2px solid #605e5c);border-right:var(--input-border-right,2px solid #605e5c);border-bottom:var(--input-border-bottom,2px solid #605e5c);border-left:var(--input-border-left,2px solid #605e5c);border:var(--input-border,2px solid #605e5c);padding:6px 0 0}.people-picker:hover{border-color:var(--input-border-color--hover,#323130)}.people-picker.focused{border-color:var(--input-border-color--focus,#0078d4)}.people-picker.disabled{pointer-events:none}.people-picker .selected-list{flex:1 0 auto;display:flex;flex-wrap:wrap;vertical-align:middle;margin:0 8px;list-style-type:none;font-style:normal;font-weight:400;overflow:hidden}.people-picker .selected-list__person-wrapper{display:flex;margin:0 5px 6px 0;align-items:center;border-radius:15px;height:24px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;position:relative;background-color:var(--selected-person-background-color,#f3f2f1)}.people-picker .selected-list__person-wrapper__person{overflow:hidden;min-width:100%;--avatar-size-s:24px;margin-left:0;--color:var(--color-sub1, #323130);color:var(--color-sub1,#323130);padding-bottom:1px;padding-right:4px}.people-picker .selected-list__person-wrapper__overflow{margin-left:25px}.people-picker .selected-list__person-wrapper__overflow__gradient{content:'';position:absolute;margin-right:23px;width:10px;height:90%;top:0;right:0;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%)}.people-picker .selected-list__person-wrapper__overflow__close-icon{height:100%;top:0;margin-top:4px;margin-left:10px;position:absolute;line-height:normal;font-family:FabricMDL2Icons;padding-right:7px;cursor:pointer;right:0;background-color:var(--selected-person-background-color,#f3f2f1);color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .search-box{margin:1px 2px 8px}.people-picker .selected-list .flyout .search-box.search-box-start{line-height:normal;margin-inline-start:0;margin-inline-end:0}.people-picker .selected-list .flyout .search-box__input{box-sizing:border-box;border-width:0;border-style:none;width:100%;display:flex;flex:1 0 auto;font-family:var(--default-font-family);position:relative;line-height:normal;outline:0;font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:var(--input-background-color,#fff);color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .search-box__input::placeholder{color:var(--placeholder-color,#605e5c)}.people-picker .selected-list .flyout .flyout-root{padding:0;border-radius:2px;min-width:260px;overflow-y:auto;text-align:left;list-style-type:none;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));max-height:var(--mgt-flyout-set-height,unset)}.people-picker .selected-list .flyout .flyout-root li{cursor:pointer}.people-picker .selected-list .flyout .flyout-root .people-list .list-person{display:flex;flex-direction:row;align-items:center;padding:12px;font-style:normal;font-weight:600;font-size:14px}.people-picker .selected-list .flyout .flyout-root .people-list .list-person.focused,.people-picker .selected-list .flyout .flyout-root .people-list .list-person:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area{margin-left:13px;flex:1 1 0;max-height:40px;overflow:hidden;color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text{font-size:14px;font-weight:400;margin:0;padding:0}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text.highlight-search-text{font-weight:700}mgt-person{--avatar-size-s:32px;margin-left:12px;cursor:default}:host .loading-text,:host .search-error-text,mgt-people-picker .loading-text,mgt-people-picker .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;margin-left:50px;margin-right:50px;color:#0078d4}:host .message-parent,mgt-people-picker .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-weight:400;font-size:12px}:host .people-person-job-title.uppercase,mgt-people-picker .people-person-job-title.uppercase{text-transform:uppercase}mgt-flyout{flex:1 0 auto}[dir=rtl] mgt-person{margin:0 12px 0 0}[dir=rtl] .selected-list{margin-right:8px!important}[dir=rtl] .selected-list__person-wrapper{margin-left:6px!important}[dir=rtl] .selected-list__person-wrapper__person{margin-right:0!important;margin-left:4px!important}[dir=rtl] .selected-list__person-wrapper__overflow__gradient{right:auto!important;position:absolute!important;margin-right:0!important;width:10px!important;height:90%;top:0}[dir=rtl] .selected-list__person-wrapper__overflow__close-icon{right:auto!important;margin-left:5px!important;left:0!important}[dir=rtl] .people-person-text-area{margin-right:13px;margin-left:0!important}[dir=rtl] .flyout-root{text-align:right!important}
`],w={inputPlaceholderText:"Start typing a name",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading..."};var k=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},C=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},T=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};let S=class extends a.MgtTemplatedComponent{constructor(){super(),this._type=p.a.person,this._groupType=o.any,this._userType=p.b.any,this._arrowSelectionCount=0,this._isFocused=!1,this.clearState(),this._showLoading=!0,this.showMax=6,this.disabled=!1,this.allowAnyEmail=!1}static get styles(){return y}get strings(){return w}get flyout(){return this.renderRoot.querySelector(".flyout")}get input(){return this.renderRoot.querySelector(".search-box__input")}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get type(){return this._type}set type(e){this._type!==e&&(this._type=e,this.requestStateUpdate(!0))}get groupType(){return this._groupType}set groupType(e){this._groupType!==e&&(this._groupType=e,this.requestStateUpdate(!0))}get userType(){return this._userType}set userType(e){this._userType!==e&&(this._userType=e,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set(["user.read.all","people.read","group.read.all","user.readbasic.all",...v.a.requiredScopes])]}focus(e){this.gainedFocus(),this.input&&(this.input.focus(e),this.input.select())}selectUsersById(e){return T(this,void 0,void 0,function*(){const t=a.Providers.globalProvider,r=a.Providers.globalProvider.graph;if(t&&t.state===a.ProviderState.SignedIn)for(const t in e)try{const o=yield Object(f.e)(r,e[t]);this.addPerson(o)}catch(e){}})}render(){const e=this.renderTemplate("default",{people:this._foundPeople});if(e)return e;const t=this.renderSelectedPeople(this.selectedPeople),r=this.renderInput(),o=this.renderFlyout(r),s={focused:this._isFocused,"people-picker":!0,disabled:this.disabled};return n.d`
      <div dir=${this.direction} class=${Object(i.a)(s)} @click=${e=>this.focus(e)}>
        <div class="selected-list">
          ${t} ${o}
        </div>
      </div>
    `}clearState(){this._groupId=null,this.selectedPeople=[],this.userInput=""}requestStateUpdate(e){return e&&(this._groupPeople=null,this._foundPeople=null,this.selectedPeople=[]),super.requestStateUpdate(e)}renderInput(){const e=!!this.selectedPeople.length,t=this.disabled?this.placeholder||"":this.placeholder?this.placeholder:this.strings.inputPlaceholderText,r={"search-box":!0,"search-box-start":e};return"single"===(this.selectionMode?this.selectionMode:"multiple")&&this.selectedPeople.length>=1?(this.lostFocus(),null):n.d`
      <div class="${Object(i.a)(r)}">
        <input
          id="people-picker-input"
          class="search-box__input"
          type="text"
          placeholder=${t}
          label="people-picker-input"
          aria-label="people-picker-input"
          role="input"
          @keydown="${this.onUserKeyDown}"
          @keyup="${this.onUserKeyUp}"
          @blur=${this.lostFocus}
          @click=${this.handleFlyout}
          ?disabled=${this.disabled}
        />
      </div>
    `}renderSelectedPeople(e){return e=e||this.selectedPeople,this.selectedPeople&&this.selectedPeople.length?n.d`
      ${e.slice(0,e.length).map(e=>n.d`
            <div class="selected-list__person-wrapper">
              ${this.renderTemplate("selected-person",{person:e},"selected-"+(e.id?e.id:e.displayName))||this.renderSelectedPerson(e)}

              <div class="selected-list__person-wrapper__overflow">
                <div class="selected-list__person-wrapper__overflow__gradient"></div>
                <div
                  class="selected-list__person-wrapper__overflow__close-icon"
                  @click="${t=>this.removePerson(e,t)}"
                >
                  \uE711
                </div>
              </div>
            </div>
          `)}
    `:null}renderFlyout(e){return n.d`
      <mgt-flyout light-dismiss class="flyout">
        ${e}
        <div slot="flyout" class="flyout-root" @wheel=${e=>this.handleSectionScroll(e)}>
          ${this.renderFlyoutContent()}
        </div>
      </mgt-flyout>
    `}renderFlyoutContent(){if(this.isLoadingState||this._showLoading)return this.renderLoading();let e=this._foundPeople;if(!e||0===e.length||0===this.showMax)return this.renderNoData();for(const t of e)t.isFocused=!1;return e=e.slice(0,this.showMax),e[0].isFocused=!0,this.renderSearchResults(e)}renderLoading(){return this.renderTemplate("loading",null)||n.d`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}renderNoData(){if(this._isFocused)return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||n.d`
        <div class="message-parent">
          <div label="search-error-text" aria-label="We didn't find any matches." class="search-error-text">
            ${this.strings.noResultsFound}
          </div>
        </div>
      `}renderSearchResults(e){return e=e||this._foundPeople,n.d`
      <div class="people-list">
        ${Object(s.a)(e,e=>e.id,e=>{const t={focused:e.isFocused,"list-person":!0};return n.d`
              <li class="${Object(i.a)(t)}" @click="${t=>this.onPersonClick(e)}">
                ${this.renderPersonResult(e)}
              </li>
            `})}
      </div>
    `}renderPersonResult(e){const t=e,r=t.jobTitle||t.mail,o={"people-person-job-title":!0,uppercase:!!t.jobTitle};return this.renderTemplate("person",{person:e},e.id)||n.d`
        <mgt-person .personDetails=${e} .fetchImage=${!0}></mgt-person>
        <div class="people-person-text-area" id="${e.displayName}">
          ${this.renderHighlightText(e)}
          <span class="${Object(i.a)(o)}">${r}</span>
        </div>
      `}renderSelectedPerson(e){return n.d`
      <mgt-person
        class="selected-list__person-wrapper__person"
        .personDetails=${e}
        .fetchImage=${!0}
        .view=${g.a.oneline}
        .personCardInteraction=${b.a.click}
      ></mgt-person>
    `}loadState(){return T(this,void 0,void 0,function*(){let e=this.people;const t=this.userInput.toLowerCase(),r=a.Providers.globalProvider;if(!e&&r&&r.state===a.ProviderState.SignedIn){const o=r.graph.forComponent(this);if(!t.length&&this._isFocused)if(this.defaultPeople)e=this.defaultPeople;else{if(this.groupId){if(null===this._groupPeople)try{this._groupPeople=yield Object(f.a)(o,null,this.groupId,this.showMax,this.type,this.transitiveSearch)}catch(e){this._groupPeople=[]}e=this._groupPeople||[]}else this.type===p.a.person||this.type===p.a.any?e=yield Object(p.f)(o,this.userType):this.type===p.a.group&&(e=(yield h(o,"",this.showMax,this.groupType))||[]);this.defaultPeople=e}if(this._showLoading=!1,!this.defaultSelectedUserIds&&!this.defaultSelectedGroupIds||this.selectedPeople.length||this.defaultSelectedUsers||(this.defaultSelectedUsers=yield Object(f.h)(o,this.defaultSelectedUserIds),this.defaultSelectedGroups=yield function(e,t){return l(this,void 0,void 0,function*(){if(!t||0===t.length)return[];const r=e.createBatch(),o={},n=[];let i;u()&&(i=a.CacheService.getCache(c.a.groups,c.a.groups.stores.groups));for(const e of t){o[e]=null;let t=null;u()&&(t=yield i.getValue(e)),t&&d()>Date.now()-t.timeCached?o[e]=t.group?JSON.parse(t.group):null:""!==e&&(r.get(e,"/groups/"+e,["Group.Read.All"]),n.push(e))}try{const e=yield r.executeAll();for(const r of t){const t=e.get(r);t&&t.content&&(o[r]=t.content,u()&&i.putValue(r,{group:JSON.stringify(t.content)}))}return Promise.all(Object.values(o))}catch(r){try{return t.filter(e=>n.includes(e)).forEach(t=>o[t]=function(e,t,r){return l(this,void 0,void 0,function*(){let r;if(u()){r=a.CacheService.getCache(c.a.groups,c.a.groups.stores.groups);const e=yield r.getValue(t);if(e&&d()>Date.now()-e.timeCached){const t=e.group?JSON.parse(e.group):null,r=null;if(!r||r.length<=1)return t}}let o="/groups/"+t;const n=yield e.api(o).middlewareOptions(Object(a.prepScopes)("Group.Read.All")).get();return u()&&r.putValue(t,{group:JSON.stringify(n)}),n})}(e,t)),u()&&t.filter(e=>n.includes(e)).forEach(e=>l(this,void 0,void 0,function*(){return i.putValue(e,{group:JSON.stringify(yield o[e])})})),Promise.all(Object.values(o))}catch(e){return[]}}})}(o,this.defaultSelectedGroupIds),this.selectedPeople=[...this.defaultSelectedUsers,...this.defaultSelectedGroups],this.requestUpdate(),this.fireCustomEvent("selectionChanged",this.selectedPeople)),t)if(e=[],this.groupId)e=(yield Object(f.a)(o,t,this.groupId,this.showMax,this.type,this.transitiveSearch))||[];else{if(this.type===p.a.person||this.type===p.a.any){try{e=(yield Object(p.d)(o,t,this.showMax,this.userType))||[]}catch(e){}if(e.length<this.showMax&&this.userType!==p.b.contact)try{const r=(yield Object(f.b)(o,t,this.showMax))||[],n=new Set(e.map(e=>e.id));for(const t of r)n.has(t.id)||e.push(t)}catch(e){}}if((this.type===p.a.group||this.type===p.a.any)&&e.length<this.showMax){let r=[];try{r=(yield h(o,t,this.showMax,this.groupType))||[],e=e.concat(r)}catch(e){}}}}this._foundPeople=this.filterPeople(e)})}hideFlyout(){const e=this.flyout;e&&e.close()}showFlyout(){const e=this.flyout;e&&e.open()}removePerson(e,t){t.stopPropagation();const r=this.selectedPeople.filter(t=>!e.id&&t.displayName?t.displayName!==e.displayName:t.id!==e.id);this.selectedPeople=r,this.loadState(),this.fireCustomEvent("selectionChanged",this.selectedPeople)}addPerson(e){e&&(this.clearInput(),0===this.selectedPeople.filter(t=>!e.id&&t.displayName?t.displayName===e.displayName:t.id===e.id).length&&(this.selectedPeople=[...this.selectedPeople,e],this.fireCustomEvent("selectionChanged",this.selectedPeople),this.loadState(),this._foundPeople=[]))}clearInput(){this.input.value="",this.userInput=""}handleFlyout(){const e=this.filterPeople(this.defaultPeople);let t=!0;e&&0===e.length&&(t=!1),t&&window.requestAnimationFrame(()=>{this.showFlyout()})}gainedFocus(){this._isFocused=!0,this.input&&this.input.focus(),this._showLoading=!0,this.loadState()}lostFocus(){this._isFocused=!1,this.requestUpdate()}renderHighlightText(e){let t="",r="",o="";const i=e.displayName,s=i.toLowerCase().indexOf(this.userInput.toLowerCase());if(-1!==s){const e=this.userInput.length;0===s?(t="",o=i.slice(0,e),r=i.slice(e,i.length)):s===i.length?(t=i.slice(0,s),o=i.slice(s,i.length),r=""):(t=i.slice(0,s),o=i.slice(s,s+e),r=i.slice(s+e,i.length))}else t=e.displayName;return n.d`
      <div>
        <span class="people-person-text">${t}</span
        ><span class="people-person-text highlight-search-text">${o}</span
        ><span class="people-person-text">${r}</span>
      </div>
    `}onUserKeyUp(e){if(40===e.keyCode||39===e.keyCode||38===e.keyCode||37===e.keyCode)return;"Tab"!==e.code||this.flyout.isOpen||this.allowAnyEmail&&this.gainedFocus(),e.shiftKey&&this.gainedFocus();const t=e.target;if("Escape"===e.code)this.clearInput(),this._foundPeople=[];else if("Backspace"===e.code&&0===this.userInput.length&&this.selectedPeople.length>0)this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout(),this.fireCustomEvent("selectionChanged",this.selectedPeople);else{if("Comma"===e.code||"Semicolon"===e.code)return void(this.allowAnyEmail&&(e.preventDefault(),e.stopPropagation()));this.userInput=t.value,Object(m.h)(this.userInput)||this.handleUserSearch()}}handleAnyEmail(){if(this._showLoading=!1,this._arrowSelectionCount=0,Object(m.h)(this.userInput)){const e={mail:this.userInput,displayName:this.userInput};this.addPerson(e)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}onPersonClick(e){this.addPerson(e),this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0,this.hideFlyout(),this.selectionMode)}handleUserSearch(){this._debouncedSearch||(this._debouncedSearch=Object(m.b)(()=>T(this,void 0,void 0,function*(){const e=setTimeout(()=>{this._showLoading=!0},50);yield this.loadState(),clearTimeout(e),this._showLoading=!1,this.showFlyout(),this._arrowSelectionCount=0}),400)),this._debouncedSearch()}onUserKeyDown(e){if(!this.flyout.isOpen)return;40!==e.keyCode&&38!==e.keyCode||(this.handleArrowSelection(e),this.input.value.length>0&&e.preventDefault());const t=e.target;if("Tab"===e.code||"Enter"===e.code){if(!e.shiftKey&&this._foundPeople){e.preventDefault(),e.stopPropagation(),this._foundPeople.length&&this.fireCustomEvent("blur");const t=this._foundPeople[this._arrowSelectionCount];t?this.addPerson(t):this.allowAnyEmail&&this.handleAnyEmail()}this.hideFlyout(),e.target.value=""}else"Comma"!==e.code&&"Semicolon"!==e.code||this.allowAnyEmail&&(e.preventDefault(),e.stopPropagation(),this.userInput=t.value,this.handleAnyEmail())}handleArrowSelection(e){const t=this.renderRoot.querySelector(".people-list");if(t&&t.children.length){38===e.keyCode&&(this._arrowSelectionCount=(this._arrowSelectionCount-1+t.children.length)%t.children.length),40===e.keyCode&&(this._arrowSelectionCount=(this._arrowSelectionCount+1)%t.children.length);for(let e=0;e<t.children.length;e++)t.children[e].classList.remove("focused");const r=t.children[this._arrowSelectionCount];r&&(r.classList.add("focused"),r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}}filterPeople(e){if(e){const t=this.selectedPeople.map(e=>e.id?e.id:e.displayName);return e.filter(e=>e.id?-1===t.indexOf(e.id):-1===t.indexOf(e.displayName))}}handleSectionScroll(e){const t=this.renderRoot.querySelector(".flyout-root");t&&(e.deltaY<0&&0===t.scrollTop||e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1||e.stopPropagation())}};k([Object(n.f)({attribute:"group-id"}),C("design:type",String),C("design:paramtypes",[Object])],S.prototype,"groupId",null),k([Object(n.f)({attribute:"type",converter:(e,t)=>(e=e.toLowerCase())&&0!==e.length?void 0===p.a[e]?p.a.any:p.a[e]:p.a.any}),C("design:type",Object),C("design:paramtypes",[Object])],S.prototype,"type",null),k([Object(n.f)({attribute:"group-type",converter:(e,t)=>{if(!e||0===e.length)return o.any;const r=e.split(","),n=[];for(let e of r)e=e.trim(),void 0!==o[e]&&n.push(o[e]);return 0===n.length?o.any:n.reduce((e,t)=>e|t)}}),C("design:type",Number),C("design:paramtypes",[Object])],S.prototype,"groupType",null),k([Object(n.f)({attribute:"user-type",converter:(e,t)=>(e=e.toLowerCase())&&0!==e.length?void 0===p.b[e]?p.b.any:p.b[e]:p.b.any}),C("design:type",String),C("design:paramtypes",[Object])],S.prototype,"userType",null),k([Object(n.f)({attribute:"transitive-search",type:Boolean}),C("design:type",Boolean)],S.prototype,"transitiveSearch",void 0),k([Object(n.f)({attribute:"people",type:Object}),C("design:type",Array)],S.prototype,"people",void 0),k([Object(n.f)({attribute:"show-max",type:Number}),C("design:type",Number)],S.prototype,"showMax",void 0),k([Object(n.f)({attribute:"selected-people",type:Array}),C("design:type",Array)],S.prototype,"selectedPeople",void 0),k([Object(n.f)({attribute:"default-selected-user-ids",converter:e=>e.split(",").map(e=>e.trim()),type:String}),C("design:type",Array)],S.prototype,"defaultSelectedUserIds",void 0),k([Object(n.f)({attribute:"default-selected-group-ids",converter:e=>e.split(",").map(e=>e.trim()),type:String}),C("design:type",Array)],S.prototype,"defaultSelectedGroupIds",void 0),k([Object(n.f)({attribute:"placeholder",type:String}),C("design:type",String)],S.prototype,"placeholder",void 0),k([Object(n.f)({attribute:"disabled",type:Boolean}),C("design:type",Boolean)],S.prototype,"disabled",void 0),k([Object(n.f)({attribute:"allow-any-email",type:Boolean}),C("design:type",Boolean)],S.prototype,"allowAnyEmail",void 0),k([Object(n.f)({attribute:"selection-mode",type:String}),C("design:type",String)],S.prototype,"selectionMode",void 0),k([Object(n.f)({attribute:!1}),C("design:type",Boolean)],S.prototype,"_showLoading",void 0),k([Object(n.e)(),C("design:type",Object)],S.prototype,"_isFocused",void 0),k([Object(n.e)(),C("design:type",Array)],S.prototype,"_foundPeople",void 0),S=k([Object(n.c)("mgt-people-picker"),C("design:paramtypes",[])],S)},"m4u+":function(e,t,r){"use strict";var o=r("hkiJ"),n=r("IVvM"),i=r("cmRh");const s=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host,mgt-arrow-options{position:relative;font-family:var(--default-font-family)}:host .ArrowIcon,mgt-arrow-options .ArrowIcon{font-family:FabricMDL2Icons;margin:0 0 0 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Header,mgt-arrow-options .Header{cursor:pointer}:host .Header:hover,mgt-arrow-options .Header:hover{color:var(--theme-primary-color)}:host .Menu,mgt-arrow-options .Menu{position:absolute;left:var(--arrow-options-left,0);box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap}:host .Menu.Open,mgt-arrow-options .Menu.Open{display:block}:host .MenuOption,mgt-arrow-options .MenuOption{padding:20px;cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;display:flex;align-items:center;justify-content:stretch;justify-items:stretch}:host .MenuOption:first,mgt-arrow-options .MenuOption:first{padding:12px 20px 20px 20px}:host .MenuOption:hover,mgt-arrow-options .MenuOption:hover{background-color:var(--background-color--hover,#edebe9)}:host .MenuOption:active,mgt-arrow-options .MenuOption:active{background-color:var(--background-color--active,#e1dfdd)}:host .MenuOptionCheck,mgt-arrow-options .MenuOptionCheck{font-family:FabricMDL2Icons;color:transparent;margin-right:10px}:host .MenuOptionCheck.CurrentValue,mgt-arrow-options .MenuOptionCheck.CurrentValue{color:#0078d4}
`];var a=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let l=class extends i.MgtBaseComponent{constructor(){super(),this.value="",this.options={},this._clickHandler=e=>this.open=!1}static get styles(){return s}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}onHeaderClick(e){Object.keys(this.options).length>1&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)}render(){return o.d`
      <span class="Header" @click=${e=>this.onHeaderClick(e)}>
        <span class="CurrentValue">${this.value}</span>
      </span>
      <div class=${Object(n.a)({Menu:!0,Open:this.open,Closed:!this.open})}>
        ${this.getMenuOptions()}
      </div>
    `}getMenuOptions(){const e=Object.keys(this.options),t=this.options;return e.map(e=>o.d`
        <div
          class="MenuOption"
          @click="${r=>{this.open=!1,t[e](r)}}"
        >
          <span class=${Object(n.a)({MenuOptionCheck:!0,CurrentValue:this.value===e})}>
            \uE73E
          </span>
          <span class="MenuOptionName">${e}</span>
        </div>
      `)}};a([Object(o.f)({type:Boolean}),c("design:type",Boolean)],l.prototype,"open",void 0),a([Object(o.f)({type:String}),c("design:type",String)],l.prototype,"value",void 0),a([Object(o.f)({type:Object}),c("design:type",Object)],l.prototype,"options",void 0),l=a([Object(o.c)("mgt-arrow-options"),c("design:paramtypes",[])],l)},mV2a:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return n}),r.d(t,"c",function(){return i});const o="v1.0",n="https://graph.microsoft.com/",i=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn"])},mgLx:function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"b",function(){return a});var o=r("2RF3"),n=r("voU4"),i=r("R8cf");const s=new WeakMap,a=(e,t,r)=>{let a=s.get(t);void 0===a&&(Object(o.b)(t,t.firstChild),s.set(t,a=new n.e(Object.assign({templateFactory:i.b},r))),a.appendInto(t)),a.setValue(e),a.commit()}},"nD1+":function(e,t,r){"use strict";r.d(t,"a",function(){return h});var o=r("hkiJ"),n=r("cmRh"),i=(r("iNQq"),r("uHnN"));r("cy2K");const s=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,var(--color-sub1,#323130))}:host .agenda>.group:first-child>.header,mgt-agenda .agenda>.group:first-child>.header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background-color,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px var(--box-shadow-color,rgba(0,0,0,.092)));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:125px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,var(--color,#000));font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,var(--color-sub1,#323130))}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location-icon svg,mgt-agenda .event-location-icon svg{height:12px}:host .event-location-icon svg path,mgt-agenda .event-location-icon svg path{stroke:var(--event-location-color,var(--color,#000))}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,var(--color,#000));margin:0 0 0 4px;line-height:17px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}[dir=rtl] .event-location{margin:0 4px 0 0}[dir=rtl] .event-time-container{direction:ltr;margin:18px 18px 18px 38px}[dir=rtl] .event-details-container{margin:14px 0 14px 18px}[dir=rtl] .event-details-container .event-subject{margin:0 0 0 18px}[dir=rtl] .event-details-container .event-location-container{margin:8px 0 0 18px}
`];var a=r("P7nI"),c=r("WcTu"),l=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};let h=class extends n.MgtTemplatedComponent{constructor(){super(),this._days=3,this.onResize=this.onResize.bind(this)}static get styles(){return s}get date(){return this._date}set date(e){this._date!==e&&(this._date=e,this.reloadState())}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.reloadState())}get days(){return this._days}set days(e){this._days!==e&&(this._days=e,this.reloadState())}get eventQuery(){return this._eventQuery}set eventQuery(e){this._eventQuery!==e&&(this._eventQuery=e,this.reloadState())}get preferredTimezone(){return this._preferredTimezone}set preferredTimezone(e){this._preferredTimezone!==e&&(this._preferredTimezone=e,this.reloadState())}static get requiredScopes(){return[...new Set(["calendars.read",...c.a.requiredScopes])]}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||0===this.events.length)return this.renderNoData();const e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events;return this.renderTemplate("default",{events:e})||(this._isNarrow=this.offsetWidth<600,o.d`
      <div dir=${this.direction} class="agenda${this._isNarrow?" narrow":""}${this.groupByDay?" grouped":""}">
        ${this.groupByDay?this.renderGroups(e):this.renderEvents(e)}
        ${this.isLoadingState?this.renderLoading():o.d``}
      </div>
    `)}reload(){return u(this,void 0,void 0,function*(){this.events=yield this.loadEvents()})}renderLoading(){return this.renderTemplate("loading",null)||o.d`
        <div class="event">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </div>
      `}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||o.d``}renderEvent(e){return o.d`
      <div class="event">
        <div class="event-time-container">
          <div class="event-time" aria-label="${this.getEventTimeString(e)}">${this.getEventTimeString(e)}</div>
        </div>
        <div class="event-details-container">
          ${this.renderTitle(e)} ${this.renderLocation(e)} ${this.renderAttendees(e)}
        </div>
        <div class="event-other-container">${this.renderOther(e)}</div>
      </div>
    `}renderHeader(e){return this.renderTemplate("header",{header:e},"header-"+e)||o.d`
        <div class="header" aria-label="${e}">${e}</div>
      `}renderTitle(e){return o.d`
      <div class="event-subject">${e.subject}</div>
    `}renderLocation(e){return e.location.displayName?o.d`
      <div class="event-location-container">
        <div class="event-location-icon">${Object(a.b)(a.a.OfficeLocation)}</div>
        <div class="event-location" aria-label="${e.location.displayName}">${e.location.displayName}</div>
      </div>
    `:null}renderAttendees(e){return e.attendees.length?o.d`
      <mgt-people
        class="event-attendees"
        .peopleQueries=${e.attendees.map(e=>e.emailAddress.address)}
      ></mgt-people>
    `:null}renderOther(e){return this.hasTemplate("event-other")?o.d`
          ${this.renderTemplate("event-other",{event:e},e.id+"-other")}
        `:null}renderGroups(e){const t={};return e.forEach(e=>{const r=this.getDateHeaderFromDateTimeString(e.start.dateTime);t[r]=t[r]||[],t[r].push(e)}),o.d`
      ${Object.keys(t).map(e=>o.d`
            <div class="group">${this.renderHeader(e)} ${this.renderEvents(t[e])}</div>
          `)}
    `}renderEvents(e){return o.d`
      <ul class="agenda-list">
        ${e.map(e=>o.d`
              <li @click=${()=>this.eventClicked(e)}>
                ${this.renderTemplate("event",{event:e},e.id)||this.renderEvent(e)}
              </li>
            `)}
      </ul>
    `}loadState(){return u(this,void 0,void 0,function*(){if(this.events)return;const e=yield this.loadEvents();e&&e.length>0&&(this.events=e)})}reloadState(){return u(this,void 0,void 0,function*(){this.events=null,this.requestStateUpdate(!0)})}onResize(){this._isNarrow=this.offsetWidth<600}eventClicked(e){this.fireCustomEvent("eventClick",{event:e})}getEventTimeString(e){if(e.isAllDay)return"ALL DAY";let t=e.start.dateTime;"UTC"===e.start.timeZone&&(t+="Z");let r=e.end.dateTime;return"UTC"===e.end.timeZone&&(r+="Z"),`${this.prettyPrintTimeFromDateTime(new Date(t))} - ${this.prettyPrintTimeFromDateTime(new Date(r))}`}loadEvents(){return u(this,void 0,void 0,function*(){const e=n.Providers.globalProvider;let t=[];if(e&&e.state===n.ProviderState.SignedIn){const r=e.graph.forComponent(this);if(this.eventQuery)try{const e=this.eventQuery.split("|");let o,i;e.length>1?(i=e[0].trim(),o=e[1].trim()):i=this.eventQuery;let s=yield r.api(i);o&&(s=s.middlewareOptions(Object(n.prepScopes)(o))),this.preferredTimezone&&(s=s.header("Prefer",`outlook.timezone="${this.preferredTimezone}"`));const a=yield s.get();a&&a.value&&(t=a.value)}catch(e){}else{const e=this.date?new Date(this.date):new Date;e.setHours(0,0,0,0);const o=new Date(e.getTime());o.setDate(e.getDate()+this.days);try{const i=yield function(e,t,r,o,i){let s;s=o?`groups/${o}/calendar`:"me",s+=`/calendarview?${"startdatetime="+t.toISOString()}&${"enddatetime="+r.toISOString()}`;let a=e.api(s).middlewareOptions(Object(n.prepScopes)("calendars.read")).orderby("start/dateTime");return i&&(a=a.header("Prefer",`outlook.timezone="${i}"`)),n.GraphPageIterator.create(e,a)}(r,e,o,this.groupId,this.preferredTimezone);if(i&&i.value)for(t=i.value;i.hasNext;)yield i.next(),t=i.value}catch(e){}}}return t})}prettyPrintTimeFromDateTime(e){this.preferredTimezone||e.setMinutes(e.getMinutes()-e.getTimezoneOffset());let t=e.getHours();const r=e.getMinutes(),o=t>=12?"PM":"AM";return t%=12,t=t||12,`${t}:${r<10?"0"+r:r} ${o}`}getDateHeaderFromDateTimeString(e){const t=new Date(e);t.setMinutes(t.getMinutes()-t.getTimezoneOffset());const r=t.getDay(),o=t.getMonth(),n=t.getDate(),s=t.getFullYear();return`${Object(i.d)(r)}, ${Object(i.e)(o)} ${n}, ${s}`}getEventDuration(e){let t=new Date(e.start.dateTime);const r=new Date(e.end.dateTime),o=new Date;let n="";o>t&&(t=o);const i=r.getTime()-t.getTime(),s=Math.round(i/6e4);if(s>1440||e.isAllDay)n=Math.ceil(s/1440)+"d";else if(s>60){n=Math.round(s/60)+"h";const e=s%60;e&&(n+=e+"m")}else n=s+"m";return n}};l([Object(o.f)({attribute:"date",type:String}),d("design:type",String),d("design:paramtypes",[Object])],h.prototype,"date",null),l([Object(o.f)({attribute:"group-id",type:String}),d("design:type",String),d("design:paramtypes",[Object])],h.prototype,"groupId",null),l([Object(o.f)({attribute:"days",type:Number}),d("design:type",Number),d("design:paramtypes",[Object])],h.prototype,"days",null),l([Object(o.f)({attribute:"event-query",type:String}),d("design:type",String),d("design:paramtypes",[Object])],h.prototype,"eventQuery",null),l([Object(o.f)({attribute:"events",type:Array}),d("design:type",Array)],h.prototype,"events",void 0),l([Object(o.f)({attribute:"show-max",type:Number}),d("design:type",Number)],h.prototype,"showMax",void 0),l([Object(o.f)({attribute:"group-by-day",type:Boolean}),d("design:type",Boolean)],h.prototype,"groupByDay",void 0),l([Object(o.f)({attribute:"preferred-timezone",type:String}),d("design:type",String),d("design:paramtypes",[Object])],h.prototype,"preferredTimezone",null),l([Object(o.f)({attribute:!1}),d("design:type",Boolean)],h.prototype,"_isNarrow",void 0),h=l([Object(o.c)("mgt-agenda"),d("design:paramtypes",[])],h)},o1Rx:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var o=r("tAiM");class n extends o.a{static fromGraph(e){const t=new n(e.client);return t.setComponent(e.componentName),t}constructor(e,t="beta"){super(e,t)}forComponent(e){const t=new n(this.client);return this.setComponent(e),t}}},o4Lv:function(e,t,r){"use strict";r.d(t,"e",function(){return d}),r.d(t,"a",function(){return u}),r.d(t,"c",function(){return h}),r.d(t,"b",function(){return g}),r.d(t,"d",function(){return m}),r.d(t,"f",function(){return v});var o=r("cmRh"),n=r("J0Kn"),i=r("uHnN"),s=r("/vu6"),a=r("Vxif"),c=r("sh+J"),l=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};const d=()=>o.CacheService.config.photos.invalidationPeriod||o.CacheService.config.defaultInvalidationPeriod,u=()=>o.CacheService.config.photos.isEnabled&&o.CacheService.config.isEnabled;function h(e,t,r){return l(this,void 0,void 0,function*(){try{const s=yield e.api(t+"/photo/$value").responseType(n.f.RAW).middlewareOptions(Object(o.prepScopes)(...r)).get();return 404===s.status?{eTag:null,photo:null}:s.ok?{eTag:s.headers.get("eTag"),photo:yield Object(i.a)(yield s.blob())}:null}catch(e){return null}})}function p(e,t){return l(this,void 0,void 0,function*(){let r,n;return u()&&(r=o.CacheService.getCache(s.a.photos,s.a.photos.stores.contacts),n=yield r.getValue(t),n&&d()>Date.now()-n.timeCached)?n.photo:(n=yield h(e,"me/contacts/"+t,["contacts.read"]),u()&&n&&r.putValue(t,n),n?n.photo:null)})}function f(e,t){return l(this,void 0,void 0,function*(){let r,n;if(u()){if(r=o.CacheService.getCache(s.a.photos,s.a.photos.stores.users),n=yield r.getValue(t),n&&d()>Date.now()-n.timeCached)return n.photo;if(n)try{const r=yield e.api(`users/${t}/photo`).get();r&&(r["@odata.mediaEtag"]!==n.eTag||null===r["@odata.mediaEtag"]&&null===r.eTag)&&(n=null)}catch(e){return null}}return n=n||(yield h(e,"users/"+t,["user.readbasic.all"])),u()&&n&&r.putValue(t,n),n?n.photo:null})}function g(e,t,r=!0){return l(this,void 0,void 0,function*(){if("personType"in t&&"OrganizationUser"!==t.personType.subclass){if("PersonalContact"===t.personType.subclass&&r){const r=Object(a.e)(t),o=yield Object(a.c)(e,r);if(o&&o.length&&o[0].id)return yield p(e,o[0].id)}return null}if(t.userPrincipalName||t.id){const r=t.userPrincipalName||t.id;return yield f(e,r)}if(t.id){const r=yield f(e,t.id);if(r)return r}const o=Object(a.e)(t);if(o){const t=yield Object(c.b)(e,o,1);if(t&&t.length)return yield f(e,t[0].id);if(r){const t=yield Object(a.c)(e,o);if(t&&t.length)return yield p(e,t[0].id)}}return null})}function m(e,t){return l(this,void 0,void 0,function*(){const r=o.CacheService.getCache(s.a.photos,t);return yield r.getValue(e)})}function v(e,t,r){return l(this,void 0,void 0,function*(){o.CacheService.getCache(s.a.photos,t).putValue(e,r)})}},pLaE:function(e,t,r){"use strict";r.d(t,"a",function(){return c}),r.d(t,"b",function(){return l});var o=r("cmRh"),n=r("/vu6"),i=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};const s=()=>o.CacheService.config.presence.invalidationPeriod||o.CacheService.config.defaultInvalidationPeriod,a=()=>o.CacheService.config.presence.isEnabled&&o.CacheService.config.isEnabled;function c(e,t){return i(this,void 0,void 0,function*(){let r;if(a()){r=o.CacheService.getCache(n.a.presence,n.a.presence.stores.presence);const e=yield r.getValue(t||"me");if(e&&s()>Date.now()-e.timeCached)return JSON.parse(e.presence)}const i=t?["presence.read.all"]:["presence.read"],c=t?`/users/${t}/presence`:"/me/presence",l=yield e.api(c).middlewareOptions(Object(o.prepScopes)(...i)).get();return a()&&r.putValue(t||"me",{presence:JSON.stringify(l)}),l})}function l(e,t){return i(this,void 0,void 0,function*(){if(!t||0===t.length)return{};const r={},i=[],l=["presence.read.all"];let d;a()&&(d=o.CacheService.getCache(n.a.presence,n.a.presence.stores.presence));for(const e of t)if(""!==e&&e.id){const t=e.id;let o;r[t]=null,a()&&(o=yield d.getValue(t)),a()&&o&&s()>Date.now()-(yield o).timeCached?r[t]=JSON.parse(o.presence):i.push(t)}try{if(i.length>0){const t=yield e.api("/communications/getPresencesByUserId").middlewareOptions(Object(o.prepScopes)(...l)).post({ids:i});for(const e of t.value)r[e.id]=e,a()&&d.putValue(e.id,{presence:JSON.stringify(e)})}return r}catch(o){try{const o=yield Promise.all(t.filter(e=>e&&e.id&&!r[e.id]&&"personType"in e&&"OrganizationUser"===e.personType.subclass).map(t=>c(e,t.id)));for(const e of o)r[e.id]=e;return r}catch(e){return null}}})}},pZb9:function(e,t,r){"use strict";r.d(t,"b",function(){return s}),r.d(t,"a",function(){return d});var o=r("cmRh"),n=r("zAh+"),i=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};class s extends n.b{constructor(e){super({clientId:e.clientId,loginType:o.LoginType.Redirect,options:e.msalOptions,scopes:e.scopes}),this._msalOptions=e.msalOptions,this._authPopupUrl=e.authPopupUrl,o.TeamsHelper.microsoftTeamsLib.initialize()}static get isAvailable(){return o.TeamsHelper.isAvailable}static get microsoftTeamsLib(){return o.TeamsHelper.microsoftTeamsLib}static set microsoftTeamsLib(e){o.TeamsHelper.microsoftTeamsLib=e}get name(){return"MgtTeamsProvider"}static handleAuth(){return i(this,void 0,void 0,function*(){const e=o.TeamsHelper.microsoftTeamsLib;if(!e)return void console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsProvider");e.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&e.authentication.notifySuccess();const t=new URL(window.location.href).searchParams.get("signout"),r=localStorage.getItem(this._localStorageParametersKey);let s;if(s=r?JSON.parse(r):{},!s.clientId)return void e.authentication.notifyFailure("no clientId provided");const a=s.scopes?s.scopes.split(","):null,c=s.options||{auth:{clientId:s.clientId}};c.system=c.system||{},c.system.loadFrameTimeout=1e4;const l=new n.b({clientId:s.clientId,options:c,scopes:a});if(l.userAgentApplication.urlContainsHash(window.location.hash))return;const d=()=>i(this,void 0,void 0,function*(){if(l.state===o.ProviderState.SignedOut){if(t)return void e.authentication.notifySuccess();sessionStorage.getItem(this._sessionStorageLoginInProgress)||(sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),l.login({loginHint:s.loginHint,scopes:a||l.scopes}))}else if(l.state===o.ProviderState.SignedIn){if(t)return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),void(yield l.logout());try{const t=yield l.getAccessTokenForScopes(...l.scopes);e.authentication.notifySuccess(t)}catch(t){e.authentication.notifyFailure(t)}}});l.onStateChanged(d),d()})}login(){return i(this,void 0,void 0,function*(){this.setState(o.ProviderState.Loading);const e=o.TeamsHelper.microsoftTeamsLib;return new Promise((t,r)=>{e.getContext(n=>{this.teamsContext=n;const i={clientId:this.clientId,loginHint:n.loginHint,options:this._msalOptions,scopes:this.scopes.join(",")};localStorage.setItem(s._localStorageParametersKey,JSON.stringify(i));const a=new URL(this._authPopupUrl,new URL(window.location.href));e.authentication.authenticate({failureCallback:e=>{this.setState(o.ProviderState.SignedOut),r()},successCallback:e=>{this.trySilentSignIn(),t()},url:a.href})})})})}logout(){return i(this,void 0,void 0,function*(){const e=o.TeamsHelper.microsoftTeamsLib;return new Promise((t,r)=>{e.getContext(o=>{this.teamsContext=o;const n=new URL(this._authPopupUrl,new URL(window.location.href));n.searchParams.append("signout","true"),e.authentication.authenticate({failureCallback:e=>{this.trySilentSignIn(),r()},successCallback:e=>{this.trySilentSignIn(),t()},url:n.href})})})})}getAccessToken(e){return i(this,void 0,void 0,function*(){if(!this.teamsContext&&o.TeamsHelper.microsoftTeamsLib){const e=o.TeamsHelper.microsoftTeamsLib;e.initialize(),this.teamsContext=yield e.getContext()}const t={scopes:e&&e.scopes||this.scopes};this.teamsContext&&this.teamsContext.loginHint&&(t.loginHint=this.teamsContext.loginHint);try{return(yield this.userAgentApplication.acquireTokenSilent(t)).accessToken}catch(e){if(this.requiresInteraction(e))return null;throw e}})}}s._localStorageParametersKey="msg-teamsprovider-auth-parameters",s._sessionStorageLoginInProgress="msg-teamsprovider-login-in-progress",s._sessionStorageLogoutInProgress="msg-teamsprovider-logout-in-progress";var a=r("hkiJ"),c=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let d=class extends o.MgtBaseProvider{constructor(){super(...arguments),this.clientId="",this.authPopupUrl=""}get isAvailable(){return s.isAvailable}initializeProvider(){if(this.clientId&&this.authPopupUrl){const e={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){const t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}if(this.authority){const t={auth:{authority:this.authority,clientId:this.clientId}};e.msalOptions=t}this.provider=new s(e),o.Providers.globalProvider=this.provider}}};c([Object(a.f)({attribute:"client-id",type:String}),l("design:type",Object)],d.prototype,"clientId",void 0),c([Object(a.f)({attribute:"auth-popup-url",type:String}),l("design:type",Object)],d.prototype,"authPopupUrl",void 0),c([Object(a.f)(),l("design:type",Object)],d.prototype,"authority",void 0),c([Object(a.f)({attribute:"scopes",type:String}),l("design:type",Object)],d.prototype,"scopes",void 0),d=c([Object(a.c)("mgt-teams-provider")],d)},r6WH:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var o=r("2RF3"),n=r("SkKE");class i{constructor(e,t,r){this.__parts=[],this.template=e,this.processor=t,this.options=r}update(e){let t=0;for(const r of this.__parts)void 0!==r&&r.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=o.a?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],r=this.template.parts,i=document.createTreeWalker(e,133,null,!1);let s,a=0,c=0,l=i.nextNode();for(;a<r.length;)if(s=r[a],Object(n.d)(s)){for(;c<s.index;)c++,"TEMPLATE"===l.nodeName&&(t.push(l),i.currentNode=l.content),null===(l=i.nextNode())&&(i.currentNode=t.pop(),l=i.nextNode());if("node"===s.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(l.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,s.name,s.strings,this.options));a++}else this.__parts.push(void 0),a++;return o.a&&(document.adoptNode(e),customElements.upgrade(e)),e}}},"sh+J":function(e,t,r){"use strict";r.d(t,"f",function(){return a}),r.d(t,"c",function(){return c}),r.d(t,"d",function(){return l}),r.d(t,"e",function(){return d}),r.d(t,"h",function(){return u}),r.d(t,"g",function(){return h}),r.d(t,"b",function(){return p}),r.d(t,"a",function(){return f});var o=r("cmRh"),n=r("Vxif"),i=r("/vu6"),s=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};const a=()=>o.CacheService.config.users.invalidationPeriod||o.CacheService.config.defaultInvalidationPeriod,c=()=>o.CacheService.config.users.isEnabled&&o.CacheService.config.isEnabled;function l(e,t){return s(this,void 0,void 0,function*(){let r;if(c()){r=o.CacheService.getCache(i.a.users,i.a.users.stores.users);const e=yield r.getValue("me");if(e&&a()>Date.now()-e.timeCached){const r=JSON.parse(e.user),o=t?t.filter(e=>!Object.keys(r).includes(e)):null;if(!o||o.length<=1)return r}}let n="me";t&&(n=n+"?$select="+t.toString());const s=e.api(n).middlewareOptions(Object(o.prepScopes)("user.read")).get();return c()&&r.putValue("me",{user:JSON.stringify(yield s)}),s})}function d(e,t,r){return s(this,void 0,void 0,function*(){let n;if(c()){n=o.CacheService.getCache(i.a.users,i.a.users.stores.users);const e=yield n.getValue(t);if(e&&a()>Date.now()-e.timeCached){const t=e.user?JSON.parse(e.user):null,o=r&&t?r.filter(e=>!Object.keys(t).includes(e)):null;if(!o||o.length<=1)return t}}let s="/users/"+t;r&&(s=s+"?$select="+r.toString());const l=yield e.api(s).middlewareOptions(Object(o.prepScopes)("user.readbasic.all")).get();return c()&&n.putValue(t,{user:JSON.stringify(l)}),l})}function u(e,t){return s(this,void 0,void 0,function*(){if(!t||0===t.length)return[];const r=e.createBatch(),n={},l=[];let u;c()&&(u=o.CacheService.getCache(i.a.users,i.a.users.stores.users));for(const e of t){n[e]=null;let t=null;c()&&(t=yield u.getValue(e)),t&&a()>Date.now()-t.timeCached?n[e]=t.user?JSON.parse(t.user):null:""!==e&&(r.get(e,"/users/"+e,["user.readbasic.all"]),l.push(e))}try{const e=yield r.executeAll();for(const r of t){const t=e.get(r);t&&t.content&&(n[r]=t.content,c()&&u.putValue(r,{user:JSON.stringify(t.content)}))}return Promise.all(Object.values(n))}catch(r){try{return t.filter(e=>l.includes(e)).forEach(t=>n[t]=d(e,t)),c()&&t.filter(e=>l.includes(e)).forEach(e=>s(this,void 0,void 0,function*(){return u.putValue(e,{user:JSON.stringify(yield n[e])})})),Promise.all(Object.values(n))}catch(e){return[]}}})}function h(e,t){return s(this,void 0,void 0,function*(){if(!t||0===t.length)return[];const r=e.createBatch(),l=[];let d,u;c()&&(u=o.CacheService.getCache(i.a.users,i.a.users.stores.usersQuery));for(const e of t)c()&&(d=yield u.getValue(e)),c()&&d&&a()>Date.now()-d.timeCached?l.push(JSON.parse(d.results[0])):""!==e&&r.get(e,`/me/people?$search="${e}"`,["people.read"]);try{const e=yield r.executeAll();for(const r of t){const t=e.get(r);t&&t.content&&t.content.value&&t.content.value.length>0&&(l.push(t.content.value[0]),c()&&u.putValue(r,{maxResults:1,results:[JSON.stringify(t.content.value[0])]}))}return l}catch(r){try{return Promise.all(t.filter(e=>e&&""!==e).map(t=>s(this,void 0,void 0,function*(){const r=yield Object(n.d)(e,t,1);if(r&&r.length)return c()&&u.putValue(t,{maxResults:1,results:[JSON.stringify(r[0])]}),r[0]})))}catch(e){return[]}}})}function p(e,t,r=10){return s(this,void 0,void 0,function*(){const n={maxResults:r,results:null};let s,l;if(c()){s=o.CacheService.getCache(i.a.users,i.a.users.stores.usersQuery);const e=yield s.getValue(t);if(e&&a()>Date.now()-e.timeCached)return e.results.map(e=>JSON.parse(e))}try{l=yield e.api("users").header("ConsistencyLevel","eventual").count(!0).search(`"displayName:${t}" OR "mail:${t}"`).top(r).middlewareOptions(Object(o.prepScopes)("User.ReadBasic.All")).get()}catch(e){}return c()&&l&&(n.results=l.value.map(e=>JSON.stringify(e)),s.putValue(t,n)),l?l.value:null})}function f(e,t,r,l=10,d=n.a.person,u=!1){return s(this,void 0,void 0,function*(){const s={maxResults:l,results:null};let h;const p=`${r||"*"}:${t||"*"}:${d}:${u}`;if(c()){h=o.CacheService.getCache(i.a.users,i.a.users.stores.usersQuery);const e=yield h.getValue(p);if(e&&a()>Date.now()-e.timeCached)return e.results.map(e=>JSON.parse(e))}let f="";t&&(f=`startswith(displayName,'${t}') or startswith(givenName,'${t}') or startswith(surname,'${t}') or startswith(mail,'${t}') or startswith(userPrincipalName,'${t}')`);let g=`/groups/${r}/${u?"transitiveMembers":"members"}`;d===n.a.person?g+="/microsoft.graph.user":d===n.a.group&&(g+="/microsoft.graph.group",t&&(f=`startswith(displayName,'${t}') or startswith(mail,'${t}')`));const m=yield e.api(g).count(!0).top(l).filter(f).header("ConsistencyLevel","eventual").middlewareOptions(Object(o.prepScopes)("user.read.all","people.read")).get();return c()&&m&&(s.results=m.value.map(e=>JSON.stringify(e)),h.putValue(p,s)),m?m.value:null})}},t0JB:function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"g",function(){return d}),r.d(t,"e",function(){return u}),r.d(t,"f",function(){return h}),r.d(t,"m",function(){return p}),r.d(t,"n",function(){return f}),r.d(t,"r",function(){return g}),r.d(t,"s",function(){return m}),r.d(t,"v",function(){return v}),r.d(t,"w",function(){return b}),r.d(t,"q",function(){return y}),r.d(t,"z",function(){return w}),r.d(t,"A",function(){return k}),r.d(t,"t",function(){return C}),r.d(t,"D",function(){return T}),r.d(t,"l",function(){return S}),r.d(t,"c",function(){return _}),r.d(t,"d",function(){return I}),r.d(t,"o",function(){return E}),r.d(t,"p",function(){return x}),r.d(t,"h",function(){return O}),r.d(t,"j",function(){return A}),r.d(t,"x",function(){return R}),r.d(t,"y",function(){return P}),r.d(t,"B",function(){return N}),r.d(t,"C",function(){return D}),r.d(t,"i",function(){return L}),r.d(t,"u",function(){return U}),r.d(t,"E",function(){return M}),r.d(t,"k",function(){return j}),r.d(t,"b",function(){return z});var o=r("cmRh"),n=r("/vu6"),i=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};function s(){let e;e=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists),e.clearStore()}const a=()=>o.CacheService.config.files.invalidationPeriod||o.CacheService.config.defaultInvalidationPeriod,c=()=>o.CacheService.config.files.isEnabled&&o.CacheService.config.isEnabled,l=()=>o.CacheService.config.fileLists.isEnabled&&o.CacheService.config.isEnabled;function d(e,t){return i(this,void 0,void 0,function*(){let r;r=o.CacheService.getCache(n.a.files,n.a.files.stores.fileQueries);const i=yield B(r,t);if(i)return i;let s;try{s=yield e.api(t).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&r.putValue(t,{file:JSON.stringify(s)})}catch(e){}return s||null})}function u(e,t,r){return i(this,void 0,void 0,function*(){const i=`/drives/${t}/items/${r}`;let s;s=o.CacheService.getCache(n.a.files,n.a.files.stores.driveFiles);const a=yield B(s,i);if(a)return a;let l;try{l=yield e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&s.putValue(i,{file:JSON.stringify(l)})}catch(e){}return l||null})}function h(e,t,r){return i(this,void 0,void 0,function*(){const i=`/drives/${t}/root:/${r}`;let s;s=o.CacheService.getCache(n.a.files,n.a.files.stores.driveFiles);const a=yield B(s,i);if(a)return a;let l;try{l=yield e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&s.putValue(i,{file:JSON.stringify(l)})}catch(e){}return l||null})}function p(e,t,r){return i(this,void 0,void 0,function*(){const i=`/groups/${t}/drive/items/${r}`;let s;s=o.CacheService.getCache(n.a.files,n.a.files.stores.groupFiles);const a=yield B(s,i);if(a)return a;let l;try{l=yield e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&s.putValue(i,{file:JSON.stringify(l)})}catch(e){}return l||null})}function f(e,t,r){return i(this,void 0,void 0,function*(){const i=`/groups/${t}/drive/root:/${r}`;let s;s=o.CacheService.getCache(n.a.files,n.a.files.stores.groupFiles);const a=yield B(s,i);if(a)return a;let l;try{l=yield e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&s.putValue(i,{file:JSON.stringify(l)})}catch(e){}return l||null})}function g(e,t){return i(this,void 0,void 0,function*(){const r="/me/drive/items/"+t;let i;i=o.CacheService.getCache(n.a.files,n.a.files.stores.userFiles);const s=yield B(i,r);if(s)return s;let a;try{a=yield e.api(r).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&i.putValue(r,{file:JSON.stringify(a)})}catch(e){}return a||null})}function m(e,t){return i(this,void 0,void 0,function*(){const r="/me/drive/root:/"+t;let i;i=o.CacheService.getCache(n.a.files,n.a.files.stores.userFiles);const s=yield B(i,r);if(s)return s;let a;try{a=yield e.api(r).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&i.putValue(r,{file:JSON.stringify(a)})}catch(e){}return a||null})}function v(e,t,r){return i(this,void 0,void 0,function*(){const i=`/sites/${t}/drive/items/${r}`;let s;s=o.CacheService.getCache(n.a.files,n.a.files.stores.siteFiles);const a=yield B(s,i);if(a)return a;let l;try{l=yield e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&s.putValue(i,{file:JSON.stringify(l)})}catch(e){}return l||null})}function b(e,t,r){return i(this,void 0,void 0,function*(){const i=`/sites/${t}/drive/root:/${r}`;let s;s=o.CacheService.getCache(n.a.files,n.a.files.stores.siteFiles);const a=yield B(s,i);if(a)return a;let l;try{l=yield e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&s.putValue(i,{file:JSON.stringify(l)})}catch(e){}return l||null})}function y(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/sites/${t}/lists/${r}/items/${s}/driveItem`;let a;a=o.CacheService.getCache(n.a.files,n.a.files.stores.siteFiles);const l=yield B(a,i);if(l)return l;let d;try{d=yield e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&a.putValue(i,{file:JSON.stringify(d)})}catch(e){}return d||null})}function w(e,t,r){return i(this,void 0,void 0,function*(){const i=`/users/${t}/drive/items/${r}`;let s;s=o.CacheService.getCache(n.a.files,n.a.files.stores.userFiles);const a=yield B(s,i);if(a)return a;let l;try{l=yield e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&s.putValue(i,{file:JSON.stringify(l)})}catch(e){}return l||null})}function k(e,t,r){return i(this,void 0,void 0,function*(){const i=`/users/${t}/drive/root:/${r}`;let s;s=o.CacheService.getCache(n.a.files,n.a.files.stores.userFiles);const a=yield B(s,i);if(a)return a;let l;try{l=yield e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")).get(),c()&&s.putValue(i,{file:JSON.stringify(l)})}catch(e){}return l||null})}function C(e,t,r){return i(this,void 0,void 0,function*(){const i=`/me/insights/${t}/${r}/resource`;let s;s=o.CacheService.getCache(n.a.files,n.a.files.stores.insightFiles);const a=yield B(s,i);if(a)return a;let l;try{l=yield e.api(i).middlewareOptions(Object(o.prepScopes)("sites.read.all")).get(),c()&&s.putValue(i,{file:JSON.stringify(l)})}catch(e){}return l||null})}function T(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/users/${t}/insights/${r}/${s}/resource`;let a;a=o.CacheService.getCache(n.a.files,n.a.files.stores.insightFiles);const l=yield B(a,i);if(l)return l;let d;try{d=yield e.api(i).middlewareOptions(Object(o.prepScopes)("sites.read.all")).get(),c()&&a.putValue(i,{file:JSON.stringify(d)})}catch(e){}return d||null})}function S(e,t){return i(this,void 0,void 0,function*(){const r="/me/drive/root/children";let i,s;s=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const a=yield $(s,r);if(a)return i=yield q(e,a.files,a.nextLink),i;let c;try{c=e.api(r).middlewareOptions(Object(o.prepScopes)("files.read")),t&&c.top(t),i=yield F(e,c),l()&&s.putValue(r,{files:i.value,nextLink:i._nextLink})}catch(e){}return i||null})}function _(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/drives/${t}/items/${r}/children`;let a,c;c=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const d=yield $(c,i);if(d)return a=yield q(e,d.files,d.nextLink),a;let u;try{u=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),s&&u.top(s),a=yield F(e,u),l()&&c.putValue(i,{files:a.value,nextLink:a._nextLink})}catch(e){}return a||null})}function I(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/drives/${t}/root:/${r}:/children`;let a,c;c=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const d=yield $(c,i);if(d)return a=yield q(e,d.files,d.nextLink),a;let u;try{u=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),s&&u.top(s),a=yield F(e,u),l()&&c.putValue(i,{files:a.value,nextLink:a._nextLink})}catch(e){}return a||null})}function E(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/groups/${t}/drive/items/${r}/children`;let a,c;c=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const d=yield $(c,i);if(d)return a=yield q(e,d.files,d.nextLink),a;let u;try{u=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),s&&u.top(s),a=yield F(e,u),l()&&c.putValue(i,{files:a.value,nextLink:a._nextLink})}catch(e){}return a||null})}function x(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/groups/${t}/drive/root:/${r}:/children`;let a,c;c=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const d=yield $(c,i);if(d)return a=yield q(e,d.files,d.nextLink),a;let u;try{u=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),s&&u.top(s),a=yield F(e,u),l()&&c.putValue(i,{files:a.value,nextLink:a._nextLink})}catch(e){}return a||null})}function O(e,t,r){return i(this,void 0,void 0,function*(){const i=`/me/drive/items/${t}/children`;let s,a;a=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const c=yield $(a,i);if(c)return s=yield q(e,c.files,c.nextLink),s;let d;try{d=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),r&&d.top(r),s=yield F(e,d),l()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null})}function A(e,t,r){return i(this,void 0,void 0,function*(){const i=`/me/drive/root:/${t}:/children`;let s,a;a=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const c=yield $(a,i);if(c)return s=yield q(e,c.files,c.nextLink),s;let d;try{d=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),r&&d.top(r),s=yield F(e,d),l()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null})}function R(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/sites/${t}/drive/items/${r}/children`;let a,c;c=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const d=yield $(c,i);if(d)return a=yield q(e,d.files,d.nextLink),a;let u;try{u=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),s&&u.top(s),a=yield F(e,u),l()&&c.putValue(i,{files:a.value,nextLink:a._nextLink})}catch(e){}return a||null})}function P(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/sites/${t}/drive/root:/${r}:/children`;let a,c;c=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const d=yield $(c,i);if(d)return a=yield q(e,d.files,d.nextLink),a;let u;try{u=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),s&&u.top(s),a=yield F(e,u),l()&&c.putValue(i,{files:a.value,nextLink:a._nextLink})}catch(e){}return a||null})}function N(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/users/${t}/drive/items/${r}/children`;let a,c;c=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const d=yield $(c,i);if(d)return a=yield q(e,d.files,d.nextLink),a;let u;try{u=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),s&&u.top(s),a=yield F(e,u),l()&&c.putValue(i,{files:a.value,nextLink:a._nextLink})}catch(e){}return a||null})}function D(e,t,r,s){return i(this,void 0,void 0,function*(){const i=`/users/${t}/drive/root:/${r}:/children`;let a,c;c=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const d=yield $(c,i);if(d)return a=yield q(e,d.files,d.nextLink),a;let u;try{u=e.api(i).middlewareOptions(Object(o.prepScopes)("files.read")),s&&u.top(s),a=yield F(e,u),l()&&c.putValue(i,{files:a.value,nextLink:a._nextLink})}catch(e){}return a||null})}function L(e,t,r){return i(this,void 0,void 0,function*(){let i,s;s=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const a=yield $(s,t);if(a)return i=yield q(e,a.files,a.nextLink),i;const c=["files.read","sites.read.all"];let d;try{d=yield e.api(t).middlewareOptions(Object(o.prepScopes)(...c)),r&&d.top(r),i=yield F(e,d),l()&&s.putValue(t,{files:i.value,nextLink:i._nextLink})}catch(e){}return i||null})}function U(e,t){return i(this,void 0,void 0,function*(){const r="/me/insights/"+t;let i;i=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.insightfileLists);const s=yield $(i,r);if(s)return s;const a=["sites.read.all"];let c;try{c=yield e.api(r).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(Object(o.prepScopes)(...a)).get()}catch(e){}const d=yield H(e,c,a);return l()&&i.putValue(r,{files:d}),d||null})}function M(e,t,r){return i(this,void 0,void 0,function*(){let i,s;"shared"===r?(i="/me/insights/shared",s=`((lastshared/sharedby/id eq '${t}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(i=`/users/${t}/insights/${r}`,s="resourceReference/type eq 'microsoft.graph.driveItem'");const a=`${i}?$filter=${s}`;let c;c=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.insightfileLists);const d=yield $(c,a);if(d)return d;const u=["sites.read.all"];let h;try{h=yield e.api(i).filter(s).middlewareOptions(Object(o.prepScopes)(...u)).get()}catch(e){}const p=yield H(e,h,u);return l()&&c.putValue(i,{files:p}),p||null})}function j(e,t){return i(this,void 0,void 0,function*(){if(!t||0===t.length)return[];const r=e.createBatch(),s=[],l=["files.read"];let u,h;c()&&(u=o.CacheService.getCache(n.a.files,n.a.files.stores.fileQueries));for(const e of t)c()&&(h=yield u.getValue(e)),c()&&h&&a()>Date.now()-h.timeCached?s.push(JSON.parse(h.file)):""!==e&&r.get(e,e,l);try{const e=yield r.executeAll();for(const r of t){const t=e.get(r);t&&t.content&&(s.push(t.content),c()&&u.putValue(r,{file:JSON.stringify(t.content)}))}return s}catch(r){try{return Promise.all(t.filter(e=>e&&""!==e).map(t=>i(this,void 0,void 0,function*(){const r=yield d(e,t);if(r)return c()&&u.putValue(t,{file:JSON.stringify(r)}),r})))}catch(e){return[]}}})}function H(e,t,r){return i(this,void 0,void 0,function*(){if(!t)return[];const n=t.value,s=e.createBatch(),a=[];for(const e of n){const t=e.resourceReference.id;""!==t&&s.get(t,t,r)}try{const e=yield s.executeAll();for(const t of n){const r=e.get(t.resourceReference.id);r&&r.content&&a.push(r.content)}return a}catch(t){try{return Promise.all(n.filter(e=>e.resourceReference.id&&""!==e.resourceReference.id).map(t=>i(this,void 0,void 0,function*(){const n=yield e.api(t.resourceReference.id).middlewareOptions(Object(o.prepScopes)(...r)).get();if(n&&n.length)return n[0].content})))}catch(e){return[]}}})}function F(e,t){return i(this,void 0,void 0,function*(){return o.GraphPageIterator.create(e,t)})}function q(e,t,r){return i(this,void 0,void 0,function*(){return o.GraphPageIterator.createFromValue(e,t,r)})}function B(e,t){return i(this,void 0,void 0,function*(){if(c()){const r=yield e.getValue(t);if(r&&a()>Date.now()-r.timeCached)return JSON.parse(r.file)}return null})}function $(e,t){return i(this,void 0,void 0,function*(){if(e||(e=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists)),l()){const r=yield e.getValue(t);if(r&&(o.CacheService.config.fileLists.invalidationPeriod||o.CacheService.config.defaultInvalidationPeriod)>Date.now()-r.timeCached)return r}return null})}function z(e){return i(this,void 0,void 0,function*(){const t=e._nextLink;if(e.hasNext&&(yield e.next()),l()){let r;r=o.CacheService.getCache(n.a.fileLists,n.a.fileLists.stores.fileLists);const i=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(t)[3];r.putValue(i,{files:e.value,nextLink:e._nextLink})}})}},t1eO:function(e,t,r){"use strict";r.d(t,"b",function(){return T}),r.d(t,"a",function(){return A});var o=r("hkiJ"),n=r("IVvM"),i=r("JpLj"),s=r("cmRh"),a=r("uHnN"),c=r("jhrh"),l=r("+pM/");const d=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--task-border:2px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:2px solid #797775;--task-complete-border:2px dotted #797775;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,2px solid #e1dfdd)}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#797775));font-size:12px;font-weight:600;white-space:nowrap;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;padding:4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{flex:0 0 auto;display:flex}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{height:100%;max-width:50px;min-width:50px;flex:1 1 auto;justify-content:center;align-items:center;display:flex;cursor:pointer}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4)}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{font-family:var(--default-font-family, "Segoe UI");font-size:14px;font-weight:600;color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));margin:0 12px 0 32px}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{background:var(--task-new-add-button-disabled-background,#eaeaea);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}
`];var u=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};function h(e,t,r,o){return p(e,t,{assignments:r},o)}function p(e,t,r,o){return u(this,void 0,void 0,function*(){return yield e.api("/planner/tasks/"+t).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Group.ReadWrite.All")).header("If-Match",o).patch(JSON.stringify(r))})}var f=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};function g(e,t,r,o){return f(this,void 0,void 0,function*(){return yield e.api("/me/outlook/tasks/"+t).header("Cache-Control","no-store").header("If-Match",o).middlewareOptions(Object(s.prepScopes)("Tasks.ReadWrite")).patch(r)})}var m=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};class v{constructor(e){this.graph=s.BetaGraph.fromGraph(e)}}class b extends v{getTaskGroups(){return m(this,void 0,void 0,function*(){return(yield function(e){return u(this,void 0,void 0,function*(){const t=yield e.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Group.Read.All")).get();return t&&t.value})}(this.graph)).map(e=>({id:e.id,title:e.title}))})}getTaskGroupsForGroup(e){return m(this,void 0,void 0,function*(){return(yield function(e,t){return u(this,void 0,void 0,function*(){const r=`/groups/${t}/planner/plans`,o=yield e.api(r).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Group.Read.All")).get();return o?o.value:null})}(this.graph,e)).map(e=>({id:e.id,title:e.title}))})}getTaskGroup(e){return m(this,void 0,void 0,function*(){const t=yield function(e,t){return u(this,void 0,void 0,function*(){return yield e.api("/planner/plans/"+t).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Group.Read.All")).get()})}(this.graph,e);return{id:t.id,title:t.title,_raw:t}})}getTaskFoldersForTaskGroup(e){return m(this,void 0,void 0,function*(){return(yield function(e,t){return u(this,void 0,void 0,function*(){const r=yield e.api(`/planner/plans/${t}/buckets`).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Group.Read.All")).get();return r&&r.value})}(this.graph,e)).map(e=>({_raw:e,id:e.id,name:e.name,parentId:e.planId}))})}getTasksForTaskFolder(e){return m(this,void 0,void 0,function*(){return(yield function(e,t){return u(this,void 0,void 0,function*(){const r=yield e.api(`/planner/buckets/${t}/tasks`).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Group.Read.All")).get();return r&&r.value})}(this.graph,e)).map(e=>({_raw:e,assignments:e.assignments,completed:100===e.percentComplete,dueDate:e.dueDateTime&&new Date(e.dueDateTime),eTag:e["@odata.etag"],id:e.id,immediateParentId:e.bucketId,name:e.title,topParentId:e.planId}))})}setTaskComplete(e,t){return m(this,void 0,void 0,function*(){return yield function(e,t,r){return p(e,t,{percentComplete:100},r)}(this.graph,e,t)})}setTaskIncomplete(e,t){return m(this,void 0,void 0,function*(){return yield function(e,t,r){return p(e,t,{percentComplete:0},r)}(this.graph,e,t)})}addTask(e){return m(this,void 0,void 0,function*(){return yield function(e,t){return e.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Group.ReadWrite.All")).post(t)}(this.graph,{assignments:e.assignments,bucketId:e.immediateParentId,dueDateTime:e.dueDate&&e.dueDate.toISOString(),planId:e.topParentId,title:e.name})})}assignPeopleToTask(e,t,r){return m(this,void 0,void 0,function*(){return yield h(this.graph,e,t,r)})}removeTask(e,t){return m(this,void 0,void 0,function*(){return yield function(e,t,r){return e.api("/planner/tasks/"+t).header("Cache-Control","no-store").header("If-Match",r).middlewareOptions(Object(s.prepScopes)("Group.ReadWrite.All")).delete()}(this.graph,e,t)})}isAssignedToMe(e,t){return Object.keys(e.assignments).includes(t)}}class y extends v{getTaskGroups(){return m(this,void 0,void 0,function*(){return(yield function(e){return f(this,void 0,void 0,function*(){const t=yield e.api("/me/outlook/taskGroups").header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.Read")).get();return t&&t.value})}(this.graph)).map(e=>({_raw:e,id:e.id,secondaryId:e.groupKey,title:e.name}))})}getTaskGroup(e){return m(this,void 0,void 0,function*(){const t=yield function(e,t){return f(this,void 0,void 0,function*(){return yield e.api("/me/outlook/taskGroups/"+t).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.Read")).get()})}(this.graph,e);return{id:t.id,secondaryId:t.groupKey,title:t.name,_raw:t}})}getTaskFoldersForTaskGroup(e){return m(this,void 0,void 0,function*(){return(yield function(e,t){return f(this,void 0,void 0,function*(){const r=yield e.api(`/me/outlook/taskGroups/${t}/taskFolders`).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.Read")).get();return r&&r.value})}(this.graph,e)).map(t=>({_raw:t,id:t.id,name:t.name,parentId:e}))})}getTasksForTaskFolder(e,t){return m(this,void 0,void 0,function*(){return(yield function(e,t){return f(this,void 0,void 0,function*(){const r=yield e.api(`/me/outlook/taskFolders/${t}/tasks`).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.Read")).get();return r&&r.value})}(this.graph,e)).map(r=>({_raw:r,assignments:{},completed:!!r.completedDateTime,dueDate:r.dueDateTime&&new Date(r.dueDateTime.dateTime+"Z"),eTag:r["@odata.etag"],id:r.id,immediateParentId:e,name:r.subject,topParentId:t}))})}setTaskComplete(e,t){return m(this,void 0,void 0,function*(){return yield function(e,t,r){return f(this,void 0,void 0,function*(){return yield g(e,t,{isReminderOn:!1,status:"completed"},r)})}(this.graph,e,t)})}assignPeopleToTask(e,t,r){return m(this,void 0,void 0,function*(){return yield h(this.graph,e,t,r)})}setTaskIncomplete(e,t){return m(this,void 0,void 0,function*(){return yield function(e,t,r){return f(this,void 0,void 0,function*(){return yield g(e,t,{isReminderOn:!0,status:"notStarted"},r)})}(this.graph,e,t)})}addTask(e){return m(this,void 0,void 0,function*(){const t={parentFolderId:e.immediateParentId,subject:e.name};return e.dueDate&&(t.dueDateTime={dateTime:e.dueDate.toISOString(),timeZone:"UTC"}),yield function(e,t){return f(this,void 0,void 0,function*(){const{parentFolderId:r=null}=t;return r?yield e.api(`/me/outlook/taskFolders/${r}/tasks`).header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.ReadWrite")).post(t):yield e.api("/me/outlook/tasks").header("Cache-Control","no-store").middlewareOptions(Object(s.prepScopes)("Tasks.ReadWrite")).post(t)})}(this.graph,t)})}removeTask(e,t){return m(this,void 0,void 0,function*(){return yield function(e,t,r){return f(this,void 0,void 0,function*(){return yield e.api("/me/outlook/tasks/"+t).header("Cache-Control","no-store").header("If-Match",r).middlewareOptions(Object(s.prepScopes)("Tasks.ReadWrite")).delete()})}(this.graph,e,t)})}isAssignedToMe(e,t){return!0}getTaskGroupsForGroup(e){return m(this,void 0,void 0,function*(){})}}var w=r("sh+J"),k=r("WcTu");r("cy2K"),r("m4u+"),r("Snan");const C={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"cancel",newTaskPlaceholder:"Task...",addTaskButtonSubtitle:"Add"};var T,S=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};!function(e){e[e.planner=0]="planner",e[e.todo=1]="todo"}(T||(T={}));const E={BASE_SELF_ASSIGNED:"All Tasks",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Folder not found",PLANS_SELF_ASSIGNED:"All groups",PLAN_NOT_FOUND:"Group not found"},x={BASE_SELF_ASSIGNED:"Assigned to Me",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Bucket not found",PLANS_SELF_ASSIGNED:"All Plans",PLAN_NOT_FOUND:"Plan not found"},O={"@odata.type":"microsoft.graph.plannerAssignment",orderHint:"string !"};let A=class extends s.MgtTemplatedComponent{constructor(){super(),this.dataSource=T.planner,this._me=null,this.clearState(),this.previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}get res(){switch(this.dataSource){case T.todo:return E;case T.planner:default:return x}}static get styles(){return d}get strings(){return C}get isNewTaskVisible(){return this._isNewTaskVisible}set isNewTaskVisible(e){this._isNewTaskVisible=e,e||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="")}static get requiredScopes(){return[...new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite",...k.a.requiredScopes,...c.b.requiredScopes])]}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),"data-source"===e&&(this.dataSource===T.planner?(this._currentGroup=this.initialId,this._currentFolder=this.initialBucketId):this.dataSource===T.todo&&(this._currentGroup=null,this._currentFolder=this.initialId),this.clearState(),this.requestStateUpdate())}clearState(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._loadingTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1,this._todoDefaultSet=!1}firstUpdated(e){super.firstUpdated(e),this.initialId&&!this._currentGroup&&(this.dataSource===T.planner?this._currentGroup=this.initialId:this.dataSource===T.todo&&(this._currentFolder=this.initialId)),this.dataSource===T.planner&&this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}render(){let e=this._tasks.filter(e=>this.isTaskInSelectedGroupFilter(e)).filter(e=>this.isTaskInSelectedFolderFilter(e)).filter(e=>!this._hiddenTasks.includes(e.id));this.taskFilter&&(e=e.filter(e=>this.taskFilter(e._raw)));const t=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null;let r;return this.hideHeader||(r=o.d`
        <div class="Header" dir=${this.direction}>
          ${this.renderPlanOptions()}
        </div>
      `),o.d`
      ${r}
      <div class="Tasks" dir=${this.direction}>
        ${this._isNewTaskVisible?this.renderNewTask():null} ${t}
        ${Object(i.a)(e,e=>e.id,e=>this.renderTask(e))}
      </div>
    `}loadState(){return I(this,void 0,void 0,function*(){const e=this.getTaskSource();if(!e)return;const t=s.Providers.globalProvider;if(!t||t.state!==s.ProviderState.SignedIn)return;let r;if(this._inTaskLoad=!0,!this._me){const e=t.graph.forComponent(this);r=Object(w.d)(e)}this.groupId&&this.dataSource===T.planner?yield this._loadTasksForGroup(e):this.targetId?this.dataSource===T.todo?yield this._loadTargetTodoTasks(e):yield this._loadTargetPlannerTasks(e):yield this._loadAllTasks(e),r&&(this._me=yield r),this._inTaskLoad=!1,this._hasDoneInitialLoad=!0})}onResize(){this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())}_loadTargetTodoTasks(e){return I(this,void 0,void 0,function*(){const t=yield e.getTaskGroups(),r=(yield Promise.all(t.map(t=>e.getTaskFoldersForTaskGroup(t.id)))).reduce((e,t)=>[...e,...t],[]),o=(yield Promise.all(r.map(t=>e.getTasksForTaskFolder(t.id,t.parentId)))).reduce((e,t)=>[...e,...t],[]);this._tasks=o,this._folders=r,this._groups=t,this._currentGroup=null})}_loadTargetPlannerTasks(e){return I(this,void 0,void 0,function*(){const t=yield e.getTaskGroup(this.targetId);let r=yield e.getTaskFoldersForTaskGroup(t.id);this.targetBucketId&&(r=r.filter(e=>e.id===this.targetBucketId));const o=(yield Promise.all(r.map(t=>e.getTasksForTaskFolder(t.id,t.parentId)))).reduce((e,t)=>[...e,...t],[]);this._tasks=o,this._folders=r,this._groups=[t]})}_loadAllTasks(e){return I(this,void 0,void 0,function*(){const t=yield e.getTaskGroups(),r=(yield Promise.all(t.map(t=>e.getTaskFoldersForTaskGroup(t.id)))).reduce((e,t)=>[...e,...t],[]);if(!this.initialId&&this.dataSource===T.todo&&!this._todoDefaultSet){this._todoDefaultSet=!0;const e=r.find(e=>e._raw.isDefaultFolder);e&&(this._currentFolder=e.id)}const o=(yield Promise.all(r.map(t=>e.getTasksForTaskFolder(t.id,t.parentId)))).reduce((e,t)=>[...e,...t],[]);this._tasks=o,this._folders=r,this._groups=t})}_loadTasksForGroup(e){return I(this,void 0,void 0,function*(){const t=yield e.getTaskGroupsForGroup(this.groupId),r=(yield Promise.all(t.map(t=>e.getTaskFoldersForTaskGroup(t.id)))).reduce((e,t)=>[...e,...t],[]),o=(yield Promise.all(r.map(t=>e.getTasksForTaskFolder(t.id,t.parentId)))).reduce((e,t)=>[...e,...t],[]);this._tasks=o,this._folders=r,this._groups=t})}addTask(e,t,r,o,n={}){return I(this,void 0,void 0,function*(){const i=this.getTaskSource();if(!i)return;const s={assignments:n,dueDate:t,immediateParentId:o,name:e,topParentId:r};this._newTaskBeingAdded=!0;const a=yield i.addTask(s);this.fireCustomEvent("taskAdded",a),yield this.requestStateUpdate(),this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1})}completeTask(e){return I(this,void 0,void 0,function*(){const t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskComplete(e.id,e.eTag),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter(t=>t!==e.id))})}uncompleteTask(e){return I(this,void 0,void 0,function*(){const t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskIncomplete(e.id,e.eTag),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter(t=>t!==e.id))})}removeTask(e){return I(this,void 0,void 0,function*(){const t=this.getTaskSource();t&&(this._hiddenTasks=[...this._hiddenTasks,e.id],yield t.removeTask(e.id,e.eTag),this.fireCustomEvent("taskRemoved",e),yield this.requestStateUpdate(),this._hiddenTasks=this._hiddenTasks.filter(t=>t!==e.id))})}assignPeople(e,t){return I(this,void 0,void 0,function*(){const r=this.getTaskSource();if(!r)return;let o=[];e&&e.assignments&&(o=Object.keys(e.assignments).sort());const n=t.map(e=>e.id);if(n.length===o.length&&n.sort().every((e,t)=>e===o[t]))return;const i={};if(0===t.length)for(let e=0;e<o.length;e++)i[o[e]]=null;if(t){for(let e=0;e<o.length;e++)for(let r=0;r<t.length;r++){if(o[e]!==t[r].id){i[o[e]]=null;break}i[o[e]]=O}for(let e=0;e<t.length;e++)i[t[e].id]=O}e&&(this._loadingTasks=[...this._loadingTasks,e.id],yield r.assignPeopleToTask(e.id,i,e.eTag),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter(t=>t!==e.id))})}onAddTaskClick(e){const t=this.getPeoplePicker(null),r={};if(t)for(const e of t.selectedPeople)t.selectedPeople.length&&(r[e.id]=O);!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,r)}renderPlanOptions(){const e=s.Providers.globalProvider;if(!e||e.state!==s.ProviderState.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return o.d`
        <span class="LoadingHeader"></span>
      `;const t=this.readOnly||this._isNewTaskVisible?null:o.d`
            <div
              class="AddBarItem NewTaskButton"
              @click="${()=>{this.isNewTaskVisible=!this.isNewTaskVisible}}"
            >
              <span class="TaskIcon"></span>
              <span>${this.strings.addTaskButtonSubtitle}</span>
            </div>
          `;if(this.dataSource===T.planner){const e=this._groups.find(e=>e.id===this._currentGroup)||{title:this.res.BASE_SELF_ASSIGNED},r={[this.res.BASE_SELF_ASSIGNED]:e=>{this._currentGroup=null,this._currentFolder=null}};for(const e of this._groups)r[e.title]=t=>{this._currentGroup=e.id,this._currentFolder=null};const n=o.d`
        <mgt-arrow-options .options="${r}" .value="${e.title}"></mgt-arrow-options>
      `,i=this._currentGroup?o.d`
            <span class="TaskIcon Divider">/</span>
          `:null,s=this._folders.find(e=>e.id===this._currentFolder)||{name:this.res.BUCKETS_SELF_ASSIGNED},a={[this.res.BUCKETS_SELF_ASSIGNED]:e=>{this._currentFolder=null}};for(const e of this._folders.filter(e=>e.parentId===this._currentGroup))a[e.name]=t=>{this._currentFolder=e.id};const c=this.targetBucketId?o.d`
            <span class="PlanTitle">
              ${this._folders[0]&&this._folders[0].name}
            </span>
          `:o.d`
            <mgt-arrow-options .options="${a}" .value="${s.name}"></mgt-arrow-options>
          `;return o.d`
        <div class="TitleCont">
          ${n} ${i} ${this._currentGroup?c:null}
        </div>
        ${t}
      `}{const e=this._folders.find(e=>e.id===this.targetId)||{name:this.res.BUCKETS_SELF_ASSIGNED},r=this._folders.find(e=>e.id===this._currentFolder)||{name:this.res.BUCKETS_SELF_ASSIGNED},n={};for(const e of this._folders)n[e.name]=()=>{this._currentFolder=e.id};n[this.res.BUCKETS_SELF_ASSIGNED]=e=>{this._currentFolder=null};const i=this.targetId?o.d`
            <span class="PlanTitle">
              ${e.name}
            </span>
          `:o.d`
            <mgt-arrow-options .value="${r.name}" .options="${n}"></mgt-arrow-options>
          `;return o.d`
        <span class="TitleCont">
          ${i}
        </span>
        ${t}
      `}}renderNewTask(){const e=o.d`
      <input
        type="text"
        placeholder=${this.strings.newTaskPlaceholder}
        .value="${this._newTaskName}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="input"
        @input="${e=>{this._newTaskName=e.target.value}}"
      />
    `,t=this._groups;t.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=t[0].id);const r=this.dataSource===T.todo?null:this._currentGroup?o.d`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <span>${this.getPlanTitle(this._currentGroup)}</span>
            </span>
          `:o.d`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <select
                .value="${this._newTaskGroupId}"
                @change="${e=>{this._newTaskGroupId=e.target.value}}"
              >
                ${this._groups.map(e=>o.d`
                    <option value="${e.id}">${e.title}</option>
                  `)}
              </select>
            </span>
          `,n=this._folders.filter(e=>this._currentGroup&&e.parentId===this._currentGroup||!this._currentGroup&&e.parentId===this._newTaskGroupId);n.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=n[0].id);const i=this._currentFolder?o.d`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <span>${this.getFolderName(this._currentFolder)}</span>
          </span>
        `:o.d`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskFolderId}"
              @change="${e=>{this._newTaskFolderId=e.target.value}}"
            >
              ${n.map(e=>o.d`
                  <option value="${e.id}">${e.name}</option>
                `)}
            </select>
          </span>
        `,s=o.d`
      <span class="NewTaskDue">
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="input"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${e=>{const t=e.target.value;this._newTaskDueDate=t?new Date(t+"T17:00"):null}}"
        />
      </span>
    `,a=this.dataSource===T.todo?null:this.renderAssignedPeople(null),c=this._newTaskBeingAdded?o.d`
          <div class="TaskAddButtonContainer"></div>
        `:o.d`
          <div class="TaskAddButtonContainer ${""===this._newTaskName?"Disabled":""}">
            <div class="TaskIcon TaskCancel" @click="${()=>this.isNewTaskVisible=!1}">
              <span>${this.strings.cancelNewTaskSubtitle}</span>
            </div>
            <div class="TaskIcon TaskAdd" @click="${this.onAddTaskClick}">
              <span></span>
            </div>
          </div>
        `;return o.d`
      <div class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${e}
            </div>
            <div class="TaskDetails">
              ${r} ${i} ${s} ${a}
            </div>
          </div>
        </div>
        ${c}
      </div>
    `}togglePeoplePicker(e){const t=this.getPeoplePicker(e),r=this.getMgtPeople(e),o=this.getFlyout(e);t&&r&&o&&(o.isOpen?o.close():(t.selectedPeople=r.people,o.open(),window.requestAnimationFrame(()=>{t.focus()})))}updateAssignedPeople(e){const t=this.getPeoplePicker(e),r=this.getMgtPeople(e);t&&t.selectedPeople!==r.people&&(r.people=t.selectedPeople,this.assignPeople(e,t.selectedPeople))}getPeoplePicker(e){const t=e?e.id:"newTask";return this.renderRoot.querySelector(".picker-"+t)}getMgtPeople(e){const t=e?e.id:"newTask";return this.renderRoot.querySelector(".people-"+t)}getFlyout(e){const t=e?e.id:"newTask";return this.renderRoot.querySelector(".flyout-"+t)}renderTask(e){const{name:t="Task",completed:r=!1,dueDate:i}=e,s=this._loadingTasks.includes(e.id),c={Complete:!s&&r,Loading:s,TaskCheck:!0,TaskIcon:!0},l=s?o.d`
          
        `:r?o.d`
          
        `:null,d=o.d`
      <span class=${Object(n.a)(c)}><span class="TaskCheckContent">${l}</span></span>
    `,u=this._currentGroup?null:this.getPlanTitle(e.topParentId),h=this._currentFolder?null:this.getFolderName(e.immediateParentId),p={task:Object.assign(Object.assign({},e._raw),{groupTitle:u,folderTitle:h})},f=this.renderTemplate("task",p,e.id);if(f)return f;let g=this.renderTemplate("task-details",p,"task-details-"+e.id);if(!g){const r=this.dataSource===T.todo||this._currentGroup?null:o.d`
              <div class="TaskDetail TaskGroup">
                ${this.renderPlannerIcon()}
                <span>${this.getPlanTitle(e.topParentId)}</span>
              </div>
            `,n=this._currentFolder?null:o.d`
            <div class="TaskDetail TaskBucket">
              ${this.renderBucketIcon()}
              <span>${this.getFolderName(e.immediateParentId)}</span>
            </div>
          `,s=i?o.d`
            <div class="TaskDetail TaskDue">
              <span>Due ${Object(a.g)(i)}</span>
            </div>
          `:null,c=this.dataSource!==T.todo?this.renderAssignedPeople(e):null;g=o.d`
        <div class="TaskTitle">
          ${t}
        </div>
        ${r} ${n} ${c} ${s}
      `}const m=this.readOnly||this.hideOptions?null:o.d`
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{[this.strings.removeTaskSubtitle]:()=>this.removeTask(e)}}"
              ></mgt-dot-options>
            </div>
          `;return o.d`
      <div
        class=${Object(n.a)({Complete:r,Incomplete:!r,ReadOnly:this.readOnly,Task:!0})}
      >
        <div
          class="TaskContent"
          @click=${()=>{this.handleTaskClick(e)}}
        >
          <span
            class=${Object(n.a)({Complete:r,Incomplete:!r,TaskCheckContainer:!0})}
            @click="${t=>{this.readOnly||(e.completed?this.uncompleteTask(e):this.completeTask(e),t.stopPropagation(),t.preventDefault())}}"
          >
            ${d}
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery} ${this._currentGroup?"NoPlan":""}">
            ${g}
          </div>
          ${m}

          <div class="Divider"></div>
        </div>
      </div>
    `}renderAssignedPeople(e){let t=null;const r={NewTaskAssignee:null===e,TaskAssignee:null!==e,TaskDetail:null!==e},i=e?Object.keys(e.assignments).map(e=>e):[],s=o.d`
      <template data-type="no-data">
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
      </template>
    `,a=e?e.id:"newTask";return r["flyout-"+a]=!0,t=o.d`
      <mgt-people
        class="people-${a}"
        .userIds="${i}"
        .personCardInteraction=${l.a.none}
        @click=${t=>{this.togglePeoplePicker(e),t.stopPropagation()}}
        >${s}
      </mgt-people>
    `,o.d`
      <mgt-flyout light-dismiss class=${Object(n.a)(r)} @closed=${t=>this.updateAssignedPeople(e)}>
        ${t}
        <div slot="flyout" class=${Object(n.a)({Picker:!0})}>
          <mgt-people-picker
            class="picker-${a}"
            @click=${e=>e.stopPropagation()}
          ></mgt-people-picker>
        </div>
      </mgt-flyout>
    `}handleTaskClick(e){e&&this.fireCustomEvent("taskClick",{task:e._raw})}renderLoadingTask(){return o.d`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderPlannerIcon(){return o.d`
      <svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.223 1.156C6.98 1.26 6.769 1.404 6.586 1.586C6.403 1.768 6.261 1.98 6.157 2.223C6.052 2.465 6 2.724 6 3H2V17H14V3H10C10 2.724 9.948 2.465 9.844 2.223C9.74 1.98 9.596 1.768 9.414 1.586C9.231 1.404 9.02 1.26 8.777 1.156C8.535 1.053 8.276 1 8 1C7.723 1 7.465 1.053 7.223 1.156ZM5 4H7V3C7 2.86 7.026 2.729 7.078 2.609C7.13 2.49 7.202 2.385 7.293 2.293C7.384 2.202 7.49 2.131 7.609 2.079C7.73 2.026 7.859 2 8 2C8.14 2 8.271 2.026 8.39 2.079C8.511 2.131 8.616 2.202 8.707 2.293C8.798 2.385 8.87 2.49 8.922 2.609C8.974 2.729 9 2.86 9 3V4H11V5H5V4ZM12 6V4H13V16H3V4H4V6H12Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 12.3517L5.49956 14.2037L4.14856 12.8517L4.85156 12.1487L5.49956 12.7967L6.64856 11.6487L7.35156 12.3517Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 8.35168L5.49956 10.2037L4.14856 8.85168L4.85156 8.14868L5.49956 8.79668L6.64856 7.64868L7.35156 8.35168Z"
          fill="#3C3C3C"
        />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 14H12.001V13H8V14Z" fill="#3C3C3C" />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10H12.001V9H8V10Z" fill="#3C3C3C" />
      </svg>
    `}renderBucketIcon(){return o.d`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}getTaskSource(){const e=s.Providers.globalProvider;if(!e||e.state!==s.ProviderState.SignedIn)return null;const t=e.graph.forComponent(this);return this.dataSource===T.planner?new b(t):this.dataSource===T.todo?new y(t):null}getPlanTitle(e){return e?e===this.res.PLANS_SELF_ASSIGNED?this.res.PLANS_SELF_ASSIGNED:(this._groups.find(t=>t.id===e)||{title:this.res.PLAN_NOT_FOUND}).title:this.res.BASE_SELF_ASSIGNED}getFolderName(e){return e?(this._folders.find(t=>t.id===e)||{name:this.res.BUCKET_NOT_FOUND}).name:this.res.BUCKETS_SELF_ASSIGNED}isTaskInSelectedGroupFilter(e){return e.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(e,this._me.id)}isTaskInSelectedFolderFilter(e){return e.immediateParentId===this._currentFolder||!this._currentFolder}dateToInputValue(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}};S([Object(o.f)({attribute:"read-only",type:Boolean}),_("design:type",Boolean)],A.prototype,"readOnly",void 0),S([Object(o.f)({attribute:"data-source",converter:(e,t)=>(e=e.toLowerCase(),T[e]||T.planner)}),_("design:type",Number)],A.prototype,"dataSource",void 0),S([Object(o.f)({attribute:"target-id",type:String}),_("design:type",String)],A.prototype,"targetId",void 0),S([Object(o.f)({attribute:"target-bucket-id",type:String}),_("design:type",String)],A.prototype,"targetBucketId",void 0),S([Object(o.f)({attribute:"initial-id",type:String}),_("design:type",String)],A.prototype,"initialId",void 0),S([Object(o.f)({attribute:"initial-bucket-id",type:String}),_("design:type",String)],A.prototype,"initialBucketId",void 0),S([Object(o.f)({attribute:"hide-header",type:Boolean}),_("design:type",Boolean)],A.prototype,"hideHeader",void 0),S([Object(o.f)({attribute:"hide-options",type:Boolean}),_("design:type",Boolean)],A.prototype,"hideOptions",void 0),S([Object(o.f)({attribute:"group-id",type:String}),_("design:type",String)],A.prototype,"groupId",void 0),S([Object(o.f)(),_("design:type",Boolean)],A.prototype,"_isNewTaskVisible",void 0),S([Object(o.f)(),_("design:type",Boolean)],A.prototype,"_newTaskBeingAdded",void 0),S([Object(o.f)(),_("design:type",String)],A.prototype,"_newTaskName",void 0),S([Object(o.f)(),_("design:type",Date)],A.prototype,"_newTaskDueDate",void 0),S([Object(o.f)(),_("design:type",String)],A.prototype,"_newTaskGroupId",void 0),S([Object(o.f)(),_("design:type",String)],A.prototype,"_newTaskFolderId",void 0),S([Object(o.f)(),_("design:type",Array)],A.prototype,"_groups",void 0),S([Object(o.f)(),_("design:type",Array)],A.prototype,"_folders",void 0),S([Object(o.f)(),_("design:type",Array)],A.prototype,"_tasks",void 0),S([Object(o.f)(),_("design:type",Array)],A.prototype,"_hiddenTasks",void 0),S([Object(o.f)(),_("design:type",Array)],A.prototype,"_loadingTasks",void 0),S([Object(o.f)(),_("design:type",Boolean)],A.prototype,"_inTaskLoad",void 0),S([Object(o.f)(),_("design:type",Boolean)],A.prototype,"_hasDoneInitialLoad",void 0),S([Object(o.f)(),_("design:type",Boolean)],A.prototype,"_todoDefaultSet",void 0),S([Object(o.f)(),_("design:type",String)],A.prototype,"_currentGroup",void 0),S([Object(o.f)(),_("design:type",String)],A.prototype,"_currentFolder",void 0),A=S([Object(o.c)("mgt-tasks"),_("design:paramtypes",[])],A)},tAiM:function(e,t,r){"use strict";r.d(t,"a",function(){return h}),r.d(t,"b",function(){return p});var o=r("J0Kn"),n=r("2hCA"),i=r("+BgG"),s=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};class a{constructor(e,t,r,o){"/"!==r.charAt(0)&&(r="/"+r),this.resource=r,this.method=o,this.index=e,this.id=t}}class c{constructor(e){this.graph=e,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(e,t,r,o){const n=this.nextIndex++,i=new a(n,e,t,"GET");i.headers=o,this.allRequests.push(i),this.requestsQueue.push(n),r&&(this.scopes=this.scopes.concat(r))}executeNext(){return s(this,void 0,void 0,function*(){const e=new Map;var t;if(this.retryAfter&&(yield(t=1e3*this.retryAfter,new Promise(e=>{setTimeout(e,t)})),this.retryAfter=0),!this.hasRequests)return e;const r=this.requestsQueue.splice(0,20),s=new o.c;for(const e of r.map(e=>this.allRequests[e]))s.addRequest({id:e.index.toString(),request:new Request(c.baseUrl+e.resource,{method:e.method,headers:e.headers})});const a=this.scopes.length?Object(i.b)(...this.scopes):[],l=this.graph.api("$batch").middlewareOptions(a),d=yield s.getContent(),u=yield l.post(d);for(const t of u.responses){const r=new n.a,o=this.allRequests[t.id];r.id=o.id,r.index=o.index,r.headers=t.headers,200===t.status?(t.headers["Content-Type"].includes("image/jpeg")?r.content="data:image/jpeg;base64,"+t.body:t.headers["Content-Type"].includes("image/pjpeg")?r.content="data:image/pjpeg;base64,"+t.body:r.content=t.body,e.set(o.id,r)):429===t.status&&(this.requestsQueue.unshift(t.id),this.retryAfter=Math.max(this.retryAfter,parseInt(t.headers["Retry-After"],10)||1))}return e})}executeAll(){return s(this,void 0,void 0,function*(){const e=new Map;for(;this.hasRequests;){const t=yield this.executeNext();for(const[r,o]of t)e.set(r,o)}return e})}}c.baseUrl="https://graph.microsoft.com";var l=r("b9Ts"),d=r("5tjQ"),u=r("gHVf");class h{constructor(e,t="v1.0"){this._client=e,this._version=t}get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}forComponent(e){const t=new h(this._client,this._version);return t.setComponent(e),t}api(e){let t=this._client.api(e).version(this._version);return this._componentName&&(t.middlewareOptions=e=>{const r=t;return r._middlewareOptions=r._middlewareOptions.concat(e),t},t=t.middlewareOptions([new l.a(this._componentName)])),t}createBatch(){return new c(this)}setComponent(e){this._componentName=e instanceof Element?e.tagName:e}}function p(e,t,r){const n=[new o.a(e),new o.g(new o.h),new o.i,new d.a(u.a,e.name),new o.e],s=o.d.initWithMiddleware({middleware:Object(i.a)(...n)}),a=new h(s,t);return r?a.forComponent(r):a}},tS0e:function(e,t,r){"use strict";r.d(t,"b",function(){return d}),r.d(t,"a",function(){return p});var o=r("cmRh"),n=r("J0Kn"),i=r("5tjQ"),s=r("gHVf"),a=r("zUnT");class c{constructor(e){this._getCustomHeaders=e}execute(e){return t=this,void 0,o=function*(){if(this._getCustomHeaders){const t=yield this._getCustomHeaders();for(const r in t)t.hasOwnProperty(r)&&Object(a.e)(e.request,e.options,r,t[r])}return yield this.nextMiddleware.execute(e)},new((r=void 0)||(r=Promise))(function(e,n){function i(e){try{a(o.next(e))}catch(e){n(e)}}function s(e){try{a(o.throw(e))}catch(e){n(e)}}function a(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r(function(e){e(o)})).then(i,s)}a((o=o.apply(t,[])).next())});var t,r,o}setNext(e){this.nextMiddleware=e}}class l extends o.Graph{constructor(e,t){const r=[new n.g(new n.h),new n.i,new i.a(s.a),new c(t),new n.e];super(n.d.initWithMiddleware({baseUrl:e,middleware:Object(o.chainMiddleware)(...r)}))}}class d extends o.IProvider{constructor(e,t=null){super(),this.graph=new l(e,t),this.graph.api("me").get().then(e=>{null!=e?this.setState(o.ProviderState.SignedIn):this.setState(o.ProviderState.SignedOut)},e=>{this.setState(o.ProviderState.SignedOut)})}get name(){return"MgtProxyProvider"}getAccessToken(){return null}}var u=r("hkiJ"),h=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};let p=class extends o.MgtBaseProvider{get isAvailable(){return!0}initializeProvider(){void 0!==this.graphProxyUrl&&(this.provider=new d(this.graphProxyUrl),o.Providers.globalProvider=this.provider)}};h([Object(u.f)({attribute:"graph-proxy-url"}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",t)}(0,String)],p.prototype,"graphProxyUrl",void 0),p=h([Object(u.c)("mgt-proxy-provider")],p)},uHnN:function(e,t,r){"use strict";function o(e){const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=r)return e.toLocaleString("default",{hour:"numeric",minute:"numeric"});const o=new Date(r);if(o.setDate(t.getDate()-t.getDay()),e>=o)return e.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});const n=new Date(o);return n.setDate(o.getDate()-7),e>=n?e.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})}function n(e){const t=e.getMonth(),r=e.getDate();return`${i(t)} ${r}`}function i(e){switch(e){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}}function s(e){switch(e){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return"Day"}}function a(e,t){let r;return function(){const o=()=>e.apply(this,arguments);clearTimeout(r),r=setTimeout(o,t)}}function c(e){return new Promise((t,r)=>{const o=new FileReader;o.onerror=r,o.onload=e=>{t(o.result)},o.readAsDataURL(e)})}function l(e){return e.startsWith("[")?e.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():e}function d(e){return/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/.test(e)}r.d(t,"f",function(){return o}),r.d(t,"g",function(){return n}),r.d(t,"e",function(){return i}),r.d(t,"d",function(){return s}),r.d(t,"b",function(){return a}),r.d(t,"a",function(){return c}),r.d(t,"c",function(){return l}),r.d(t,"h",function(){return d})},v0KA:function(e,t,r){"use strict";r.d(t,"a",function(){return d});var o=r("hkiJ"),n=r("/yih"),i=r("zKI9"),s=r("P7nI"),a=r("uHnN");const c=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .file{display:flex;align-items:center;padding:11px 20px}:host .root .file:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .file:last-child{margin-bottom:unset}:host .root .file .file__icon{width:28px;min-width:28px;height:28px;margin-right:12px;display:flex;align-items:center;justify-content:center}:host .root .file .file__icon img{height:28px;width:28px}:host .root .file .file__details{min-width:0;margin-right:40px}:host .root .file .file__details .file__name{font-size:14px;color:var(--color-sub1,#323130)}:host .root .file .file__details .file__last-modified{font-size:12px;color:var(--color-sub2,#797775)}:host .root .file .file__details>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[dir=rtl] .file__icon{margin-right:0!important}[dir=rtl] .file__details{margin-right:12px!important}
`],l={filesSectionTitle:"Files",sharedTextSubtitle:"Shared"};let d=class extends n.a{constructor(e){super(),this._files=e}static get styles(){return c}get strings(){return l}get displayName(){return this.strings.filesSectionTitle}clearState(){super.clearState(),this._files=null}renderIcon(){return Object(s.b)(s.a.Files)}renderCompactView(){let e;return e=this.isLoadingState?this.renderLoading():this._files&&this._files.length?o.d`
        ${this._files.slice(0,3).map(e=>this.renderFile(e))}
      `:this.renderNoData(),o.d`
      <div class="root compact" dir=${this.direction}>
        ${e}
      </div>
    `}renderFullView(){let e;return e=this.isLoadingState?this.renderLoading():this._files&&this._files.length?o.d`
        ${this._files.map(e=>this.renderFile(e))}
      `:this.renderNoData(),o.d`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.filesSectionTitle}</div>
        ${e}
      </div>
    `}renderFile(e){const t=e.lastShared?o.d`
          <div class="file__last-modified">
            ${this.strings.sharedTextSubtitle} ${Object(a.f)(new Date(e.lastShared.sharedDateTime))}
          </div>
        `:null;return o.d`
      <div class="file" @click=${t=>this.handleFileClick(e)}>
        <div class="file__icon">
          <img src=${Object(i.a)(e.resourceVisualization.type,48,"svg")} />
        </div>
        <div class="file__details">
          <div class="file__name">${e.resourceVisualization.title}</div>
          ${t}
        </div>
      </div>
    `}handleFileClick(e){e.resourceReference&&e.resourceReference.webUrl&&window.open(e.resourceReference.webUrl,"_blank")}};d=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}([Object(o.c)("mgt-person-card-files"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",t)}(0,[Array])],d)},vY9u:function(e,t,r){"use strict";var o;r.d(t,"a",function(){return o}),function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(o||(o={}))},voU4:function(e,t,r){"use strict";r.d(t,"a",function(){return u}),r.d(t,"b",function(){return h}),r.d(t,"e",function(){return p}),r.d(t,"c",function(){return f}),r.d(t,"f",function(){return g}),r.d(t,"g",function(){return m}),r.d(t,"d",function(){return b});var o=r("ePoC"),n=r("2RF3"),i=r("8GBX"),s=r("r6WH"),a=r("DpLM"),c=r("SkKE");const l=e=>null===e||!("object"==typeof e||"function"==typeof e),d=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class u{constructor(e,t,r){this.dirty=!0,this.element=e,this.name=t,this.strings=r,this.parts=[];for(let e=0;e<r.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new h(this)}_getValue(){const e=this.strings,t=e.length-1,r=this.parts;if(1===t&&""===e[0]&&""===e[1]){const e=r[0].value;if("symbol"==typeof e)return String(e);if("string"==typeof e||!d(e))return e}let o="";for(let n=0;n<t;n++){o+=e[n];const t=r[n];if(void 0!==t){const e=t.value;if(l(e)||!d(e))o+="string"==typeof e?e:String(e);else for(const t of e)o+="string"==typeof t?t:String(t)}}return o+=e[t],o}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class h{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===i.a||l(e)&&e===this.value||(this.value=e,Object(o.b)(e)||(this.committer.dirty=!0))}commit(){for(;Object(o.b)(this.value);){const e=this.value;this.value=i.a,e(this)}this.value!==i.a&&this.committer.commit()}}class p{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(Object(c.c)()),this.endNode=e.appendChild(Object(c.c)())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=Object(c.c)()),e.__insert(this.endNode=Object(c.c)())}insertAfterPart(e){e.__insert(this.startNode=Object(c.c)()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;Object(o.b)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=i.a,e(this)}const e=this.__pendingValue;e!==i.a&&(l(e)?e!==this.value&&this.__commitText(e):e instanceof a.b?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):d(e)?this.__commitIterable(e):e===i.b?(this.value=i.b,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,r="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=r:this.__commitNode(document.createTextNode(r)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof s.a&&this.value.template===t)this.value.update(e.values);else{const r=new s.a(t,e.processor,this.options),o=r._clone();r.update(e.values),this.__commitNode(o),this.value=r}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let r,o=0;for(const n of e)r=t[o],void 0===r&&(r=new p(this.options),t.push(r),0===o?r.appendIntoPart(this):r.insertAfterPart(t[o-1])),r.setValue(n),r.commit(),o++;o<t.length&&(t.length=o,this.clear(r&&r.endNode))}clear(e=this.startNode){Object(n.b)(this.startNode.parentNode,e.nextSibling,this.endNode)}}class f{constructor(e,t,r){if(this.value=void 0,this.__pendingValue=void 0,2!==r.length||""!==r[0]||""!==r[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=r}setValue(e){this.__pendingValue=e}commit(){for(;Object(o.b)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=i.a,e(this)}if(this.__pendingValue===i.a)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=i.a}}class g extends u{constructor(e,t,r){super(e,t,r),this.single=2===r.length&&""===r[0]&&""===r[1]}_createPart(){return new m(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class m extends h{}let v=!1;(()=>{try{const e={get capture(){return v=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class b{constructor(e,t,r){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=r,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;Object(o.b)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=i.a,e(this)}if(this.__pendingValue===i.a)return;const e=this.__pendingValue,t=this.value,r=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),n=null!=e&&(null==t||r);r&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),n&&(this.__options=y(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=i.a}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const y=e=>e&&(v?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)},vzno:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var o=r("hkiJ"),n=r("cmRh"),i=r("IVvM"),s=r("Vxif"),a=r("/yih");const c=[o.b`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--title-color-sub2,#797775);line-height:20px}:host .root .part .part__details .part__value{grid-column:2;color:var(--color-sub1,#323130);font-size:14px;font-weight:400}:host .root .part .part__details .part__value .part__link{color:#0078d4;font-family:var(--default-font-family);font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:#004578}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--background-color-sub2,#f3f2f1);visibility:hidden;display:flex;align-items:center;justify-content:center}:host .root .part .part__copy svg{fill:var(--color-sub1,#323130);cursor:pointer}:host .root .part:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}
`];var l=r("P7nI");const d={contactSectionTitle:"Contact"};let u=class extends a.a{constructor(e){super(),this._contactParts={email:{icon:Object(l.b)(l.a.Email,"#929292"),onClick:()=>this.sendEmail(),showCompact:!0,title:"Email"},chat:{icon:Object(l.b)(l.a.Chat,"#929292"),onClick:()=>this.sendChat(),showCompact:!1,title:"Teams"},businessPhone:{icon:Object(l.b)(l.a.CellPhone,"#929292"),onClick:()=>this.sendCall(),showCompact:!0,title:"Business Phone"},cellPhone:{icon:Object(l.b)(l.a.CellPhone,"#929292"),onClick:()=>this.sendCall(),showCompact:!0,title:"Mobile Phone"},department:{icon:Object(l.b)(l.a.Department,"#929292"),showCompact:!1,title:"Department"},title:{icon:Object(l.b)(l.a.Person,"#929292"),showCompact:!1,title:"Title"},officeLocation:{icon:Object(l.b)(l.a.OfficeLocation,"#929292"),showCompact:!0,title:"Office Location"}},this._person=e,this._contactParts.email.value=Object(s.e)(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,this._person.businessPhones&&this._person.businessPhones.length&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}static get styles(){return c}get strings(){return d}get hasData(){return!!this._contactParts&&!!Object.values(this._contactParts).filter(e=>!!e.value).length}get displayName(){return this.strings.contactSectionTitle}renderIcon(){return Object(l.b)(l.a.Contact)}clearState(){super.clearState();for(const e of Object.keys(this._contactParts))this._contactParts[e].value=null}renderCompactView(){let e;if(!this.hasData)return null;const t=Object.values(this._contactParts).filter(e=>!!e.value);let r=Object.values(t).filter(e=>!!e.value&&e.showCompact);return r&&r.length||(r=Object.values(t).slice(0,2)),e=o.d`
      ${r.map(e=>this.renderContactPart(e))}
    `,o.d`
      <div class="root compact" dir=${this.direction}>
        ${e}
      </div>
    `}renderFullView(){let e;if(this.hasData){const t=Object.values(this._contactParts).filter(e=>!!e.value);e=o.d`
        ${t.map(e=>this.renderContactPart(e))}
      `}return o.d`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.displayName}</div>
        ${e}
      </div>
    `}renderContactPart(e){let t=!1;"Mobile Phone"!==e.title&&"Business Phone"!==e.title||(t=!0);const r={part__link:!0,phone:t},n=e.onClick?o.d`
          <span class=${Object(i.a)(r)} @click=${t=>e.onClick(t)}>${e.value}</span>
        `:o.d`
          ${e.value}
        `;return o.d`
      <div class="part" @click=${t=>this.handlePartClick(t,e.value)}>
        <div class="part__icon">${e.icon}</div>
        <div class="part__details">
          <div class="part__title">${e.title}</div>
          <div class="part__value">${n}</div>
        </div>
        <div class="part__copy">
          ${Object(l.b)(l.a.Copy)}
        </div>
      </div>
    `}handlePartClick(e,t){t&&navigator.clipboard.writeText(t)}sendChat(){const e=this._contactParts.chat.value;if(!e)return;const t="https://teams.microsoft.com/l/chat/0/0?users="+e,r=()=>window.open(t,"_blank");n.TeamsHelper.isAvailable?n.TeamsHelper.executeDeepLink(t,e=>{e||r()}):r()}sendEmail(){const e=this._contactParts.email.value;e&&window.open("mailto:"+e,"_blank")}sendCall(){const e=this._contactParts.cellPhone.value;e&&window.open("tel:"+e,"_blank")}};u=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}([Object(o.c)("mgt-person-card-contact"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",t)}(0,[Object])],u)},wAtJ:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var o=r("hkiJ"),n=r("yNap");class i extends n.b{get provider(){return this._provider}set provider(e){this._provider&&this.provider.removeStateChangedHandler(()=>this.stateChangedHandler),this._provider=e,this._provider&&this.provider.onStateChanged(()=>this.stateChangedHandler)}get isAvailable(){return!0}firstUpdated(e){super.firstUpdated(e);let t=!1;if(this.dependsOn){let e=this.dependsOn;for(;e;){if(e.isAvailable){t=!0;break}e=e.dependsOn}}!t&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}stateChangedHandler(){this.fireCustomEvent("onStateChanged",this.provider.state)}}!function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);i>3&&s&&Object.defineProperty(t,r,s)}([Object(o.f)({attribute:"depends-on",converter:e=>document.querySelector(e),type:String}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",t)}(0,i)],i.prototype,"dependsOn",void 0)},whPB:function(e,t,r){"use strict";r.r(t);var o=r("cmRh");for(var n in o)["default"].indexOf(n)<0&&function(e){r.d(t,e,function(){return o[e]})}(n);var i=r("Jjn7");for(var n in i)["default"].indexOf(n)<0&&function(e){r.d(t,e,function(){return i[e]})}(n);var s=r("zAh+");r.d(t,"MsalProvider",function(){return s.b}),r.d(t,"MgtMsalProvider",function(){return s.a});var a=r("pZb9");r.d(t,"TeamsProvider",function(){return a.b}),r.d(t,"MgtTeamsProvider",function(){return a.a});var c=r("tS0e");r.d(t,"ProxyProvider",function(){return c.b}),r.d(t,"MgtProxyProvider",function(){return c.a});var l=r("zEAF");r.d(t,"SharePointProvider",function(){return l.a});var d=r("ThlN");r.d(t,"PromptType",function(){return d.c}),r.d(t,"Msal2Provider",function(){return d.b}),r.d(t,"MgtMsal2Provider",function(){return d.a})},wvst:function(e,t,r){"use strict";r.d(t,"a",function(){return o});const o={sendEmailLinkSubtitle:"Send email",startChatLinkSubtitle:"Start chat",showMoreSectionButton:"Show more"}},xD9d:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var o=r("2cRh");class n{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,r)=>{r<e.length-1&&t.setNext(e[r+1])}),this.middleware=e[0]}sendRequest(e){return o.b(this,void 0,void 0,function*(){try{if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}catch(e){throw e}})}}},"xUc+":function(e,t,r){"use strict";r.d(t,"a",function(){return o});const o=(e=5242880)=>{return e>62914560&&(e=62914560),(t=e)>327680&&(t=320*Math.floor(t/327680)*1024),t;var t}},yLr0:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var o=r("tAiM"),n=r("ZMEg");class i extends n.a{constructor(e,t,r){super(),this._getAccessTokenHandler=e,this._loginHandler=t,this._logoutHandler=r,this.graph=Object(o.b)(this)}get name(){return"MgtSimpleProvider"}getAccessToken(e){return this._getAccessTokenHandler(e.scopes)}login(){return this._loginHandler()}logout(){return this._logoutHandler()}}},yNap:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return l});var o,n=r("hkiJ"),i=r("ZMEg"),s=r("ayeG"),a=r("d4nO"),c=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};!function(e){e.mobile="",e.tablet="tablet",e.desktop="desktop"}(o||(o={}));class l extends n.a{constructor(){super(),this.direction="ltr",this._isLoadingState=!1,this._isFirstUpdated=!1,this.handleLocalizationChanged=this.handleLocalizationChanged.bind(this),this.handleDirectionChanged=this.handleDirectionChanged.bind(this),this.handleProviderUpdates=this.handleProviderUpdates.bind(this),this.handleActiveAccountUpdates=this.handleActiveAccountUpdates.bind(this),this.handleDirectionChanged(),this.handleLocalizationChanged()}get mediaQuery(){return this.offsetWidth<768?o.mobile:this.offsetWidth<1200?o.tablet:o.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}connectedCallback(){super.connectedCallback(),a.a.onStringsUpdated(this.handleLocalizationChanged),a.a.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),a.a.removeOnStringsUpdated(this.handleLocalizationChanged),a.a.removeOnDirectionUpdated(this.handleDirectionChanged),s.a.removeProviderUpdatedListener(this.handleProviderUpdates),s.a.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(e){super.firstUpdated(e),this._isFirstUpdated=!0,s.a.onProviderUpdated(this.handleProviderUpdates),s.a.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(e,t,r=!1,o=!1){const n=new CustomEvent(e,{bubbles:r,cancelable:o,detail:t});return this.dispatchEvent(n)}updated(e){super.updated(e);const t=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(t)}requestStateUpdate(e=!1){return c(this,void 0,void 0,function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!e&&(yield this._currentLoadStatePromise);const t=s.a.globalProvider;if(!t)return Promise.resolve();if(t.state!==i.c.SignedOut){if(t.state===i.c.Loading)return Promise.resolve();{const t=new Promise((r,o)=>c(this,void 0,void 0,function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),r()}catch(e){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),o(e)}return this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&e?this._currentLoadStatePromise.then(()=>t):t}))}}else this.clearState()})}setLoadingState(e){this._isLoadingState!==e&&(this._isLoadingState=e,this.requestUpdate("isLoadingState"))}handleProviderUpdates(){this.requestStateUpdate()}handleActiveAccountUpdates(){return c(this,void 0,void 0,function*(){this.clearState(),this.requestStateUpdate()})}handleLocalizationChanged(){a.a.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()}handleDirectionChanged(){this.direction=a.a.getDocumentDirection()}}!function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);i>3&&s&&Object.defineProperty(t,r,s)}([Object(n.e)(),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",t)}(0,Object)],l.prototype,"direction",void 0)},ykqw:function(e,t,r){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],o=t[1];return 3*(r+o)/4-o},t.toByteArray=function(e){var t,r,o=l(e),s=o[0],a=o[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,a)),d=0,u=a>0?s-4:s;for(r=0;r<u;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;return 2===a&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[d++]=255&t),1===a&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i=[],s=0,a=r-n;s<a;s+=16383)i.push(d(e,s,s+16383>a?a:s+16383));return 1===n?(t=e[r-1],i.push(o[t>>2]+o[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(o[t>>10]+o[t>>4&63]+o[t<<2&63]+"=")),i.join("")};for(var o=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)o[a]=s[a],n[s.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function d(e,t,r){for(var n,i,s=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(o[(i=n)>>18&63]+o[i>>12&63]+o[i>>6&63]+o[63&i]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},"zAh+":function(e,t,r){"use strict";r.d(t,"b",function(){return je}),r.d(t,"a",function(){return Be});var o,n,i,s,a,c=r("cmRh"),l=r("2cRh"),d=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",i=0,s="",a=0;a<36;a++)"-"!==o[a]&&"4"!==o[a]&&(i=16*Math.random()|0),"x"===o[a]?s+=n[i]:"y"===o[a]?(i&=3,s+=n[i|=8]):s+=o[a];return s},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var t,r=/\+/g,o=/([^&=]+)=([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=o.exec(e);t;)i[n(t[1])]=n(t[2]),t=o.exec(e);return i},e}(),u=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(o||(o={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(n||(n={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(i||(i={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(s||(s={})),function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(a||(a={}));var h,p=[a.SID,a.LOGIN_HINT],f={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},g=r("VkLk"),m=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},e}(),v="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",b=function(e){function t(r,o){var n=e.call(this,r,o)||this;return n.name="ClientAuthError",Object.setPrototypeOf(n,t.prototype),n}return l.d(t,e),t.createEndpointResolutionError=function(e){var r="Error: could not resolve endpoints. Please check network and try again.";return e&&!m.isEmpty(e)&&(r+=" Details: "+e),new t("endpoints_resolution_error",r)},t.createPopupWindowError=function(e){var r=v;return e&&!m.isEmpty(e)&&(r+=" Details: "+e),new t("popup_window_error",r)},t.createTokenRenewalTimeoutError=function(){return new t("token_renewal_error","Token renewal operation failed due to timeout.")},t.createInvalidIdTokenError=function(e){return new t("invalid_id_token","Invalid ID token format. Given token: "+e)},t.createInvalidStateError=function(e,r){return new t("invalid_state_error","Invalid state. "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t("nonce_mismatch_error","Nonce is not matching, Nonce received:  "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t("login_progress_error","Login_In_Progress: Error during login call - login is already in progress.")},t.createAcquireTokenInProgressError=function(){return new t("acquiretoken_progress_error","AcquireToken_In_Progress: Error during login call - login is already in progress.")},t.createUserCancelledError=function(){return new t("user_cancelled","User cancelled the flow.")},t.createErrorInCallbackFunction=function(e){return new t("callback_error","Error occurred in token received callback function. "+e+".")},t.createUserLoginRequiredError=function(){return new t("user_login_error","User login is required. For silent calls, request must contain either sid or login_hint")},t.createUserDoesNotExistError=function(){return new t("user_non_existent","User object does not exist. Please call a login API.")},t.createClientInfoDecodingError=function(e){return new t("client_info_decoding_error","The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause. Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t("client_info_not_populated_error","The service did not populate client_info in the response, Please verify with the service team Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t("null_or_empty_id_token","The idToken is null or empty. Please review the trace to determine the root cause. Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t("id_token_parsing_error","ID token cannot be parsed. Please review stack trace to determine root cause. Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t("token_encoding_error","The token to be decoded is not encoded correctly. Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t("invalid_interaction_type","The interaction type passed to the handler was incorrect or unknown")},t.createCacheParseError=function(e){return new t("cannot_parse_cache","invalid key: "+e+", The cached token key is not a valid JSON and cannot be parsed")},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t("block_token_requests","Token calls are blocked in hidden iframes")},t}(g.a),y={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},w={code:"authority_uri_insecure",desc:"Authority URIs must use https."},k={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},C="empty_request_error",T="Request object is required.",S="telemetry_config_error",_="Telemetry config is not configured with required values",I=function(e){function t(r,o){var n=e.call(this,r,o)||this;return n.name="ClientConfigurationError",Object.setPrototypeOf(n,t.prototype),n}return l.d(t,e),t.createNoSetConfigurationError=function(){return new t("no_config_set","Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object.")},t.createStorageNotSupportedError=function(e){return new t("storage_not_supported","The value for the cacheLocation is not supported. Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t("no_redirect_callbacks","No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.")},t.createInvalidCallbackObjectError=function(e){return new t("invalid_callback_object","The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics. Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t("empty_input_scopes_error","Scopes cannot be passed as empty array. Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t("nonarray_input_scopes_error","Scopes cannot be passed as non-array. Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t("scopes_required","Scopes are required to obtain an access token. Given value: "+e)},t.createInvalidPromptError=function(e){return new t("invalid_prompt_value","Supported prompt values are 'login', 'select_account', 'consent' and 'none' Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t("claims_request_parsing_error","Could not parse the given claims request object. Given value: "+e)},t.createEmptyRequestError=function(){return new t(C,T)},t.createInvalidCorrelationIdError=function(){return new t("invalid_guid_sent_as_correlationId","Please set the correlationId as a valid guid")},t.createKnownAuthoritiesNotSetError=function(){return new t("b2c_known_authorities_not_set","Must set known authorities when validateAuthority is set to True and using B2C")},t.createInvalidAuthorityTypeError=function(){return new t(y.code,y.desc)},t.createUntrustedAuthorityError=function(e){return new t("untrusted_authority","The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false. Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var r={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(S,_+" mising values: "+Object.keys(r).reduce(function(t,o){return e[o]?t:t.concat([o+" ("+r[o]+")"])},[]).join(","))},t.createSsoSilentError=function(){return new t("sso_silent_error","request must contain either sid or login_hint")},t.createInvalidAuthorityMetadataError=function(){return new t("authority_metadata_error","Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields.")},t}(b),E=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(e.slice()),o=this.trimAndConvertArrayToLowerCase(t.slice()),n=0;n<o.length;n++)if(r.indexOf(o[n].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every(function(e){return r.indexOf(e.toString().toLowerCase())>=0})},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map(function(e){return t.trimAndConvertToLowerCase(e)})},e.trimScopes=function(e){return e.map(function(e){return e.trim()})},e.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter(function(e){return e!==r})},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw I.createScopesNonArrayError(e);if(e.length<1&&t)throw I.createEmptyScopesArrayError(e.toString())}else if(t)throw I.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(u.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,o=this.trimAndConvertArrayToLowerCase(e.slice());return r?o.concat(r):o}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,r=0;return e.indexOf(u.openidScope)>-1&&(r+=1),e.indexOf(u.profileScope)>-1&&(r+=1),t>0&&t===r},e.containsAnyOidcScopes=function(e){var t=e.indexOf(u.openidScope)>-1,r=e.indexOf(u.profileScope)>-1;return t||r},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(u.openidScope)&&t.push(u.openidScope),-1===t.indexOf(u.profileScope)&&t.push(u.profileScope),t},e.removeDefaultScopes=function(e){return e.filter(function(e){return e!==u.openidScope&&e!==u.profileScope})},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?u.oidcScopes:e},e}(),x=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=E.appendDefaultScopes(e.scopes),r=[];return r.push("response_type="+e.responseType),r.push("scope="+encodeURIComponent(E.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var r=e.toLowerCase(),o=this.GetUrlComponents(r),n=o.PathSegments;return!t||0===n.length||n[0]!==u.common&&n[0]!==a.ORGANIZATIONS&&n[0]!==a.CONSUMERS||(n[0]=t),this.constructAuthorityUriFromObject(o,n)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===u.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===a.ORGANIZATIONS},e.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===a.CONSUMERS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var o={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},n=o.AbsolutePath.split("/");return n=n.filter(function(e){return e&&e.length>0}),o.PathSegments=n,r[6]&&(o.Search=r[6]),r[8]&&(o.Hash=r[8]),o},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(m.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(o.ERROR_DESCRIPTION)||r.hasOwnProperty(o.ERROR)||r.hasOwnProperty(o.ACCESS_TOKEN)||r.hasOwnProperty(o.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return d.deserialize(r)},e.getHostFromUri=function(e){return String(e).replace(/^(https?:)\/\//,"").split("/")[0]},e}(),O=function(e,t,r,o,n){this.authority=x.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=d.base64Encode(o)+"."+d.base64Encode(n)},A=function(e,t,r,o){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=o},R=function(){function e(e,t,r,o,n,i,s){this.authorityInstance=e,this.clientId=t,this.nonce=d.createNewGuid(),this.scopes=n?n.slice():u.oidcScopes,this.scopes=E.trimScopes(this.scopes),this.state=i,this.correlationId=s,this.xClientSku="MSAL.JS",this.xClientVer="1.4.11",this.responseType=r,this.redirectUri=o}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,o,n){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),o&&(i=this.constructUnifiedCacheQueryParameter(null,o)),i=this.addHintParameters(t,i);var s=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(s,n)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,o;if(e)if(e.account){var n=e.account;n.sid?(r=a.SID,o=n.sid):n.userName&&(r=a.LOGIN_HINT,o=n.userName)}else e.sid?(r=a.SID,o=e.sid):e.loginHint&&(r=a.LOGIN_HINT,o=e.loginHint);else t&&t.hasOwnProperty(u.upn)&&(r=a.ID_TOKEN,o=t.upn);return this.addSSOParameter(r,o)},e.prototype.addHintParameters=function(e,t){return e&&!t[a.SID]&&(!t[a.LOGIN_HINT]&&e.sid&&this.promptValue===f.NONE?t=this.addSSOParameter(a.SID,e.sid,t):!t[a.LOGIN_HINT]&&e.userName&&!m.isEmpty(e.userName)&&(t=this.addSSOParameter(a.LOGIN_HINT,e.userName,t))),t},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case a.SID:r[a.SID]=t;break;case a.ID_TOKEN:case a.LOGIN_HINT:r[a.LOGIN_HINT]=t}return r},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach(function(o){o===u.domain_hint&&(t||e[a.SID])||(r?r+="&"+o+"="+encodeURIComponent(e[o]):r=o+"="+encodeURIComponent(e[o]))}),r},e.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},e.determineResponseType=function(e,t){return E.onlyContainsOidcScopes(t)?"id_token":e?this.responseTypeForMatchingAccounts(t):"id_token token"},e.responseTypeForMatchingAccounts=function(e){return E.containsAnyOidcScopes(e)?"id_token token":"token"},e}(),P=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var o=this;return new Promise(function(r,n){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(){var e;(i.status<200||i.status>=300)&&n(o.handleError(i.responseText));try{e=JSON.parse(i.responseText)}catch(e){n(o.handleError(i.responseText))}var t={statusCode:i.status,body:e};r(t)},i.onerror=function(){n(i.status)},"GET"!==t)throw"not implemented";i.send()})},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}(),N=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,r){t&&!this.getTrustedHostList().length&&r.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})},e.getAliases=function(e,t,r){return l.b(this,void 0,void 0,function(){var o,n,i;return l.e(this,function(s){return o=new P,n="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",i=t.createAndStartHttpEvent(r,"GET",n,"getAliases"),[2,o.sendRequestAsync(n,"GET",!0).then(function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),e.body.metadata}).catch(function(e){throw i.serverErrorCode=e,t.stopEvent(i),e})]})})},e.setTrustedAuthoritiesFromNetwork=function(t,r,o){return l.b(this,void 0,void 0,function(){var n;return l.e(this,function(i){switch(i.label){case 0:return[4,this.getAliases(t,r,o)];case 1:return i.sent().forEach(function(t){t.aliases.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})}),n=x.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(n)&&e.TrustedHostList.push(n.toLowerCase()),[2]}})})},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(h||(h={}));var D,L=function(){function e(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return e.isAdfs=function(e){var t=x.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===u.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?h.Adfs:h.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=x.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=x.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===h.Adfs?this.CanonicalAuthority+".well-known/openid-configuration":this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw y}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw w;if(!e.PathSegments||e.PathSegments.length<1)throw k},e.prototype.DiscoverEndpoints=function(e,t,r){var o=new P,n=t.createAndStartHttpEvent(r,"GET",e,"openIdConfigurationEndpoint");return o.sendRequestAsync(e,"GET",!0).then(function(e){return n.httpResponseStatus=e.statusCode,t.stopEvent(n),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}}).catch(function(e){throw n.serverErrorCode=e,t.stopEvent(n),e})},e.prototype.resolveEndpointsAsync=function(e,t){return l.b(this,void 0,void 0,function(){var r,o,n;return l.e(this,function(i){switch(i.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==N.getTrustedHostList().length?[3,2]:[4,N.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:i.sent(),i.label=2;case 2:if(!N.IsInTrustedHostList(r))throw I.createUntrustedAuthorityError(r);i.label=3;case 3:return o=this.GetOpenIdConfigurationEndpoint(),n=this,[4,this.DiscoverEndpoints(o,e,t)];case 4:return n.tenantDiscoveryResponse=i.sent(),[2,this.tenantDiscoveryResponse]}})})},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),U=function(){function e(t,r){if(!t||m.isEmpty(t))return this.uid="",void(this.utid="");try{var o=d.base64Decode(t),n=JSON.parse(o);n&&(n.hasOwnProperty("uid")&&(this.uid=r?e.stripPolicyFromUid(n.uid,r):n.uid),n.hasOwnProperty("utid")&&(this.utid=n.utid))}catch(e){throw b.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e.createClientInfoFromIdToken=function(t,r){var o={uid:t.subject,utid:""};return new e(d.base64Encode(JSON.stringify(o)),r)},e.stripPolicyFromUid=function(e,t){var r=e.split("-"),o=t.split("/").reverse(),n="";return m.isEmpty(o[0])?o.length>1&&(n=o[1]):n=o[0],r[r.length-1]===n?r.slice(0,r.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return d.base64Encode(e)},e}(),M=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),j=function(){function e(){}return e.decodeJwt=function(e){if(m.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var r=t||300;return e&&e>M.now()+r},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=d.base64Decode(r);return o?JSON.parse(o):null}catch(e){}return null},e}(),H=function(e){if(m.isEmpty(e))throw b.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=j.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw b.createIdTokenParsingError(e)}},F=function(e,t){this.key=e,this.value=t},q=function(){function e(e){if(!window)throw g.a.createNoWindowObjectError("Browser storage class could not find window object");if(void 0===window[e]||null===window[e])throw I.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var o=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(o+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=o},e.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var n=r[o];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),B=function(){function e(){}return e.validateRequest=function(e,t,r,o){if(!t&&!e)throw I.createEmptyRequestError();var n,i;e&&(n=t?E.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,E.validateInputScope(n,!t),n=E.translateClientIdIfSingleScope(n,r),this.validatePromptParameter(e.prompt),i=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var s=this.validateAndGenerateState(e&&e.state,o),a=this.validateAndGenerateCorrelationId(e&&e.correlationId);return l.a({},e,{extraQueryParameters:i,scopes:n,state:s,correlationId:a})},e.validatePromptParameter=function(e){if(e&&[f.LOGIN,f.SELECT_ACCOUNT,f.CONSENT,f.NONE].indexOf(e)<0)throw I.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=l.a({},e);return r?(t&&delete r[u.claims],p.forEach(function(e){r[e]&&delete r[e]}),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw I.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,r){return m.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+u.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:d.createNewGuid(),ts:M.now(),method:e},r=JSON.stringify(t);return d.base64Encode(r)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(u.resourceDelimiter)[0];if(d.isGuid(t))return{id:t,ts:M.now(),method:u.interactionTypeRedirect};try{var r=d.base64Decode(t);return JSON.parse(r)}catch(t){throw b.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!d.isGuid(e))throw I.createInvalidCorrelationIdError();return d.isGuid(e)?e:d.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+u.resourceDelimiter+e.authority},e}(),$=function(e){function t(t,r,o){var n=e.call(this,r)||this;return n.clientId=t,n.rollbackEnabled=!0,n.migrateCacheEntries(o),n}return l.d(t,e),t.prototype.migrateCacheEntries=function(t){var r,o=this,n=u.cachePrefix+"."+i.IDTOKEN,a=u.cachePrefix+"."+i.CLIENT_INFO,c=u.cachePrefix+"."+s.ERROR,l=u.cachePrefix+"."+s.ERROR_DESC,d=e.prototype.getItem.call(this,n);if(d)try{r=new H(d)}catch(e){return}if(r&&r.claims&&r.claims.aud===this.clientId){var h=[d,e.prototype.getItem.call(this,a),e.prototype.getItem.call(this,c),e.prototype.getItem.call(this,l)];[i.IDTOKEN,i.CLIENT_INFO,s.ERROR,s.ERROR_DESC].forEach(function(e,r){return o.duplicateCacheEntry(e,h[r],t)})}},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+u.cachePrefix)||0===e.indexOf(u.adalIdToken)?e:t?u.cachePrefix+"."+this.clientId+"."+e:u.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,r,n){var i=m.validateAndParseJsonCacheKey(e);if(!i)return null;var s=e.match(t)&&e.match(r),a=!1;switch(n){case o.ACCESS_TOKEN:a=!!e.match(u.scopes);break;case o.ID_TOKEN:a=!e.match(u.scopes)}return s&&a?i:null},t.prototype.setItem=function(t,r,o){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,o),this.rollbackEnabled&&!o&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,o)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(u.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var r=this,o=t&&B.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),s=window[this.cacheLocation];o&&!i&&Object.keys(s).forEach(function(t){-1!==t.indexOf(o)&&(r.removeItem(t),e.prototype.clearItemCookie.call(r,t))}),this.removeItem(n.INTERACTION_STATUS),this.removeItem(n.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,o){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,o),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,o)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,r){var o=this;return Object.keys(window[this.cacheLocation]).reduce(function(n,i){var s=o.matchKeyForType(i,e,t,r);if(s){var a=o.getItem(i);if(a)try{var c=new F(s,JSON.parse(a));return n.concat([c])}catch(e){return n}}return n},[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,o.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,o.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){var r=this.getAllAccessTokens(e,t),o=this.getAllIdTokens(e,t);return r.concat(o)},t.prototype.tokenRenewalInProgress=function(e){var r=this.getItem(t.generateTemporaryCacheKey(n.RENEW_STATUS,e));return!(!r||r!==u.inProgress)},t.prototype.clearMsalCookie=function(r){var o=this;r?(this.clearItemCookie(t.generateTemporaryCacheKey(n.NONCE_IDTOKEN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(n.STATE_LOGIN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(n.LOGIN_REQUEST,r)),this.clearItemCookie(t.generateTemporaryCacheKey(n.STATE_ACQ_TOKEN,r))):document.cookie.split(";").forEach(function(t){var r=t.trim().split("=")[0];r.indexOf(u.cachePrefix)>-1&&e.prototype.clearItemCookie.call(o,r)})},t.generateAcquireTokenAccountKey=function(e,t){var r=B.parseLibraryState(t).id;return""+n.ACQUIRE_TOKEN_ACCOUNT+u.resourceDelimiter+e+u.resourceDelimiter+r},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(n.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var r=B.parseLibraryState(t).id;return""+e+u.resourceDelimiter+r},t}(q),z=function(){function e(e,t,r,o,n,i,s){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=o,this.idToken=n,this.idTokenClaims=n,this.sid=i,this.environment=s}return e.createAccount=function(t,r){var o,n=t.objectId||t.subject,i=r?r.uid:"",s=r?r.utid:"";return m.isEmpty(i)||(o=m.isEmpty(s)?d.base64Encode(i):d.base64Encode(i)+"."+d.base64Encode(s)),new e(n,o,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!!(e&&t&&e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},e}(),V=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+u.resourceDelimiter+t},e.monitorIframeForHash=function(t,r,o,n){return new Promise(function(i,s){var a=M.relativeNowMs()+r;n.verbose("monitorWindowForIframe polling started");var c=setInterval(function(){if(M.relativeNowMs()>a)return n.error("monitorIframeForHash unable to find hash in url, timing out"),n.errorPii("monitorIframeForHash polling timed out for url: "+o),clearInterval(c),void s(b.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(e){}e&&x.urlContainsHash(e)&&(n.verbose("monitorIframeForHash found url in hash"),clearInterval(c),i(t.location.hash))},e.POLLING_INTERVAL_MS)})},e.monitorPopupForHash=function(t,r,o,n){return new Promise(function(i,s){var a=r/e.POLLING_INTERVAL_MS,c=0;n.verbose("monitorWindowForHash polling started");var l=setInterval(function(){if(t.closed)return n.error("monitorWindowForHash window closed"),clearInterval(l),void s(b.createUserCancelledError());var r;try{r=t.location.href}catch(e){}if(r&&"about:blank"!==r)if(c++,r&&x.urlContainsHash(r)){n.verbose("monitorPopupForHash found url in hash"),clearInterval(l);var d=t.location.hash;e.clearUrlFragment(t),i(d)}else c>a&&(n.error("monitorPopupForHash unable to find hash in url, timing out"),n.errorPii("monitorPopupForHash polling timed out for url: "+o),clearInterval(l),s(b.createTokenRenewalTimeoutError()))},e.POLLING_INTERVAL_MS)})},e.loadFrame=function(e,t,r,o){var n=this;return o.infoPii("LoadFrame: "+t),new Promise(function(i,s){setTimeout(function(){var r=n.loadFrameSync(e,t,o);r?i(r):s("Unable to load iframe with name: "+t)},r)})},e.loadFrameSync=function(t,r,o){var n=e.addHiddenIFrame(r,o);return n?(""!==n.src&&"about:blank"!==n.src||(n.src=t,o.infoPii("Frame Name : "+r+" Navigated to: "+t)),n):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var o=document.createElement("iframe");o.setAttribute("id",e),o.setAttribute("aria-hidden","true"),o.style.visibility="hidden",o.style.position="absolute",o.style.width=o.style.height="0",o.style.border="0",o.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(o)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map(function(e,r){return t.item(r)}).filter(function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}})[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter(function(e){try{return e.location.hash===t}catch(e){return!1}})[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach(function(e){return e.close()})},e.blockReloadInHiddenIframes=function(){if(x.urlContainsHash(window.location.hash)&&e.isInIframe())throw b.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(n.REDIRECT_REQUEST);if(t&&!x.urlContainsHash(window.location.hash)){var r=t.split(u.resourceDelimiter);r.shift();var o=r.length>0?r.join(u.resourceDelimiter):null;e.resetTempCacheItems(o)}},e.clearUrlFragment=function(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},e.POLLING_INTERVAL_MS=50,e}(),K=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),l.a({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,r,n,i,s,a){switch(n.responseType){case"id_token":return r=l.a({},r,{tokenType:o.ID_TOKEN,account:i,scopes:s,accountState:a}),(r=e.setResponseIdToken(r,t)).idToken?r:null;case"id_token token":return(r=e.setResponseIdToken(r,t))&&r.accessToken&&r.idToken?r:null;case"token":return e.setResponseIdToken(r,t);default:return null}},e}(),G=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,r){return l.b(this,void 0,void 0,function(){var o;return l.e(this,function(n){switch(n.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return o=n.sent(),this.metadataMap.set(e.CanonicalAuthority,o),[2,o]}})})},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw I.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(e){throw I.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,r){return m.isEmpty(e)?null:(r&&this.saveMetadataFromConfig(e,r),new L(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(D||(D={}));var W=function(){function e(e,t){void 0===t&&(t={}),this.level=D.Info;var r=t.correlationId,o=void 0===r?"":r,n=t.level,i=void 0===n?D.Info:n,s=t.piiLoggingEnabled,a=void 0!==s&&s;this.localCallback=e,this.correlationId=o,this.level=i,this.piiLoggingEnabled=a}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var o,n=(new Date).toUTCString();o=m.isEmpty(this.correlationId)?n+":1.4.11-"+D[e]+(r?"-pii":"")+" "+t:n+":"+this.correlationId+"-1.4.11-"+D[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,o,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(D.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(D.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(D.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(D.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(D.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(D.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(D.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(D.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),Q={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return x.getCurrentUrl()},postLogoutRedirectUri:function(){return x.getCurrentUrl()},navigateToLoginRequestUrl:!0},J={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},Y={logger:new W(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},X={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map},Z=r("JaDF"),ee=r("Vcri");function te(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var re,oe,ne,ie=function(e){var t=x.GetUrlComponents(e);if(L.isAdfs(e))return e;var r=t.PathSegments;if(r&&r.length>=2){var o="tfp"===r[1]?2:1;o<r.length&&(r[o]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},se=function(e){return d.base64Encode(e)},ae=function(e){return"msal."+(e||"")},ce=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},le=function(){function e(e,t,r){var o;this.eventId=d.createNewGuid(),this.label=r,this.event=((o={})[ae("event_name")]=e,o[ae("elapsed_time")]=-1,o["Microsoft.MSAL.correlation_id"]=t,o)}return e.prototype.setElapsedTime=function(e){this.event[ae("elapsed_time")]=e},e.prototype.stop=function(){var e,t,r;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,r=this.perfEndMark,ce()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[ae("start_time")]=this.startTimestamp,e=this.perfStartMark,ce()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event["Microsoft.MSAL.correlation_id"]},set:function(e){this.event["Microsoft.MSAL.correlation_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[ae("event_name")]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return l.a({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}(),de=function(e){function t(t,r,o,n){var i=e.call(this,ae("default_event"),r,"DefaultEvent")||this;return i.event[ae("client_id")]=o,i.event[ae("sdk_plaform")]=t.sdk,i.event[ae("sdk_version")]=t.sdkVersion,i.event[ae("application_name")]=t.applicationName,i.event[ae("application_version")]=t.applicationVersion,i.event[ae("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,i.event.Microsoft_MSAL_ui_event_count=i.getEventCount(ae("ui_event"),n),i.event.Microsoft_MSAL_http_event_count=i.getEventCount(ae("http_event"),n),i.event.Microsoft_MSAL_cache_event_count=i.getEventCount(ae("cache_event"),n),i}return l.d(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(le),ue=ae("authority"),he=ae("authority_type"),pe=ae("ui_behavior"),fe=ae("tenant_id"),ge=ae("user_id"),me=ae("was_successful"),ve=ae("api_error_code"),be=ae("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(oe||(oe={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(ne||(ne={}));var ye=((re={})[ne.AcquireTokenSilent]=oe.AcquireTokenSilent,re[ne.AcquireTokenPopup]=oe.AcquireTokenPopup,re[ne.AcquireTokenRedirect]=oe.AcquireTokenRedirect,re[ne.LoginPopup]=oe.LoginPopup,re[ne.LoginRedirect]=oe.LoginRedirect,re[ne.Logout]=oe.Logout,re),we=function(e){function t(t,r,o){var n=e.call(this,ae("api_event"),t,o)||this;return o&&(n.apiCode=ye[o],n.apiEventIdentifier=o),n.piiEnabled=r,n}return l.d(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event["msal.api_telem_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event["msal.api_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[ue]=ie(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[ve]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[fe]=this.piiEnabled&&e?se(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[ge]=this.piiEnabled&&e?se(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[me]},set:function(e){this.event[me]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[be]=this.piiEnabled&&e?se(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[he]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[pe]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(le),ke=ae("http_path"),Ce=ae("user_agent"),Te=ae("query_parameters"),Se=ae("api_version"),_e=ae("response_code"),Ie=ae("oauth_error_code"),Ee=ae("http_method"),xe=ae("request_id_header"),Oe=ae("spe_info"),Ae=ae("server_error_code"),Re=ae("server_sub_error_code"),Pe=ae("url"),Ne=function(e){function t(t,r){return e.call(this,ae("http_event"),t,r)||this}return l.d(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=ie(e);this.event[Pe]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[ke]=ie(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[Ce]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[Te]=R.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[Se]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[_e]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[Ie]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[Ee]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[xe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[Oe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[Ae]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[Re]=e},enumerable:!0,configurable:!0}),t}(le),De=function(){function e(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=l.a({sdk:u.libraryName,sdkVersion:"1.4.11",networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},function(){},t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach(function(e){return t.incrementEventCount(e)});var o=this.completedEvents[e].concat(r);delete this.completedEvents[e];var n=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],o&&o.length){var i=new de(this.telemetryPlatform,e,this.clientId,n),s=o.concat([i]);this.telemetryEmitter(s.map(function(e){return e.get()}))}}},e.prototype.createAndStartApiEvent=function(e,t){var r=new we(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},e.prototype.stopAndFlushApiEvent=function(e,t,r,o){t.wasSuccessful=r,o&&(t.apiErrorCode=o),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,r,o){var n=new Ne(e,o);return n.url=r,n.httpMethod=t,this.startEvent(n),n},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,o=this.eventCountByCorrelationId[e.telemetryCorrelationId];o?o[r]=o[r]?o[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(r,o){if(-1!==o.indexOf(e)){var n=t.inProgressEvents[o];return delete t.inProgressEvents[o],r.concat([n])}return r},[])},e}(),Le=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter(function(e){var r=e.key.scopes.split(" "),o=E.removeDefaultScopes(t);return 0===o.length?E.containsScope(r,t):E.containsScope(r,o)})},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter(function(e){return x.CanonicalizeUri(e.key.authority)===t})},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter(function(e){return x.GetUrlComponents(e.key.authority).HostNameAndPort===t})},e}(),Ue=function(){function e(e){var t,r,o,n,i,s,a,c;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(r=(t=e).auth,n=void 0===(o=t.cache)?{}:o,s=void 0===(i=t.system)?{}:i,c=void 0===(a=t.framework)?{}:a,{auth:l.a({},Q,r),cache:l.a({},J,n),system:l.a({},Y,s),framework:l.a({},X,c)}),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),N.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),G.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new $(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var d=window.location.hash,h=x.urlContainsHash(d);V.checkIfBackButtonIsPressed(this.cacheStorage),h&&this.getResponseState(d).method===u.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(d)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=G.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw I.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(u.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(u.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),x.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),e===u.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==u.interactionTypePopup)throw b.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),r(t)}},e.prototype.authErrorHandler=function(e,t,r,o){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(n.INTERACTION_STATUS),e===u.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r)}else{if(e!==u.interactionTypePopup)throw b.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),o(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=B.validateRequest(e,!0,this.clientId,u.interactionTypeRedirect);this.acquireTokenInteractive(u.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=B.validateRequest(e,!1,this.clientId,u.interactionTypeRedirect);this.acquireTokenInteractive(u.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=B.validateRequest(e,!0,this.clientId,u.interactionTypePopup),o=this.telemetryManager.createAndStartApiEvent(r.correlationId,ne.LoginPopup);return new Promise(function(e,o){t.acquireTokenInteractive(u.interactionTypePopup,!0,r,e,o)}).then(function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!1,e.errorCode),e})},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=B.validateRequest(e,!1,this.clientId,u.interactionTypePopup),o=this.telemetryManager.createAndStartApiEvent(r.correlationId,ne.AcquireTokenPopup);return new Promise(function(e,o){t.acquireTokenInteractive(u.interactionTypePopup,!1,r,e,o)}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!1,e.errorCode),e})},e.prototype.acquireTokenInteractive=function(e,t,r,o,i){var s=this;this.logger.verbose("AcquireTokenInteractive has been called"),V.blockReloadInHiddenIframes();var a,c=this.cacheStorage.getItem(n.INTERACTION_STATUS);if(e===u.interactionTypeRedirect&&this.cacheStorage.setItem(n.REDIRECT_REQUEST,""+u.inProgress+u.resourceDelimiter+r.state),c===u.inProgress){var l=t?b.createLoginInProgressError():b.createAcquireTokenInProgressError(),d=te(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,l,d,i)}if(r&&r.account&&!t?(a=r.account,this.logger.verbose("Account set from request")):(a=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a||R.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(a,e,t,r,o,i);else{if(!t)return this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required"),d=te(this.getAccountState(r.state)),this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,b.createUserLoginRequiredError(),d,i);if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var h=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(h).then(function(t){s.silentLogin=!1,s.logger.info("Unified cache call is successful"),s.authResponseHandler(e,t,o)},function(n){s.silentLogin=!1,s.logger.error("Error occurred during unified cache ATS: "+n),s.acquireTokenHelper(null,e,t,r,o,i)})}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,o,i)}},e.prototype.acquireTokenHelper=function(e,t,r,o,i,a){return l.b(this,void 0,void 0,function(){var c,d,h,p,f,g,m,y,w,k;return l.e(this,function(l){switch(l.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+r),this.cacheStorage.setItem(n.INTERACTION_STATUS,u.inProgress),c=o.scopes?o.scopes.join(" ").toLowerCase():u.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+c),h=o&&o.authority?G.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata):this.authorityInstance,l.label=1;case 1:return l.trys.push([1,11,,12]),h.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,G.saveMetadataFromNetwork(h,this.telemetryManager,o.correlationId)]);case 2:return l.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),l.label=4;case 4:if(f=r?"id_token":this.getTokenType(e,o.scopes),g=o.redirectStartPage||window.location.href,d=new R(h,this.clientId,f,this.getRedirectUri(o&&o.redirectUri),o.scopes,o.state,o.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(d,e,r,g),this.logger.verbose("Updating cache entries"),d.populateQueryParams(e,o),this.logger.verbose("Query parameters populated from account"),m=x.createNavigateUrl(d)+u.response_mode_fragment,t===u.interactionTypeRedirect)r?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem($.generateTemporaryCacheKey(n.STATE_ACQ_TOKEN,o.state),d.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+d.state));else{if(t!==u.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),b.createInvalidInteractionTypeError();window.renewStates.push(d.state),window.requestType=r?u.login:u.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+d.state),this.registerCallback(d.state,c,i,a)}if(t!==u.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{p=this.openPopup(m,"msal",u.popUpWidth,u.popUpHeight),V.trackPopup(p)}catch(e){if(this.logger.info("popup_window_error:"+v),this.cacheStorage.setItem(s.ERROR,"popup_window_error"),this.cacheStorage.setItem(s.ERROR_DESC,v),a)return a(b.createPopupWindowError()),[2]}if(!p)return[3,8];l.label=5;case 5:return l.trys.push([5,7,,8]),[4,V.monitorPopupForHash(p,this.config.system.loadFrameTimeout,m,this.logger)];case 6:return y=l.sent(),this.handleAuthenticationResponse(y),this.cacheStorage.removeItem(n.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",y),V.closePopups(),[3,8];case 7:return w=l.sent(),a&&a(w),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",w.errorCode+u.resourceDelimiter+w.errorMessage):(this.cacheStorage.removeItem(n.INTERACTION_STATUS),p.close()),[3,8];case 8:return[3,10];case 9:o.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==o.onRedirectNavigate(m)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(m)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(m)),l.label=10;case 10:return[3,12];case 11:return k=l.sent(),this.logger.error(k),this.cacheStorage.resetTempCacheItems(o.state),this.authErrorHandler(t,b.createEndpointResolutionError(k.toString),te(o.state),a),p&&p.close(),[3,12];case 12:return[2]}})})},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw I.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw I.createSsoSilentError();return this.acquireTokenSilent(l.a({},e,{scopes:u.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=B.validateRequest(e,!1,this.clientId,u.interactionTypeSilent),o=this.telemetryManager.createAndStartApiEvent(r.correlationId,ne.AcquireTokenSilent),n=B.createRequestSignature(r);return new Promise(function(e,o){return l.b(t,void 0,void 0,function(){var t,i,s,a,c,d,h,p,f,g,v;return l.e(this,function(l){switch(l.label){case 0:if(V.blockReloadInHiddenIframes(),t=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),r.account?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),s=this.cacheStorage.getItem(u.adalIdToken),!i&&!r.sid&&!r.loginHint&&m.isEmpty(s))return this.logger.info("User login is required"),[2,o(b.createUserLoginRequiredError())];if(a=this.getTokenType(i,r.scopes),this.logger.verbose("Response type: "+a),c=new R(G.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,a,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),R.isSSOParam(r)||i?(c.populateQueryParams(i,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):i||m.isEmpty(s)?this.logger.verbose("No additional query parameters added"):(d=j.extractIdToken(s),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),c.populateQueryParams(i,null,d,!0)),!(h=r.claimsRequest||c.claimsValue)&&!r.forceRefresh)try{f=this.getCachedToken(c,i)}catch(e){p=e}return f?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(f.scopes)),e(f),[2,null]):[3,1];case 1:return p?(this.logger.infoPii(p.errorCode+":"+p.errorMessage),o(p),[2,null]):[3,2];case 2:g=h?"Skipped cache lookup since claims were given":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(g),c.authorityInstance||(c.authorityInstance=r.authority?G.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+c.authority),l.label=3;case 3:return l.trys.push([3,7,,8]),c.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,G.saveMetadataFromNetwork(c.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return l.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),l.label=6;case 6:return window.activeRenewals[n]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[n],n,e,o)):r.scopes&&E.onlyContainsOidcScopes(r.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(n,e,o,i,c)):(this.logger.verbose("Renewing access token"),this.renewToken(n,e,o,i,c)),[3,8];case 7:return v=l.sent(),this.logger.error(v),o(b.createEndpointResolutionError(v.toString())),[2,null];case 8:return[2]}})})}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!1,e.errorCode),e})},e.prototype.openPopup=function(e,t,r,o){this.logger.verbose("OpenPopup has been called");try{var i=window.screenLeft?window.screenLeft:window.screenX,s=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=a/2-r/2+i,d=c/2-o/2+s,u=window.open(e,t,"width="+r+", height="+o+", top="+d+", left="+l+", scrollbars=yes");if(!u)throw b.createPopupWindowError();return u.focus&&u.focus(),u}catch(e){throw this.cacheStorage.removeItem(n.INTERACTION_STATUS),b.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return l.b(this,void 0,void 0,function(){var o,i,s,a,c;return l.e(this,function(l){switch(l.label){case 0:return o=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+o),this.cacheStorage.setItem($.generateTemporaryCacheKey(n.RENEW_STATUS,o),u.inProgress),this.config.system.navigateFrameWait?[4,V.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return s=l.sent(),[3,3];case 2:s=V.loadFrameSync(e,t,this.logger),l.label=3;case 3:i=s,l.label=4;case 4:return l.trys.push([4,6,,7]),[4,V.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(a=l.sent())&&this.handleAuthenticationResponse(a),[3,7];case 6:throw c=l.sent(),this.cacheStorage.getItem($.generateTemporaryCacheKey(n.RENEW_STATUS,o))===u.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,c),this.cacheStorage.removeItem($.generateTemporaryCacheKey(n.RENEW_STATUS,o))),V.removeHiddenIframe(i),c;case 7:return V.removeHiddenIframe(i),[2]}})})},e.prototype.navigateWindow=function(e,t){if(!e||m.isEmpty(e))throw this.logger.info("Navigate url is empty"),g.a.createUnexpectedError("Navigate url is empty");var r=t||window,o=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(o),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,o){var n=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:o}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,o){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(o)window.promiseMappedToRenewStates[e][i].reject(o);else{if(!r)throw n.cacheStorage.resetTempCacheItems(e),g.a.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(e){n.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return l.b(this,void 0,void 0,function(){var t,r,o,n,i,s;return l.e(this,function(a){switch(a.label){case 0:t=e||d.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,ne.Logout),this.clearCache(),this.account=null,a.label=1;case 1:return a.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,G.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return a.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),a.label=4;case 4:return o="client-request-id="+t,n=void 0,this.getPostLogoutRedirectUri()?(n="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(n="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),i=void 0,this.authorityInstance.EndSessionEndpoint?(i=this.authorityInstance.EndSessionEndpoint+"?"+o+n,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(i=this.authority+"oauth2/v2.0/logout?"+o+n,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(i),[3,6];case 5:return s=a.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,s.errorCode),[3,6];case 6:return[2]}})})},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(u.clientId,u.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(u.clientId,u.homeAccountIdentifier),r=0;r<t.length;r++){var o=t[r];o.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(o.key)),this.logger.verbosePii("Access token removed: "+o.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),x.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){var n,i;this.logger.info("ProcessCallBack has been called. Processing callback from redirect response"),t||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),t=this.getResponseState(e));try{n=this.saveTokenFromHash(e,t)}catch(e){i=e}try{this.cacheStorage.clearMsalCookie(t.state);var s=this.getAccountState(t.state);if(n){if(t.requestType===u.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+o.ACCESS_TOKEN),n.tokenType=o.ACCESS_TOKEN):t.requestType===u.login&&(this.logger.verbose("Response tokenType set to "+o.ID_TOKEN),n.tokenType=o.ID_TOKEN),!r)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=n)}else if(!r)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=te(s),this.redirectError=i,void this.cacheStorage.resetTempCacheItems(t.state);this.logger.verbose("Calling callback provided to processCallback"),r(n,i)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),b.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var o=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,o)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),V.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem($.generateTemporaryCacheKey(n.LOGIN_REQUEST,t.state),this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var o=x.removeHashFromUrl(window.location.href),i=x.removeHashFromUrl(r);if(o!==i)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+o+", finalRedirectUrl: "+i),void window.location.assign(""+i+e);this.logger.verbose("Current url matches login request url");var s=x.GetUrlComponents(r);s.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=s.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,r=x.deserializeHash(e);if(!r)throw g.a.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(o.STATE))throw g.a.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var i=B.parseLibraryState(r.state);if((t={requestType:u.unknown,state:r.state,timestamp:i.ts,method:i.method,stateMatch:!1}).state===this.cacheStorage.getItem($.generateTemporaryCacheKey(n.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=u.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem($.generateTemporaryCacheKey(n.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=u.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var s=window.renewStates,a=0;a<s.length;a++)if(s[a]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=e.scopes,o=this.getCachedIdToken(e,t),n=this.getCachedAccessToken(e,t,r),i=this.getAccountState(e.state);return K.buildAuthResponse(o,n,e,t,r,i)},e.prototype.getTokenCacheItemByAuthority=function(e,t,r,o){var n,i=this;return 1===(n=x.isCommonAuthority(e)||x.isOrganizationsAuthority(e)||x.isConsumersAuthority(e)?Le.filterTokenCacheItemsByDomain(t,x.GetUrlComponents(e).HostNameAndPort):Le.filterTokenCacheItemsByAuthority(t,e)).length?n[0]:n.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),n.forEach(function(e){i.cacheStorage.removeItem(JSON.stringify(e.key))}),null):(this.logger.verbose("No matching tokens of type "+o+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var r=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),n=e.authority||this.authority,i=this.getTokenCacheItemByAuthority(n,r,null,o.ID_TOKEN);if(i){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(i)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var s=i.value;return s?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),s?new H(s.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(i.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,r){this.logger.verbose("Getting all cached tokens of type Access Token");var n=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),i=Le.filterTokenCacheItemsByScope(n,r),s=e.authority||this.authority,a=this.getTokenCacheItemByAuthority(s,i,r,o.ACCESS_TOKEN);if(a){if(e.authorityInstance=G.CreateInstance(a.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(a)){if(this.logger.verbose("Access token expiration is within offset, using access token found in cache"),!t&&!(t=this.getAccount()))throw g.a.createUnexpectedError("Account should not be null here.");var c=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:o.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:a.value.accessToken,scopes:a.key.scopes.split(" "),expiresOn:new Date(1e3*Number(a.value.expiresIn)),account:t,accountState:c,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(a.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return j.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(u.adalIdToken);return m.isEmpty(e)?null:j.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,o,n){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var i=V.generateFrameName("msalRenewFrame",e);V.addHiddenIFrame(i,this.logger),this.updateCacheEntries(n,o,!1),this.logger.verbosePii("RenewToken expected state: "+n.state);var s=x.urlRemoveQueryStringParameter(x.createNavigateUrl(n),u.prompt)+u.prompt_none+u.response_mode_fragment;window.renewStates.push(n.state),window.requestType=u.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(n.state,e,t,r),this.logger.infoPii("Navigate to: "+s),this.loadIframeTimeout(s,i,e).catch(function(e){return r(e)})},e.prototype.renewIdToken=function(e,t,r,o,n){this.logger.info("RenewIdToken has been called");var i=V.generateFrameName("msalIdTokenFrame",e);V.addHiddenIFrame(i,this.logger),this.updateCacheEntries(n,o,!1),this.logger.verbose("RenewIdToken expected state: "+n.state);var s=x.urlRemoveQueryStringParameter(x.createNavigateUrl(n),u.prompt)+u.prompt_none+u.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=u.login,this.silentAuthenticationState=n.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=u.renewToken,window.renewStates.push(n.state)),this.registerCallback(n.state,e,t,r),this.logger.infoPii('Navigate to:" '+s),this.loadIframeTimeout(s,i,e).catch(function(e){return r(e)})},e.prototype.saveToken=function(e,t,r,o,n){var i=new O(t,this.clientId,r,o.uid,o.utid),s=new A(e.accessToken,e.idToken.rawIdToken,n.toString(),o.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(i),JSON.stringify(s)),n?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*n)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,r,n,i){this.logger.verbose("SaveIdToken has been called");var s=l.a({},e);s.scopes=u.oidcScopes,s.accessToken=r[o.ID_TOKEN];var a=Number(i.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(s,t,void 0,n,a)},e.prototype.saveAccessToken=function(e,t,r,n){this.logger.verbose("SaveAccessToken has been called");var i=l.a({},e),s=r[o.SCOPE],a=s.split(" "),c=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var d=0;d<c.length;d++){var u=c[d];if(u.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var h=u.key.scopes.split(" ");E.isIntersectingScopes(h,a)&&this.cacheStorage.removeItem(JSON.stringify(u.key))}}i.accessToken=r[o.ACCESS_TOKEN],i.scopes=a;var p=M.parseExpiresIn(r[o.EXPIRES_IN]),f=B.parseLibraryState(r[o.STATE]).ts+p;return this.logger.verbose("Saving access token to cache"),this.saveToken(i,t,s,n,f)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r,a={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},c=x.deserializeHash(e),l="",d="",p=null;if(c.hasOwnProperty(o.ERROR_DESCRIPTION)||c.hasOwnProperty(o.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+c[o.ERROR]+"; Error description: "+c[o.ERROR_DESCRIPTION]),this.cacheStorage.setItem(s.ERROR,c[o.ERROR]),this.cacheStorage.setItem(s.ERROR_DESC,c[o.ERROR_DESCRIPTION]),t.requestType===u.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(s.LOGIN_ERROR,c[o.ERROR_DESCRIPTION]+":"+c[o.ERROR]),l=$.generateAuthorityKey(t.state)),t.requestType===u.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),l=$.generateAuthorityKey(t.state);var f=this.getAccount(),v=void 0;f&&!m.isEmpty(f.homeAccountIdentifier)?(v=f.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(v=u.no_account,this.logger.verbose("AccountId is set as no_account")),d=$.generateAcquireTokenAccountKey(v,t.state)}var y=c[o.ERROR],w=c[o.ERROR_DESCRIPTION];r=ee.a.isInteractionRequiredError(y)||ee.a.isInteractionRequiredError(w)?new ee.a(c[o.ERROR],c[o.ERROR_DESCRIPTION]):new Z.a(c[o.ERROR],c[o.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),c.hasOwnProperty(o.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem($.generateTemporaryCacheKey(n.SESSION_STATE,t.state),c[o.SESSION_STATE])),a.accountState=this.getAccountState(t.state);var k=void 0;if(c.hasOwnProperty(o.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),a.accessToken=c[o.ACCESS_TOKEN],c.hasOwnProperty(o.SCOPE)&&(a.scopes=c[o.SCOPE].split(" ")),c.hasOwnProperty(o.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),p=new H(c[o.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),p=new H(this.cacheStorage.getItem(i.IDTOKEN))),a=K.setResponseIdToken(a,p);var C=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,p);this.logger.verbose("Got authority from cache"),c.hasOwnProperty(o.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),k=new U(c[o.CLIENT_INFO],C)):this.authorityInstance.AuthorityType===h.Adfs?k=U.createClientInfoFromIdToken(p,C):this.logger.warning("ClientInfo not received in the response from AAD"),a.account=z.createAccount(p,k),this.logger.verbose("Account object created from response");var T=void 0;a.account&&!m.isEmpty(a.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),T=a.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),T=u.no_account),d=$.generateAcquireTokenAccountKey(T,t.state);var S=$.generateAcquireTokenAccountKey(u.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var _=this.cacheStorage.getItem(d),I=void 0;m.isEmpty(_)?m.isEmpty(this.cacheStorage.getItem(S))||(this.logger.verbose("No acquireToken account retrieved from cache"),a=this.saveAccessToken(a,C,c,k)):(I=JSON.parse(_),this.logger.verbose("AcquireToken request account retrieved from cache"),a.account&&I&&z.compareAccounts(a.account,I)?(a=this.saveAccessToken(a,C,c,k),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(c.hasOwnProperty(o.ID_TOKEN))if(this.logger.info("Fragment has idToken"),p=new H(c[o.ID_TOKEN]),C=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,p),a=K.setResponseIdToken(a,p),c.hasOwnProperty(o.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),k=new U(c[o.CLIENT_INFO],C)):this.authorityInstance.AuthorityType===h.Adfs?k=U.createClientInfoFromIdToken(p,C):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=z.createAccount(p,k),a.account=this.account,this.logger.verbose("Account object created from response"),p&&p.nonce){this.logger.verbose("IdToken has nonce");var E=this.cacheStorage.getItem($.generateTemporaryCacheKey(n.NONCE_IDTOKEN,t.state),this.inCookie);p.nonce!==E?(this.account=null,this.cacheStorage.setItem(s.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+E+",Actual Nonce: "+p.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+E+", Actual Nonce: "+p.nonce),r=b.createNonceMismatchError(E,p.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(i.IDTOKEN,c[o.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(i.CLIENT_INFO,k.encodeClientInfo(),this.inCookie),this.saveIdToken(a,C,c,k,p))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),l=t.state,d=t.state,this.logger.error("Invalid id_token received in the response"),r=b.createInvalidIdTokenError(p),this.cacheStorage.setItem(s.ERROR,r.errorCode),this.cacheStorage.setItem(s.ERROR_DESC,r.errorMessage)}else{this.logger.verbose("State mismatch"),l=t.state,d=t.state;var O=this.cacheStorage.getItem($.generateTemporaryCacheKey(n.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+O+", Actual State: "+t.state),r=b.createInvalidStateError(t.state,O),this.cacheStorage.setItem(s.ERROR,r.errorCode),this.cacheStorage.setItem(s.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem($.generateTemporaryCacheKey(n.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(l,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!a)throw g.a.createUnexpectedError("Response is null");return a},e.prototype.populateAuthority=function(e,t,r,o){this.logger.verbose("PopulateAuthority has been called");var n=$.generateAuthorityKey(e),i=r.getItem(n,t);return m.isEmpty(i)?i:x.replaceTenantPath(i,o.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(i.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(i.CLIENT_INFO,this.inCookie);if(!m.isEmpty(e)&&!m.isEmpty(t)){var r=new H(e),o=new U(t,"");return this.account=z.createAccount(r,o),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(u.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(u.clientId,u.homeAccountIdentifier),r=0;r<t.length;r++){var o=new H(t[r].value.idToken),n=new U(t[r].value.homeAccountIdentifier,""),i=z.createAccount(o,n);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],o=0;o<e.length;++o)e[o].homeAccountIdentifier&&-1===t.indexOf(e[o].homeAccountIdentifier)&&(t.push(e[o].homeAccountIdentifier),r.push(e[o]));return r},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,o){var n=t||this.getAccount();if(!n)return null;var i=this.authorityInstance?this.authorityInstance:G.CreateInstance(this.authority,this.config.auth.validateAuthority),s=this.getTokenType(n,e),a=new R(i,this.clientId,s,this.getRedirectUri(),e,r,o);return this.getCachedToken(a,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,o=Array.from(this.config.framework.protectedResourceMap.keys());r<o.length;r++){var n=o[r];if(e.indexOf(n)>-1)return this.config.framework.protectedResourceMap.get(n)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?x.getHostFromUri(e)===x.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(n.INTERACTION_STATUS)===u.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(n.INTERACTION_STATUS,u.inProgress):this.cacheStorage.removeItem(n.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(n.INTERACTION_STATUS)===u.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw I.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var r=z.compareAccounts(e,this.getAccount());return R.determineResponseType(r,t)},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):u.no_account,o=$.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(o,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=$.generateAuthorityKey(e);this.cacheStorage.setItem(r,x.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r,o){o&&this.cacheStorage.setItem($.generateTemporaryCacheKey(n.LOGIN_REQUEST,e.state),o,this.inCookie),r?this.cacheStorage.setItem($.generateTemporaryCacheKey(n.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem($.generateTemporaryCacheKey(n.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return m.isEmpty(e.homeAccountIdentifier)?u.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:u.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return De.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,o=e.applicationVersion,n=e.telemetryEmitter;if(!r||!o||!n)throw I.createTelemetryConfigError(e);return new De({platform:{applicationName:r,applicationVersion:o},clientId:t},n,this.logger)},e}(),Me=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};class je extends c.IProvider{constructor(e){super(),this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.initProvider(e)}get userAgentApplication(){return this._userAgentApplication}get name(){return"MgtMsalProvider"}trySilentSignIn(){return Me(this,void 0,void 0,function*(){try{if(this._userAgentApplication.isCallback(window.location.hash))return;this._userAgentApplication.getAccount()&&(yield this.getAccessToken(null))?this.setState(c.ProviderState.SignedIn):this.setState(c.ProviderState.SignedOut)}catch(e){this.setState(c.ProviderState.SignedOut)}})}login(e){return Me(this,void 0,void 0,function*(){let t=e||{loginHint:this._loginHint,scopes:this.scopes};if(this._prompt&&(t.prompt=this._prompt),this._domainHint&&(t.extraQueryParameters={domain_hint:this._domainHint}),this._loginType===c.LoginType.Popup){const e=yield this._userAgentApplication.loginPopup(t);this.setState(e.account?c.ProviderState.SignedIn:c.ProviderState.SignedOut)}else this._userAgentApplication.loginRedirect(t)})}logout(){return Me(this,void 0,void 0,function*(){this._userAgentApplication.logout(),this.setState(c.ProviderState.SignedOut)})}getAccessToken(e){return Me(this,void 0,void 0,function*(){const t=e&&e.scopes||this.scopes,r={loginHint:this._loginHint,scopes:t};this._domainHint&&(r.extraQueryParameters={domain_hint:this._domainHint});try{return(yield this._userAgentApplication.acquireTokenSilent(r)).accessToken}catch(e){if(!this.requiresInteraction(e))throw this.setState(c.ProviderState.SignedOut),e;if(this._loginType===c.LoginType.Redirect){if(this.areScopesDenied(t))throw e;this.setRequestedScopes(t),this._userAgentApplication.acquireTokenRedirect(r)}else try{return(yield this._userAgentApplication.acquireTokenPopup(r)).accessToken}catch(e){throw e}}throw null})}updateScopes(e){this.scopes=e}requiresInteraction(e){return!(!e||!e.errorCode||-1===e.errorCode.indexOf("consent_required")&&-1===e.errorCode.indexOf("interaction_required")&&-1===e.errorCode.indexOf("login_required"))}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}getRequestedScopes(){const e=sessionStorage.getItem(this.sessionStorageRequestedScopesKey);return e?JSON.parse(e):null}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let r=t.indexOf("openid");-1!==r&&t.splice(r,1),r=t.indexOf("profile"),-1!==r&&t.splice(r,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){const e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){const t=this.getDeniedScopes();if(t&&t.filter(t=>-1!==e.indexOf(t)).length>0)return!0}return!1}initProvider(e){let t,r;if(this.scopes=void 0!==e.scopes?e.scopes:["user.read"],this._loginType=void 0!==e.loginType?e.loginType:c.LoginType.Redirect,this._loginHint=e.loginHint,this._domainHint=e.domainHint,this._prompt=void 0!==e.prompt?e.prompt:"select_account","clientId"in e){if(!e.clientId)throw new Error("clientId must be provided");{const o=e.options||{auth:{clientId:e.clientId}};o.auth.clientId=e.clientId,o.cache=o.cache||{},o.cache.cacheLocation=o.cache.cacheLocation||"localStorage",void 0!==o.cache.storeAuthStateInCookie&&null!==o.cache.storeAuthStateInCookie||(o.cache.storeAuthStateInCookie=!0),e.authority&&(o.auth.authority=e.authority),e.redirectUri&&(o.auth.redirectUri=e.redirectUri),r=e.clientId,t=new Ue(o)}}else{if(!("userAgentApplication"in e))throw new Error("either clientId or userAgentApplication must be provided");if(!e.userAgentApplication)throw new Error("userAgentApplication must be provided");t=e.userAgentApplication,r=t.getCurrentConfiguration().auth.clientId}this.clientId=r,this._userAgentApplication=t,this._userAgentApplication.handleRedirectCallback(e=>this.tokenReceivedCallback(e),(e,t)=>this.errorReceivedCallback(e,t)),this.graph=Object(c.createFromProvider)(this),this.trySilentSignIn()}tokenReceivedCallback(e){"id_token"===e.tokenType&&this.setState(c.ProviderState.SignedIn),this.clearRequestedScopes()}errorReceivedCallback(e,t){const r=this.getRequestedScopes();r&&this.addDeniedScopes(r),this.clearRequestedScopes()}}var He=r("hkiJ"),Fe=function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},qe=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Be=class extends c.MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const e={clientId:this.clientId,domainHint:this.domainHint,prompt:this.prompt};if(this.loginType&&this.loginType.length>1){let t=this.loginType.toLowerCase();t=t[0].toUpperCase()+t.slice(1);const r=c.LoginType[t];e.loginType=r}if(this.authority&&(e.authority=this.authority),this.scopes){const t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}this.redirectUri&&(e.redirectUri=this.redirectUri),this.provider=new je(e),c.Providers.globalProvider=this.provider}}};Fe([Object(He.f)({attribute:"client-id",type:String}),qe("design:type",Object)],Be.prototype,"clientId",void 0),Fe([Object(He.f)({attribute:"login-type",type:String}),qe("design:type",Object)],Be.prototype,"loginType",void 0),Fe([Object(He.f)(),qe("design:type",Object)],Be.prototype,"authority",void 0),Fe([Object(He.f)({attribute:"scopes",type:String}),qe("design:type",Object)],Be.prototype,"scopes",void 0),Fe([Object(He.f)({attribute:"redirect-uri",type:String}),qe("design:type",Object)],Be.prototype,"redirectUri",void 0),Fe([Object(He.f)({attribute:"domain-hint",type:String}),qe("design:type",Object)],Be.prototype,"domainHint",void 0),Fe([Object(He.f)({attribute:"prompt",type:String}),qe("design:type",Object)],Be.prototype,"prompt",void 0),Be=Fe([Object(He.c)("mgt-msal-provider")],Be)},zEAF:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var o=r("cmRh"),n=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})};class i extends o.IProvider{constructor(e){super(),e.aadTokenProviderFactory.getTokenProvider().then(e=>{this._provider=e,this.graph=Object(o.createFromProvider)(this),this.internalLogin()})}get provider(){return this._provider}get isLoggedIn(){return!!this._idToken}get name(){return"MgtSharePointProvider"}getAccessToken(){return n(this,void 0,void 0,function*(){let e;try{e=yield this.provider.getToken("https://graph.microsoft.com")}catch(e){throw e}return e})}updateScopes(e){this.scopes=e}internalLogin(){return n(this,void 0,void 0,function*(){this._idToken=yield this.getAccessToken(),this.setState(this._idToken?o.ProviderState.SignedIn:o.ProviderState.SignedOut)})}}},zKI9:function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return s});const o={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},n="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types";function i(e,t,r){const i=o[e]||"genericfile";return`${n}/${t.toString()}/${i}.${r}`}function s(e,t,r){return Object.keys(o).find(t=>o[t]===e)?`${n}/${t.toString()}/${e}.${r}`:"jpg"===e||"png"===e?(e="photo",`${n}/${t.toString()}/${e}.${r}`):null}},zUnT:function(e,t,r){"use strict";r.d(t,"c",function(){return n}),r.d(t,"d",function(){return i}),r.d(t,"e",function(){return s}),r.d(t,"a",function(){return a}),r.d(t,"b",function(){return c});var o=r("2cRh");const n=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},i=(e,t,r)=>{let o=null;if("undefined"!=typeof Request&&e instanceof Request)o=e.headers.get(r);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)o=t.headers.get(r);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,n=e.length;t<n;t++)if(e[t][0]===r){o=e[t][1];break}}else void 0!==t.headers[r]&&(o=t.headers[r]);return o},s=(e,t,r,o)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(r,o);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[r]:o});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(r,o);else if(t.headers instanceof Array){let e=0;const n=t.headers.length;for(;e<n;e++){const n=t.headers[e];if(n[0]===r){n[1]=o;break}}e===n&&t.headers.push([r,o])}else Object.assign(t.headers,{[r]:o})},a=(e,t,r,o)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(r,o):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[r]:o}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(r,o):t.headers instanceof Array?t.headers.push([r,o]):void 0===t.headers?t.headers={[r]:o}:void 0===t.headers[r]?t.headers[r]=o:t.headers[r]+=", "+o)},c=(e,t)=>o.b(void 0,void 0,void 0,function*(){const r=t.headers.get("Content-Type")?yield t.blob():yield Promise.resolve(void 0),{method:o,headers:n,referrer:i,referrerPolicy:s,mode:a,credentials:c,cache:l,redirect:d,integrity:u,keepalive:h,signal:p}=t;return new Request(e,{method:o,headers:n,body:r,referrer:i,referrerPolicy:s,mode:a,credentials:c,cache:l,redirect:d,integrity:u,keepalive:h,signal:p})})}}]);