(window.webpackJsonp_2ea4494a4801c9aca03bba9314014278=window.webpackJsonp_2ea4494a4801c9aca03bba9314014278||[]).push([[25],{"+OTn":function(e,t,n){"use strict";n.r(t),n.d(t,"SharePointSuggestionProvider",function(){return s});var a=n("UDSP"),i=n("lWUY"),r=n("PqB8"),o=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})};class s extends a.BaseSuggestionProvider{onInit(){return o(this,void 0,void 0,function*(){this.serviceScope.whenFinished(()=>{this._searchService=this.serviceScope.consume(i.e.ServiceKey)})})}get isZeroTermSuggestionsEnabled(){return!1}getSuggestions(e){return o(this,void 0,void 0,function*(){return(yield this._searchService.suggest(e)).map(e=>({displayText:e,groupName:r.SuggestionProviders.SharePointStatic.ProviderName}))})}getPropertyPaneGroupsConfiguration(){return[]}}},WVJB:function(e,t,n){"use strict";class a{static getLocaleId(e){if(this.isInt(e))return parseInt(e);const t=Object.keys(a.locales).filter(t=>0===a.locales[t].toLocaleLowerCase().indexOf(e.toLocaleLowerCase()));return t.length>0?parseInt(t[0]):0}static isInt(e){var t=parseFloat(e);return!isNaN(e)&&(0|t)===t}}a.locales={1025:"ar-SA",1026:"bg-BG",1027:"ca-ES",1028:"zh-TW",1029:"cs-CZ",1030:"da-DK",1031:"de-DE",1032:"el-GR",1033:"en-US",1035:"fi-FI",1036:"fr-FR",1037:"he-IL",1038:"hu-HU",1040:"it-IT",1041:"ja-JP",1042:"ko-KR",1043:"nl-NL",1044:"nb-NO",1045:"pl-PL",1046:"pt-BR",1048:"ro-RO",1049:"ru-RU",1050:"hr-HR",1051:"sk-SK",1053:"sv-SE",1054:"th-TH",1055:"tr-TR",1057:"id-ID",1058:"uk-UA",1060:"sl-SI",1061:"et-EE",1062:"lv-LV",1063:"lt-LT",1066:"vi-VN",1068:"az-Latn-AZ",1069:"eu-ES",1071:"mk-MK",1081:"hi-IN",1086:"ms-MY",1087:"kk-KZ",1106:"cy-GB",1110:"gl-ES",1164:"prs-AF",2052:"zh-CN",2070:"pt-PT",2074:"sr-Latn-CS",2108:"ga-IE",3082:"es-ES",5146:"bs-Latn-BA",9242:"sr-Latn-RS",10266:"sr-Cyrl-RS"},t.e=a},lWUY:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n("UWqr"),i=n("vlQI"),r=n("eGXB"),o=n("Akhn"),s=n("X+PM"),c=n("Pk8u"),d=n("UDSP"),l=n("WVJB"),u=n("q5kO"),f=n("rMgv"),p=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})};const m="pnpSearchResults_AvailableQueryLanguages";class _{constructor(e){this.serviceScope=e,this.clientStorage=new r.e,e.whenFinished(()=>p(this,void 0,void 0,function*(){this.pageContext=e.consume(s.PageContext.serviceKey),this.spHttpClient=e.consume(i.SPHttpClient.serviceKey),this.searchEndpointUrl=`${this.pageContext.web.absoluteUrl}/_api/search/postquery`}))}search(e){return p(this,void 0,void 0,function*(){let t={queryKeywords:e.Querytext,refinementResults:[],relevantResults:[],secondaryResults:[],totalRows:0};try{const n=yield this.spHttpClient.post(this.searchEndpointUrl,i.SPHttpClient.configurations.v1,{body:this.getRequestPayload(e),headers:{"odata-version":"3.0",accept:"application/json;odata=nometadata","X-ClientService-ClientTag":f.t.X_CLIENTSERVICE_CLIENTTAG,UserAgent:f.t.X_CLIENTSERVICE_CLIENTTAG}});if(n.ok){const e=yield n.json();if(e.PrimaryQueryResult){let n=[];const a=e.PrimaryQueryResult.RelevantResults.Properties.filter(e=>"QueryModification"===e.Key);1===a.length&&(t.queryModification=a[0].Value);const i=e.PrimaryQueryResult.RelevantResults.Table.Rows;let r=e.PrimaryQueryResult.RefinementResults;const o=r?r.Refiners:[];let s=this.getSearchResults(i);o.forEach(e=>{let t=[];e.Entries.forEach(e=>{t.push({count:parseInt(e.RefinementCount,10),name:e.RefinementValue.replace("string;#",""),value:e.RefinementToken,operator:d.FilterComparisonOperator.Contains})}),n.push({filterName:e.Name,values:t})}),t.relevantResults=s,t.refinementResults=n,t.totalRows=e.PrimaryQueryResult.RelevantResults.TotalRows,Object(c.isEmpty)(e.SpellingSuggestion)||(t.spellingSuggestion=e.SpellingSuggestion)}if(e.SecondaryQueryResults){const n=e.SecondaryQueryResults;if(Array.isArray(n)&&n.length>0){let e=[],a=[];n.forEach(t=>{if(t.SpecialTermResults&&t.SpecialTermResults.Results.forEach(t=>{e.push({title:t.Title,url:t.Url,description:t.Description})}),t.RelevantResults){const e=this.getSearchResults(t.RelevantResults.Table.Rows),n={title:t.RelevantResults.ResultTitle,results:e};n.results.length>0&&a.push(n)}}),t.promotedResults=e,t.secondaryResults=a}}return t}throw new Error(`${n.statusMessage}`)}catch(e){throw a.Log.error("[SharePointSearchService.search()]",e,this.serviceScope),e}})}getAvailableManagedProperties(){return p(this,void 0,void 0,function*(){let e=[],t={Querytext:"*",Refiners:"ManagedProperties(filter=50000/0/*,sort=name/ascending)",RowLimit:1};t.SortList=[{Property:"[DocId]",Direction:u.e.Ascending}];try{const n=yield this.spHttpClient.post(this.searchEndpointUrl,i.SPHttpClient.configurations.v1,{body:this.getRequestPayload(t),headers:{"odata-version":"3.0",accept:"application/json;odata=nometadata"}});if(!n.ok)throw new Error(`${n.statusMessage}`);{const t=(yield n.json()).PrimaryQueryResult.RefinementResults;(t?t.Refiners:[]).forEach(t=>{t.Entries.forEach(t=>{e.push({name:t.RefinementName})})})}}catch(e){throw a.Log.error("[SharePointSearchService.getAvailableManagedProperties()]",e,this.serviceScope),e}return e})}getAvailableQueryLanguages(){return p(this,void 0,void 0,function*(){try{this.clientStorage.local.deleteExpired();let e=this.clientStorage.local.get(m);if(e)return Promise.resolve(e);{const t=yield this.spHttpClient.get(`${this.pageContext.web.absoluteUrl}/_api/web/RegionalSettings/InstalledLanguages`,i.SPHttpClient.configurations.v1,{headers:{"X-ClientService-ClientTag":f.t.X_CLIENTSERVICE_CLIENTTAG,UserAgent:f.t.X_CLIENTSERVICE_CLIENTTAG}});if(t.ok)return e=yield t.json(),this.clientStorage.local.put(m,e.Items,Object(o.e)(new Date,"week",1)),e.Items;throw new Error(`${t.statusMessage}`)}}catch(e){throw a.Log.error("[SharePointSearchService._getQueryLanguages()]",e,this.serviceScope),new Error(e)}})}validateSortableProperty(e){return p(this,void 0,void 0,function*(){let t=!1,n={Querytext:"*"};n.SortList=[{Property:e,Direction:u.e.Ascending}],n.RowLimit=1,n.SelectProperties=["Path"];try{t=!!(yield this.spHttpClient.post(this.searchEndpointUrl,i.SPHttpClient.configurations.v1,{body:this.getRequestPayload(n),headers:{"odata-version":"3.0",accept:"application/json;odata=nometadata","X-ClientService-ClientTag":f.t.X_CLIENTSERVICE_CLIENTTAG,UserAgent:f.t.X_CLIENTSERVICE_CLIENTTAG}})).ok}catch(e){t=!1}return t})}suggest(e){return p(this,void 0,void 0,function*(){let t=[];const n={preQuery:!0,queryText:encodeURIComponent(e.replace(/'/g,"''")),count:10,hitHighlighting:!0,prefixMatch:!0,culture:l.e.getLocaleId(this.pageContext.cultureInfo.currentUICultureName).toString(),numberOfQuerySuggestions:10,capitalize:!1};try{const e=a.Text.format(`${this.pageContext.web.absoluteUrl}/_api/search/suggest?querytext='{0}'&inumberofquerysuggestions={1}&fHitHighlighting={2}&fCapitalizeFirstLetters={3}&Culture={4}&fPrefixMatchAllTerms={5}`,n.queryText,n.numberOfQuerySuggestions,n.hitHighlighting,n.capitalize,n.culture,n.prefixMatch),r=yield this.spHttpClient.get(e,i.SPHttpClient.configurations.v1,{headers:{"X-ClientService-ClientTag":f.t.X_CLIENTSERVICE_CLIENTTAG,UserAgent:f.t.X_CLIENTSERVICE_CLIENTTAG}});if(r.ok){const e=yield r.json();return e.Queries.length>0&&(t=e.Queries.map(e=>e.Query)),t}throw new Error(`${r.statusMessage}`)}catch(e){throw a.Log.error("[SharePointSearchService.suggest()]",e,this.serviceScope),e}})}getSearchResults(e){return e.map(e=>{let t={};return e.Cells.map(e=>{"HtmlFileType"===e.Key&&e.Value?t.FileType=e.Value:t[e.Key]||(t[e.Key]=e.Value)}),t})}getRequestPayload(e){let t=Object(c.cloneDeep)(e);t.HitHighlightedProperties=this.fixArrProp(t.HitHighlightedProperties),t.Properties=this.fixArrProp(t.Properties),t.RefinementFilters=this.fixArrProp(t.RefinementFilters),t.ReorderingRules=this.fixArrProp(t.ReorderingRules),t.SelectProperties=this.fixArrProp(t.SelectProperties),t.SortList=this.fixArrProp(t.SortList);const n={request:Object.assign({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)};return JSON.stringify(n)}fixArrProp(e){return void 0===e?{results:[]}:{results:Array.isArray(e)?e:[e]}}}_.ServiceKey=a.ServiceKey.create("pnpSearchResults:SharePointSearchService",_)},q5kO:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(a||(a={}))}}]);