(window.webpackJsonp_1a86ce4e35bac7ae60ca710fe0988d33=window.webpackJsonp_1a86ce4e35bac7ae60ca710fe0988d33||[]).push([[159],{IZhc:function(e,t,r){"use strict";var o;r.d(t,"a",function(){return o}),function(e){e[e.Ascending=1]="Ascending",e[e.Descending=2]="Descending"}(o||(o={}))},aFY1:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var o=r("26ea"),n=r("cDcd"),a=r("faye"),i=r("hO2E"),s=function(){function e(e,t){this.type=o.PropertyPaneFieldType.Custom,this.targetProperty=e,this.properties={key:t.label,label:t.label,description:t.description,onPropertyChange:t.onPropertyChange,onGetErrorMessage:t.onGetErrorMessage,allowMultiSelect:t.allowMultiSelect,allowFreeform:t.allowFreeform,defaultSelectedKey:t.defaultSelectedKey,availableOptions:t.availableOptions,onUpdateOptions:t.onUpdateOptions,searchAsYouType:t.searchAsYouType,onLoadOptions:t.onLoadOptions,defaultSelectedKeys:t.defaultSelectedKeys,textDisplayValue:t.textDisplayValue,disabled:t.disabled,stateKey:t.stateKey,placeholder:t.placeholder,onRender:this.onRender.bind(this),onDispose:this.onDispose.bind(this)}}return e.prototype.render=function(){this.elem&&this.onRender(this.elem)},e.prototype.onDispose=function(e){a.unmountComponentAtNode(e)},e.prototype.onRender=function(e,t,r){var o=this;this.elem||(this.elem=e);var s=n.createElement("div",{key:this.properties.key},n.createElement(i.a,{label:this.properties.label,allowMultiSelect:this.properties.allowMultiSelect,allowFreeform:this.properties.allowFreeform,defaultSelectedKey:this.properties.defaultSelectedKey,availableOptions:this.properties.availableOptions,defaultSelectedKeys:this.properties.defaultSelectedKeys,textDisplayValue:this.properties.textDisplayValue,stateKey:this.properties.stateKey,description:this.properties.description,disabled:this.properties.disabled,placeholder:this.properties.placeholder,searchAsYouType:this.properties.searchAsYouType,onUpdate:function(e){o.properties.onPropertyChange(o.targetProperty,e)}.bind(this),onGetErrorMessage:this.properties.onGetErrorMessage,onLoadOptions:this.properties.onLoadOptions,onUpdateOptions:this.properties.onUpdateOptions}));a.render(s,e)},e}()},c0sA:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var o=r("2cRh"),n=r("cDcd"),a=r("rTF3"),i=r("rNQH"),s=r("g3hW"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.d)(t,e),t.prototype.render=function(){return n.createElement(s.a,Object(o.a)({},this.props,{primary:!0,onRenderDescription:a.a}))},Object(o.c)([Object(i.a)("PrimaryButton",["theme","styles"],!0)],t)}(n.Component)},g3hW:function(e,t,r){"use strict";r.d(t,"a",function(){return m});var o=r("2cRh"),n=r("cDcd"),a=r("dWAd"),i=r("rTF3"),s=r("rNQH"),l=r("/Syr"),u=r("Pnaz"),c=r("nMl8"),p=r("JF3e"),d=r("YEpX"),h=Object(u.b)(function(e,t,r){var n=Object(c.a)(e),a=Object(p.a)(e),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:l.d.semibold}};return Object(l.q)(n,i,r?function(e){var t,r,n,a,i,s,u,c,p,h=e.palette,m=e.semanticColors;return{root:{backgroundColor:m.primaryButtonBackground,border:"1px solid "+m.primaryButtonBackground,color:m.primaryButtonText,selectors:(t={},t[l.e]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},t["."+d.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:h.white}}},t)},rootHovered:{backgroundColor:m.primaryButtonBackgroundHovered,border:"1px solid "+m.primaryButtonBackgroundHovered,color:m.primaryButtonTextHovered,selectors:(r={},r[l.e]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},r)},rootPressed:{backgroundColor:m.primaryButtonBackgroundPressed,border:"1px solid "+m.primaryButtonBackgroundPressed,color:m.primaryButtonTextPressed,selectors:(n={},n[l.e]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},n)},rootExpanded:{backgroundColor:m.primaryButtonBackgroundPressed,color:m.primaryButtonTextPressed},rootChecked:{backgroundColor:m.primaryButtonBackgroundPressed,color:m.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:m.primaryButtonBackgroundPressed,color:m.primaryButtonTextPressed},rootDisabled:{selectors:(a={},a[l.e]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},a)},splitButtonContainer:{selectors:(i={},i[l.e]={border:"none"},i)},splitButtonDivider:Object(o.a)(Object(o.a)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),{backgroundColor:h.white,selectors:(s={},s[l.e]={backgroundColor:"Window"},s)}),splitButtonMenuButton:{backgroundColor:m.primaryButtonBackground,color:m.primaryButtonText,selectors:(u={},u[l.e]={backgroundColor:"WindowText"},u[":hover"]={backgroundColor:m.primaryButtonBackgroundHovered,selectors:(c={},c[l.e]={color:"Highlight"},c)},u)},splitButtonMenuButtonDisabled:{backgroundColor:m.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:m.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:m.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:m.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:m.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:m.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:m.primaryButtonText},splitButtonMenuIconDisabled:{color:h.neutralTertiary,selectors:(p={},p[l.e]={color:"GrayText"},p)}}}(e):function(e){var t,r,n,a,i,s=e.semanticColors,u=e.palette,c=s.buttonBackground,p=s.buttonBackgroundPressed,d=s.buttonBackgroundHovered,h=s.buttonText,m=s.buttonTextHovered,y=s.buttonTextChecked,f=s.buttonTextCheckedHovered;return{root:{backgroundColor:c,color:h},rootHovered:{backgroundColor:d,color:m,selectors:(t={},t[l.e]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:p,color:y},rootExpanded:{backgroundColor:p,color:y},rootChecked:{backgroundColor:p,color:y},rootCheckedHovered:{backgroundColor:p,color:f},rootDisabled:{selectors:(r={},r[l.e]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},r)},splitButtonContainer:{selectors:(n={},n[l.e]={border:"none"},n)},splitButtonMenuButton:{color:u.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:u.neutralLight,selectors:(a={},a[l.e]={color:"Highlight"},a)}}},splitButtonMenuButtonDisabled:{backgroundColor:s.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:s.buttonBackgroundDisabled}}},splitButtonDivider:Object(o.a)(Object(o.a)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),{backgroundColor:u.neutralTertiaryAlt,selectors:(i={},i[l.e]={backgroundColor:"WindowText"},i)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:u.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:u.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:u.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:u.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:s.buttonText},splitButtonMenuIconDisabled:{color:s.buttonTextDisabled}}}(e),a,t)}),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,r=void 0!==t&&t,s=e.styles,l=e.theme;return n.createElement(a.a,Object(o.a)({},this.props,{variantClassName:r?"ms-Button--primary":"ms-Button--default",styles:h(l,s,r),onRenderDescription:i.a}))},Object(o.c)([Object(s.a)("DefaultButton",["theme","styles"],!0)],t)}(n.Component)},nepr:function(e,t,r){"use strict";r.r(t),r.d(t,"BuiltinSourceIds",function(){return n}),r.d(t,"SharePointSearchDataSource",function(){return A});var o,n,a=r("cDcd"),i=r("MONU"),s=r("26ea"),l=r("PqB8"),u=r("UWqr"),c=r("Pk8u"),p=r("lWUY"),d=r("WVJB"),h=r("X+PM"),m=r("tDQZ"),y=r("LHku"),f=r("aFY1"),g=r("q5kO"),b=r("n0SO"),S=r.n(b),P=r("hO2E"),v=r("UqOl"),C=r("faye"),T=r("xeb6"),D=r("c0sA"),x=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),I=function(){return(I=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},B=function(e){function t(t){var r=e.call(this,t)||this;return r.state={value:t.defaultValue,iconName:null},r._onChange=r._onChange.bind(r),r._onApply=r._onApply.bind(r),r}return x(t,e),t.prototype.render=function(){var e=this.state.iconName?{iconProps:{iconName:this.state.iconName}}:null,t=!this.state.value&&!this.props.allowEmptyValue||Object(c.isEqual)(this.state.value,this.props.defaultValue);return a.createElement(a.Fragment,null,a.createElement(T.a,{defaultValue:this.props.defaultValue,label:this.props.label,placeholder:this.props.placeholderText,description:this.props.description,multiline:this.props.multiline,autoAdjustHeight:this.props.multiline,rows:this.props.rows?this.props.rows:4,onChange:this._onChange}),a.createElement(D.a,I({toggle:!0,styles:{root:{marginTop:8}},text:this.props.applyBtnText,onClick:this._onApply,allowDisabledFocus:!0,disabled:t,checked:!0},e)))},t.prototype.componentDidUpdate=function(e,t){Object(c.isEqual)(e.defaultValue,this.props.defaultValue)||this.setState({value:this.props.defaultValue})},t.prototype._onChange=function(e,t){this.setState({value:t,iconName:t!==this.props.defaultValue?"Save":null})},t.prototype._onApply=function(){this.props.onUpdate(this.state.value),this.setState({iconName:"Accept"})},t}(a.Component),k=function(){function e(e,t){this.type=s.PropertyPaneFieldType.Custom,this.targetProperty=e,this.properties={key:t.label,description:t.description,label:t.label,placeholderText:t.placeholderText,multiline:t.multiline,onRender:this.onRender.bind(this),onDispose:this.onDispose.bind(this),applyBtnText:t.applyBtnText,defaultValue:t.defaultValue,rows:t.rows,allowEmptyValue:t.allowEmptyValue}}return e.prototype.render=function(){this.elem&&this.onRender(this.elem)},e.prototype.onDispose=function(e){C.unmountComponentAtNode(e)},e.prototype.onRender=function(e,t,r){var o=this;this.elem||(this.elem=e);var n=a.createElement("div",{key:this.properties.key},a.createElement(B,{onUpdate:function(e){r(o.targetProperty,e)}.bind(this),description:this.properties.description,label:this.properties.label,multiline:this.properties.multiline,placeholderText:this.properties.placeholderText,applyBtnText:this.properties.applyBtnText,defaultValue:this.properties.defaultValue,rows:this.properties.rows,allowEmptyValue:this.properties.allowEmptyValue}));C.render(n,e)},e}(),L=r("VKB4"),E=r("/ED6"),w=r("IZhc"),_=function(){function e(){}return e.getEnumKeyByEnumValue=function(e,t){var r=Object.keys(e).filter(function(r){return e[r]==t});return r.length>0?r[0]:null},e}(),O=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),F=function(e,t,r,o){return new(r||(r=Promise))(function(n,a){function i(e){try{l(o.next(e))}catch(e){a(e)}}function s(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,s)}l((o=o.apply(e,t||[])).next())})},R=function(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};!function(e){e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1"}(n||(n={}));var A=function(e){function t(t){var r=e.call(this,t)||this;return r._availableLanguages=[],r._availableManagedProperties=[],r._resultSourcesOptions=[],r._propertyFieldCollectionData=null,r._customCollectionFieldType=null,r._propertyPaneWebPartInformation=null,t.whenFinished(function(){r._sharePointSearchService=t.consume(p.a.ServiceKey),r._pageContext=t.consume(h.PageContext.serviceKey),r._tokenService=t.consume(m.b.ServiceKey),r._taxonomyService=t.consume(y.a.ServiceKey)}),r}return O(t,e),t.prototype.onInit=function(){return F(this,void 0,void 0,function(){var e,t,o,n,a,i;return R(this,function(s){switch(s.label){case 0:return this.initProperties(),this.dateHelper=this.serviceScope.consume(v.a.ServiceKey),e=this,[4,this.dateHelper.moment()];case 1:return e.moment=s.sent(),this.editMode?[4,Promise.all([r.e(1),r.e(2),r.e(3),r.e(4),r.e(151)]).then(r.bind(null,"hgYt"))]:[3,4];case 2:return t=s.sent(),o=t.PropertyFieldCollectionData,n=t.CustomCollectionFieldType,[4,Promise.all([r.e(1),r.e(2),r.e(3),r.e(4),r.e(151)]).then(r.bind(null,"NdhV"))];case 3:a=s.sent().PropertyPaneWebPartInformation,this._propertyFieldCollectionData=o,this._customCollectionFieldType=n,this._propertyPaneWebPartInformation=a,s.label=4;case 4:return this._currentLocaleId=d.a.getLocaleId(this._pageContext.cultureInfo.currentUICultureName),0!=this._availableLanguages.length?[3,6]:[4,this._sharePointSearchService.getAvailableQueryLanguages()];case 5:i=s.sent(),this._availableLanguages=i.map(function(e){return{key:e.Lcid,text:e.DisplayName+" ("+e.Lcid+")"}}),s.label=6;case 6:return[2]}})})},t.prototype.getData=function(e){return F(this,void 0,void 0,function(){var t,r,o,n,a;return R(this,function(i){switch(i.label){case 0:return[4,this.buildSharePointSearchQuery(e)];case 1:return t=i.sent(),[4,this._sharePointSearchService.search(t)];case 2:return r=i.sent(),o={items:r.relevantResults,filters:r.refinementResults,queryModification:r.queryModification,secondaryResults:r.secondaryResults,spellingSuggestion:r.spellingSuggestion,promotedResults:r.promotedResults},this.properties.enableLocalization?[4,this._getLocalizedFilters(o.filters,this._pageContext.cultureInfo.currentUICultureName)]:[3,5];case 3:return n=i.sent(),o.filters=n,[4,this._getLocalizedMetadata(o.items,this._pageContext.cultureInfo.currentUICultureName)];case 4:a=i.sent(),o.items=a,i.label=5;case 5:return this._itemsCount=r.totalRows,[2,o]}})})},t.prototype.getPropertyPaneGroupsConfiguration=function(){var e=this;return[{groupName:l.DataSources.SharePointSearch.SourceName,groupFields:[Object(s.PropertyPaneLabel)("",{text:l.DataSources.SharePointSearch.QueryTextFieldLabel}),this._propertyPaneWebPartInformation({description:"<em>"+l.DataSources.SharePointSearch.QueryTextFieldInfoMessage+"</em>",key:"queryText"}),new k("dataSourceProperties.queryTemplate",{defaultValue:this.properties.queryTemplate,label:l.DataSources.SharePointSearch.QueryTemplateFieldLabel,placeholderText:l.DataSources.SharePointSearch.QueryTemplatePlaceHolderText,multiline:!0,description:l.DataSources.SharePointSearch.QueryTemplateFieldDescription,applyBtnText:l.DataSources.SharePointSearch.ApplyQueryTemplateBtnText,allowEmptyValue:!1,rows:8}),new f.a("dataSourceProperties.resultSourceId",{availableOptions:this._resultSourcesOptions,allowMultiSelect:!1,allowFreeform:!0,description:l.DataSources.SharePointSearch.ResultSourceIdDescription,label:l.DataSources.SharePointSearch.ResultSourceIdLabel,onLoadOptions:this.getBuiltinSourceIdOptions.bind(this),searchAsYouType:!1,defaultSelectedKey:this.properties.resultSourceId,textDisplayValue:null!==_.getEnumKeyByEnumValue(n,this.properties.resultSourceId)?_.getEnumKeyByEnumValue(n,this.properties.resultSourceId):this.properties.resultSourceId,onGetErrorMessage:this.validateSourceId.bind(this),onPropertyChange:this.onCustomPropertyUpdate.bind(this),onUpdateOptions:function(t){e._resultSourcesOptions=t}.bind(this)}),new f.a("dataSourceProperties.selectedProperties",{availableOptions:this._availableManagedProperties,allowMultiSelect:!0,allowFreeform:!0,description:l.DataSources.SharePointSearch.SelectedPropertiesFieldDescription,label:l.DataSources.SharePointSearch.SelectedPropertiesFieldLabel,placeholder:l.DataSources.SharePointSearch.SelectedPropertiesPlaceholderLabel,onLoadOptions:this.getAvailableProperties.bind(this),searchAsYouType:!1,defaultSelectedKeys:this.properties.selectedProperties,onPropertyChange:this.onCustomPropertyUpdate.bind(this),onUpdateOptions:function(t){e._availableManagedProperties=t}.bind(this)}),this._propertyFieldCollectionData("dataSourceProperties.sortList",{manageBtnLabel:l.DataSources.SearchCommon.Sort.EditSortLabel,key:"sortList",enableSorting:!0,panelHeader:l.DataSources.SearchCommon.Sort.EditSortLabel,panelDescription:l.DataSources.SearchCommon.Sort.SortListDescription,label:l.DataSources.SearchCommon.Sort.SortPropertyPaneFieldLabel,value:this.properties.sortList,fields:[{id:"sortField",title:l.DataSources.SearchCommon.Sort.SortFieldColumnLabel,type:this._customCollectionFieldType.custom,required:!0,onCustomRender:function(t,r,o,n,i,s){return a.createElement("div",{key:t.id+"-"+i},a.createElement(P.a,{defaultSelectedKey:n[t.id]?n[t.id]:"",onUpdate:function(r){e._sharePointSearchService.validateSortableProperty(r.key).then(function(e){e?(o(t.id,r.key),s(t.id,"")):s(t.id,l.DataSources.SearchCommon.Sort.SortInvalidSortableFieldMessage)})},allowMultiSelect:!1,allowFreeform:!0,availableOptions:e._availableManagedProperties,onLoadOptions:e.getAvailableProperties.bind(e),onUpdateOptions:function(t){e._availableManagedProperties=t}.bind(e),placeholder:l.DataSources.SearchCommon.Sort.SortFieldColumnPlaceholder,useComboBoxAsMenuWidth:!1}))}.bind(this)},{id:"sortDirection",title:l.DataSources.SearchCommon.Sort.SortDirectionColumnLabel,type:this._customCollectionFieldType.dropdown,required:!0,options:[{key:w.a.Ascending,text:l.DataSources.SearchCommon.Sort.SortDirectionAscendingLabel},{key:w.a.Descending,text:l.DataSources.SearchCommon.Sort.SortDirectionDescendingLabel}],defaultValue:w.a.Ascending}]}),new k("dataSourceProperties.refinementFilters",{defaultValue:this.properties.refinementFilters,label:l.DataSources.SharePointSearch.RefinementFilters,placeholderText:'ex: FileType:equals("docx")',multiline:!0,allowEmptyValue:!0,description:l.DataSources.SharePointSearch.RefinementFiltersDescription,applyBtnText:l.DataSources.SharePointSearch.ApplyQueryTemplateBtnText,rows:3}),Object(s.PropertyPaneDropdown)("dataSourceProperties.searchQueryLanguage",{label:l.DataSources.SharePointSearch.QueryCultureLabel,options:[{type:s.PropertyPaneDropdownOptionType.Normal,key:this._currentLocaleId,text:l.DataSources.SharePointSearch.QueryCultureUseUiLanguageLabel}].concat(Object(c.sortBy)(this._availableLanguages,["text"])),selectedKey:this.properties.searchQueryLanguage?this.properties.searchQueryLanguage:this._currentLocaleId}),Object(s.PropertyPaneToggle)("dataSourceProperties.enableQueryRules",{label:l.DataSources.SharePointSearch.EnableQueryRulesLabel,checked:this.properties.enableQueryRules}),Object(s.PropertyPaneToggle)("dataSourceProperties.includeOneDriveResults",{label:l.DataSources.SharePointSearch.IncludeOneDriveResultsLabel,checked:this.properties.includeOneDriveResults}),Object(s.PropertyPaneToggle)("dataSourceProperties.enableAudienceTargeting",{label:l.DataSources.SharePointSearch.EnableAudienceTargetingTglLabel,checked:this.properties.enableAudienceTargeting}),Object(s.PropertyPaneToggle)("dataSourceProperties.enableLocalization",{checked:this.properties.enableLocalization,label:l.DataSources.SharePointSearch.EnableLocalizationLabel,onText:l.DataSources.SharePointSearch.EnableLocalizationOnLabel,offText:l.DataSources.SharePointSearch.EnableLocalizationOffLabel})]}]},t.prototype.onCustomPropertyUpdate=function(e,t){0===e.localeCompare("dataSourceProperties.selectedProperties")&&(this.properties.selectedProperties=Object(c.cloneDeep)(t).map(function(e){return e.key}),this.context.propertyPane.refresh(),this.render()),0===e.localeCompare("dataSourceProperties.resultSourceId")&&(this.properties.resultSourceId=t.key,this.context.propertyPane.refresh(),this.render())},t.prototype.onPropertyUpdate=function(e,t,r){0===e.localeCompare("dataSourceProperties.enableLocalization")&&this.properties.enableLocalization&&-1===this.properties.selectedProperties.indexOf("UniqueID")&&(this.properties.selectedProperties=S()(this.properties.selectedProperties,{$push:["UniqueID"]}))},t.prototype.getPagingBehavior=function(){return i.n.Dynamic},t.prototype.getFilterBehavior=function(){return i.g.Dynamic},t.prototype.getItemCount=function(){return this._itemsCount},t.prototype.getTemplateSlots=function(){return[{slotName:i.e.Title,slotField:"Title"},{slotName:i.e.Path,slotField:"DefaultEncodingURL"},{slotName:i.e.Summary,slotField:"HitHighlightedSummary"},{slotName:i.e.FileType,slotField:"FileType"},{slotName:i.e.PreviewImageUrl,slotField:"AutoPreviewImageUrl"},{slotName:i.e.PreviewUrl,slotField:"AutoPreviewUrl"},{slotName:i.e.Author,slotField:"AuthorOWSUSER"},{slotName:i.e.Tags,slotField:"owstaxidmetadataalltagsinfo"},{slotName:i.e.Date,slotField:"Created"},{slotName:i.e.SiteId,slotField:"NormSiteID"},{slotName:i.e.WebId,slotField:"NormWebID"},{slotName:i.e.ListId,slotField:"NormListID"},{slotName:i.e.ItemId,slotField:"NormUniqueID"},{slotName:i.e.IsFolder,slotField:"ContentTypeId"},{slotName:i.e.ContentClass,slotField:"contentclass"},{slotName:i.e.PersonQuery,slotField:"UserName"},{slotName:i.e.UserDisplayName,slotField:"Title"},{slotName:i.e.UserEmail,slotField:"UserName"}]},t.prototype.initProperties=function(){this.properties.queryTemplate=this.properties.queryTemplate?this.properties.queryTemplate:"{searchTerms}",this.properties.enableQueryRules=void 0!==this.properties.enableQueryRules&&this.properties.enableQueryRules,this.properties.enableLocalization=void 0!==this.properties.enableLocalization&&this.properties.enableLocalization,this.properties.includeOneDriveResults=void 0!==this.properties.includeOneDriveResults&&this.properties.includeOneDriveResults,this.properties.refinementFilters=this.properties.refinementFilters?this.properties.refinementFilters:"",this.properties.selectedProperties=void 0!==this.properties.selectedProperties?this.properties.selectedProperties:["Title","Path","DefaultEncodingURL","FileType","HitHighlightedSummary","AuthorOWSUSER","owstaxidmetadataalltagsinfo","Created","UniqueID","NormSiteID","NormWebID","NormListID","NormUniqueID","ContentTypeId","contentclass","UserName","JobTitle","WorkPhone","SPSiteUrl","SiteTitle","CreatedBy"],this.properties.resultSourceId=void 0!==this.properties.resultSourceId?this.properties.resultSourceId:n.LocalSharePointResults,this.properties.sortList=void 0!==this.properties.sortList?this.properties.sortList:[]},t.prototype.getBuiltinSourceIdOptions=function(){return this._resultSourcesOptions=[{key:n.Documents,text:_.getEnumKeyByEnumValue(n,n.Documents)},{key:n.ItemsMatchingContentType,text:_.getEnumKeyByEnumValue(n,n.ItemsMatchingContentType)},{key:n.ItemsMatchingTag,text:_.getEnumKeyByEnumValue(n,n.ItemsMatchingTag)},{key:n.ItemsRelatedToCurrentUser,text:_.getEnumKeyByEnumValue(n,n.ItemsRelatedToCurrentUser)},{key:n.ItemsWithSameKeywordAsThisItem,text:_.getEnumKeyByEnumValue(n,n.ItemsWithSameKeywordAsThisItem)},{key:n.LocalPeopleResults,text:_.getEnumKeyByEnumValue(n,n.LocalPeopleResults)},{key:n.LocalReportsAndDataResults,text:_.getEnumKeyByEnumValue(n,n.LocalReportsAndDataResults)},{key:n.LocalSharePointResults,text:_.getEnumKeyByEnumValue(n,n.LocalSharePointResults)},{key:n.LocalVideoResults,text:_.getEnumKeyByEnumValue(n,n.LocalVideoResults)},{key:n.Pages,text:_.getEnumKeyByEnumValue(n,n.Pages)},{key:n.Pictures,text:_.getEnumKeyByEnumValue(n,n.Pictures)},{key:n.Popular,text:_.getEnumKeyByEnumValue(n,n.Popular)},{key:n.RecentlyChangedItems,text:_.getEnumKeyByEnumValue(n,n.RecentlyChangedItems)},{key:n.RecommendedItems,text:_.getEnumKeyByEnumValue(n,n.RecommendedItems)},{key:n.Wiki,text:_.getEnumKeyByEnumValue(n,n.Wiki)}],this._resultSourcesOptions},t.prototype.getAvailableProperties=function(){return F(this,void 0,void 0,function(){var e;return R(this,function(t){switch(t.label){case 0:return[4,this._sharePointSearchService.getAvailableManagedProperties()];case 1:return e=t.sent(),this._availableManagedProperties=e.map(function(e){return{key:e.name,text:e.name}}),[2,this._availableManagedProperties]}})})},t.prototype._convertToSortList=function(e){return e.map(function(e){var t;switch(e.sortDirection){case w.a.Ascending:t=g.a.Ascending;break;case w.a.Descending:t=g.a.Descending;break;default:t=g.a.Ascending}return{Property:e.sortField,Direction:t}})},t.prototype.buildSharePointSearchQuery=function(e){return F(this,void 0,void 0,function(){var t,r,o,a,s,l=this;return R(this,function(u){switch(u.label){case 0:return(t={}).ClientType="PnPModernSearch",t.Properties=[{Name:"EnableDynamicGroups",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}},{Name:"ClientFunction",Value:{StrVal:"PnPSearchWebPart",QueryPropertyValueTypeIndex:1}}],this._pageContext.list&&t.Properties.push({Name:"ListId",Value:{StrVal:this._pageContext.list.id.toString(),QueryPropertyValueTypeIndex:1}}),this._pageContext.listItem&&t.Properties.push({Name:"ListItemId",Value:{StrVal:this._pageContext.listItem.id.toString(),QueryPropertyValueTypeIndex:1}}),t.Querytext=e.inputQueryText,t.EnableQueryRules=this.properties.enableQueryRules,r=t,[4,this._tokenService.resolveTokens(this.properties.queryTemplate)];case 1:return r.QueryTemplate=u.sent(),this.properties.resultSourceId&&(t.SourceId=this.properties.resultSourceId),t.SourceId&&t.SourceId.toLocaleLowerCase()===n.LocalPeopleResults?(t.EnableNicknames=!0,t.EnablePhonetic=!0):(t.EnableNicknames=!1,t.EnablePhonetic=!1),t.Culture=void 0!==this.properties.searchQueryLanguage&&null!==this.properties.searchQueryLanguage?this.properties.searchQueryLanguage:this._currentLocaleId,o={WebBias:this._pageContext.legacyPageContext.webTimeZoneData.Bias?this._pageContext.legacyPageContext.webTimeZoneData.Bias:0,WebDST:this._pageContext.legacyPageContext.webTimeZoneData.DaylightBias?this._pageContext.legacyPageContext.webTimeZoneData.DaylightBias:0,UserBias:null,UserDST:null,Id:this._pageContext.legacyPageContext.webTimeZoneData.Id},this._pageContext.legacyPageContext.userTimeZoneData&&(o.UserBias=this._pageContext.legacyPageContext.userTimeZoneData.Bias?this._pageContext.legacyPageContext.userTimeZoneData.Bias:0,o.UserDST=this._pageContext.legacyPageContext.userTimeZoneData.DaylightBias?this._pageContext.legacyPageContext.userTimeZoneData.DaylightBias:0,o.Id=this._pageContext.legacyPageContext.webTimeZoneData.Id),t.TimeZoneId=o.Id,a=Object(c.isEmpty)(this.properties.refinementFilters)?[]:[this.properties.refinementFilters],Object(c.isEmpty)(e.filters)||(t.Refiners=e.filters.filtersConfiguration.map(function(e){if(new RegExp("(RefinableDate\\d+)(?=,|$)|(RefinableDateInvariant00\\d+)(?=,|$)|(RefinableDateSingle\\d+)(?=,|$)|(LastModifiedTime)(?=,|$)|(LastModifiedTimeForRetention)(?=,|$)|(Created)(?=,|$)|(Date\\d+)(?=,|$)|(EndDate)(?=,|$)|(.+OWSDATE)(?=,|$)|(EventsRollUpEndDate)(?=,|$)|(EventsRollUpStartDate)(?=,|$)|(FirstPublishedDate)(?=,|$)|(ImageDateCreated)(?=,|$)|(LastAnalyticsUpdateTime)(?=,|$)|(ModifierDates)(?=,|$)|(ClassificationLastScan)(?=,|$)|(ComplianceTagWrittenTime)(?=,|$)|(ContentModifiedTime)(?=,|$)|(DocumentAnalyticsLastActivityTimestamp)(?=,|$)|(ExpirationTime)(?=,|$)|(LastSharedByTime)(?=,|$)|(StartDate)(?=,|$)|(TagEventDate)(?=,|$)|(processingtime)(?=,|$)|(ExtractedDate)(?=,|$)".replace(/\s+/gi,""),"gi").test(e.filterName)){var t=l.moment(new Date).subtract(1,"years").subtract("minutes",1).toISOString(),r=l.moment(new Date).subtract(3,"months").subtract("minutes",1).toISOString(),o=l.moment(new Date).subtract(1,"months").subtract("minutes",1).toISOString(),n=l.moment(new Date).subtract(1,"week").subtract("minutes",1).toISOString(),a=l.moment(new Date).subtract(24,"hours").subtract("minutes",1).toISOString(),s=(new Date).toISOString();return e.filterName+"(discretize=manual/"+t+"/"+r+"/"+o+"/"+n+"/"+a+"/"+s+")"}if(e.maxBuckets){var u=e.sortBy==i.k.ByName?"name":"frequency",c=e.sortDirection==i.j.Ascending?"ascending":"descending";return e.filterName+"(filter="+e.maxBuckets+"/0/*,sort="+u+"/"+c+")"}return e.filterName}).join(","),e.filters.selectedFilters.length>0&&(e.filters.selectedFilters.length>1&&e.filters.selectedFilters.filter(function(e){return e.values.length>0}).length>1?(s=this.buildRefinementQueryString(e.filters.selectedFilters,e.filters.filtersConfiguration).join(","),Object(c.isEmpty)(s)||(a=a.concat([e.filters.filterOperator+"("+s+")"]))):a=a.concat(this.buildRefinementQueryString(e.filters.selectedFilters,e.filters.filtersConfiguration)))),t.RefinementFilters=a,t.RowLimit=e.itemsCountPerPage?e.itemsCountPerPage:50,1===e.pageNumber?t.StartRow=0:t.StartRow=(e.pageNumber-1)*t.RowLimit,t.TrimDuplicates=!1,t.SortList=this._convertToSortList(this.properties.sortList),t.SelectProperties=this.properties.selectedProperties,this.properties.includeOneDriveResults&&t.Properties.push({Name:"ContentSetting",Value:{IntVal:3,QueryPropertyValueTypeIndex:2}}),this.properties.enableAudienceTargeting&&(t.QueryTemplate=t.QueryTemplate+" (ModernAudienceAadObjectIds:{User.Audiences} OR NOT IsAudienceTargeted:true)"),[2,t]}})})},t.prototype.buildRefinementQueryString=function(e,t,r){var o=this,n=[];return e.forEach(function(e){var a=e.operator,s=E.a.getConfigurationForFilter(e,t);if(s)if(e.values.length>1){var l=null,u=null,c=e.values.map(function(e){var t=e.value;return o.moment(t,o.moment.ISO_8601,!0).isValid()&&(l||e.operator!==i.h.Geq&&e.operator!==i.h.Gt||(l=t),u||e.operator!==i.h.Lt&&e.operator!==i.h.Leq||(u=t)),s.selectedTemplate===L.a.TaxonomyPicker&&(t="GP0|#"+e.value+",L0|#0"+e.value),/ǂǂ/.test(t)&&r?encodeURIComponent(t):t});l&&u?n.push(e.filterName+":range("+l+","+u+")"):n.push(e.filterName+":"+a+"("+c.join(",")+")")}else if(1===e.values.length){var p=e.values[0],d=/ǂǂ/.test(p.value)&&r?encodeURIComponent(p.value):p.value;s.selectedTemplate===L.a.TaxonomyPicker&&(d="or(GP0|#"+p.value+", L0|#0"+p.value+")"),o.moment(d,o.moment.ISO_8601,!0).isValid()&&(p.operator!==i.h.Gt&&p.operator!==i.h.Geq||(d="range("+d+",max)"),p.operator!==i.h.Leq&&p.operator!==i.h.Lt||(d="range(min,"+d+")")),n.push(e.filterName+":"+d)}}),n},t.prototype.validateSourceId=function(e){return e.length>0&&!/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/.test(e)?l.DataSources.SharePointSearch.InvalidResultSourceIdMessage:""},t.prototype._getLocalizedFilters=function(e,t){return F(this,void 0,void 0,function(){var r,o,n,a,i,s=this;return R(this,function(p){switch(p.label){case 0:return r=d.a.getLocaleId(t),o=[],n=[],a=[],(n=e.map(function(e){var t=[];return e.values.forEach(function(e){/L0\|#(.+)\|/.test(e.name)?e.name.split(";").forEach(function(r){var o='"ǂǂ'+s._bytesToHex(s._stringToUTF8Bytes(r))+'"',n=t.map(function(e){return e.name}).indexOf(r);-1===n?t.push({count:e.count,name:r,value:o}):(t[n].count=t[n].count+1,t[n].value=o)}):t.push(e)}),e.values=Object(c.cloneDeep)(t),e})).forEach(function(e){e.values.forEach(function(e){if(/L0\|#(.+)\|/.test(e.name)){var t=/L0\|#(.+)\|/.exec(e.name);if(t.length>0){var r=u.Guid.isValid(t[1])?t[1]:t[1].substr(1);-1===o.map(function(e){return e.uniqueIdentifier}).indexOf(e.value)&&o.push({uniqueIdentifier:e.value,termId:r,localizedTermLabel:null})}}})}),o.length>0?[4,this._taxonomyService.getTermsById(this._pageContext.site.absoluteUrl,o.map(function(e){return e.termId}))]:[3,2];case 1:i=p.sent(),o.forEach(function(e){var t=i.filter(function(t){return t.Id.substring(t.Id.indexOf("(")+1,t.Id.indexOf(")"))===e.termId});if(t.length>0){var o=t[0],n=o.Labels._Child_Items_.filter(function(e){return e.Language===r});0===n.length&&(n=o.Labels._Child_Items_),a.push({uniqueIdentifier:e.uniqueIdentifier,termId:e.termId,localizedTermLabel:n[0].Value})}else a.push({uniqueIdentifier:e.uniqueIdentifier,termId:e.termId,localizedTermLabel:u.Text.format(l.DataSources.SharePointSearch.TermNotFound,e.termId)})}),n=n.map(function(e){return e.values=e.values.map(function(e){var t=a.filter(function(t){return t.uniqueIdentifier===e.value});if(t.length>0&&(e.name=t[0].localizedTermLabel),!/(GTSet|GPP|GP0)/i.test(e.name))return e}).filter(function(e){return e}),e}),p.label=2;case 2:return[2,n]}})})},t.prototype._getLocalizedMetadata=function(e,t){return F(this,void 0,void 0,function(){var r,o,n,a,i;return R(this,function(s){switch(s.label){case 0:return r=d.a.getLocaleId(t),o=[],n=[],e.forEach(function(e){var t=[];Object.keys(e).forEach(function(r){if(/L0\|#.?([0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12})/.test(e[r])){for(var o=[],n=/L0\|#.?([0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12})/g,a=e[r],i=void 0;null!==(i=n.exec(a));)i.index===n.lastIndex&&n.lastIndex++,o.push(i[1]);t.push({propertyName:r,termIds:o})}}),t.length>0&&o.push({uniqueIdentifier:e.UniqueID,properties:t})}),o.length>0?(a=[],o.forEach(function(e){e.properties.forEach(function(e){a=a.concat(e.termIds)})}),a=Object(c.uniq)(a),[4,this._taxonomyService.getTermsById(this._pageContext.site.absoluteUrl,a)]):[3,2];case 1:return i=s.sent(),o.forEach(function(e){var t=[];e.properties.forEach(function(e){var o=[],n=i.filter(function(t){var r=t.Id.substring(t.Id.indexOf("(")+1,t.Id.indexOf(")"));return-1!==e.termIds.indexOf(r)});n.length>0&&(n.forEach(function(e){var t=e.Labels._Child_Items_.filter(function(e){return e.Language===r&&e.IsDefaultForLanguage});0===t.length&&(t=e.Labels._Child_Items_),t.length>0&&o.push(t[0].Value)}),t.push({propertyName:e.propertyName,termLabels:o}))}),n.push({uniqueIdentifier:e.uniqueIdentifier,properties:t})}),[2,e.map(function(e){var t=n.filter(function(t){return t.uniqueIdentifier===e.UniqueID});return t.length>0&&t[0].properties.forEach(function(t){e["Auto"+t.propertyName]=t.termLabels.join(", ")}),e})];case 2:return[2,e]}})})},t.prototype._bytesToHex=function(e){return Array.from(e,function(e){return e.toString(16).padStart(2,"0")}).join("")},t.prototype._stringToUTF8Bytes=function(e){return(new TextEncoder).encode(e)},t}(i.a)}}]);