(window.webpackJsonp_1a86ce4e35bac7ae60ca710fe0988d33=window.webpackJsonp_1a86ce4e35bac7ae60ca710fe0988d33||[]).push([[160],{"+OTn":function(e,t,r){"use strict";r.r(t),r.d(t,"SharePointSuggestionProvider",function(){return l});var n,i=r("MONU"),s=r("lWUY"),o=r("PqB8"),a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})},c=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onInit=function(){return u(this,void 0,void 0,function(){var e=this;return c(this,function(t){return this.serviceScope.whenFinished(function(){e._searchService=e.serviceScope.consume(s.a.ServiceKey)}),[2]})})},Object.defineProperty(t.prototype,"isZeroTermSuggestionsEnabled",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.getSuggestions=function(e){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this._searchService.suggest(e)];case 1:return[2,t.sent().map(function(e){return{displayText:e,groupName:o.SuggestionProviders.SharePointStatic.ProviderName}})]}})})},t.prototype.getPropertyPaneGroupsConfiguration=function(){return[]},t}(i.c)},WVJB:function(e,t,r){"use strict";var n=function(){function e(){}return e.getLocaleId=function(t){var r=Object.keys(e.locales).filter(function(r){return e.locales[r]===t});return r.length>0?parseInt(r[0]):0},e.locales={1025:"ar-SA",1026:"bg-BG",1027:"ca-ES",1028:"zh-TW",1029:"cs-CZ",1030:"da-DK",1031:"de-DE",1032:"el-GR",1033:"en-US",1035:"fi-FI",1036:"fr-FR",1037:"he-IL",1038:"hu-HU",1040:"it-IT",1041:"ja-JP",1042:"ko-KR",1043:"nl-NL",1044:"nb-NO",1045:"pl-PL",1046:"pt-BR",1048:"ro-RO",1049:"ru-RU",1050:"hr-HR",1051:"sk-SK",1053:"sv-SE",1054:"th-TH",1055:"tr-TR",1057:"id-ID",1058:"uk-UA",1060:"sl-SI",1061:"et-EE",1062:"lv-LV",1063:"lt-LT",1066:"vi-VN",1068:"az-Latn-AZ",1069:"eu-ES",1071:"mk-MK",1081:"hi-IN",1086:"ms-MY",1087:"kk-KZ",1106:"cy-GB",1110:"gl-ES",1164:"prs-AF",2052:"zh-CN",2070:"pt-PT",2074:"sr-Latn-CS",2108:"ga-IE",3082:"es-ES",5146:"bs-Latn-BA",9242:"sr-Latn-RS",10266:"sr-Cyrl-RS"},e}();t.a=n},lWUY:function(e,t,r){"use strict";r.d(t,"a",function(){return v});var n=r("UWqr"),i=r("vlQI"),s=r("NTZZ"),o=r("sMVL"),a=r("X+PM"),u=r("Pk8u"),c=r("MONU"),l=r("WVJB"),p=r("q5kO"),h=r("rMgv"),f=function(){return(f=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},g=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})},y=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},v=function(){function e(e){var t=this;this.serviceScope=e,this.clientStorage=new s.a,e.whenFinished(function(){return g(t,void 0,void 0,function(){return y(this,function(t){return this.pageContext=e.consume(a.PageContext.serviceKey),this.spHttpClient=e.consume(i.SPHttpClient.serviceKey),this.searchEndpointUrl=this.pageContext.web.absoluteUrl+"/_api/search/postquery",[2]})})})}return e.prototype.search=function(e){return g(this,void 0,void 0,function(){var t,r,s,o,a,l,p,f,g,v,d,S,R,b=this;return y(this,function(y){switch(y.label){case 0:t={queryKeywords:e.Querytext,refinementResults:[],relevantResults:[],secondaryResults:[],totalRows:0},y.label=1;case 1:return y.trys.push([1,6,,7]),[4,this.spHttpClient.post(this.searchEndpointUrl,i.SPHttpClient.configurations.v1,{body:this.getRequestPayload(e),headers:{"odata-version":"3.0",accept:"application/json;odata=nometadata","X-ClientService-ClientTag":h.b.X_CLIENTSERVICE_CLIENTTAG,UserAgent:h.b.X_CLIENTSERVICE_CLIENTTAG}})];case 2:return(r=y.sent()).ok?[4,r.json()]:[3,4];case 3:return(s=y.sent()).PrimaryQueryResult&&(o=[],1===(a=s.PrimaryQueryResult.RelevantResults.Properties.filter(function(e){return"QueryModification"===e.Key})).length&&(t.queryModification=a[0].Value),l=s.PrimaryQueryResult.RelevantResults.Table.Rows,p=s.PrimaryQueryResult.RefinementResults,f=p?p.Refiners:[],g=this.getSearchResults(l),f.forEach(function(e){var t=[];e.Entries.forEach(function(e){t.push({count:parseInt(e.RefinementCount,10),name:e.RefinementValue.replace("string;#",""),value:e.RefinementToken,operator:c.h.Contains})}),o.push({filterName:e.Name,values:t})}),t.relevantResults=g,t.refinementResults=o,t.totalRows=s.PrimaryQueryResult.RelevantResults.TotalRows,Object(u.isEmpty)(s.SpellingSuggestion)||(t.spellingSuggestion=s.SpellingSuggestion)),s.SecondaryQueryResults&&(v=s.SecondaryQueryResults,Array.isArray(v)&&v.length>0&&(d=[],S=[],v.forEach(function(e){if(e.SpecialTermResults&&e.SpecialTermResults.Results.forEach(function(e){d.push({title:e.Title,url:e.Url,description:e.Description})}),e.RelevantResults){var t=b.getSearchResults(e.RelevantResults.Table.Rows),r={title:e.RelevantResults.ResultTitle,results:t};r.results.length>0&&S.push(r)}}),t.promotedResults=d,t.secondaryResults=S)),[2,t];case 4:throw new Error(""+r.statusMessage);case 5:return[3,7];case 6:throw R=y.sent(),n.Log.error("[SharePointSearchService.search()]",R,this.serviceScope),R;case 7:return[2]}})})},e.prototype.getAvailableManagedProperties=function(){return g(this,void 0,void 0,function(){var e,t,r,s,o,a;return y(this,function(u){switch(u.label){case 0:e=[],(t={}).Querytext="*",t.Refiners="ManagedProperties(filter=50000/0/*,sort=name/ascending)",t.RowLimit=1,u.label=1;case 1:return u.trys.push([1,6,,7]),[4,this.spHttpClient.post(this.searchEndpointUrl,i.SPHttpClient.configurations.v1,{body:this.getRequestPayload(t),headers:{"odata-version":"3.0",accept:"application/json;odata=nometadata"}})];case 2:return(r=u.sent()).ok?[4,r.json()]:[3,4];case 3:return s=u.sent(),((o=s.PrimaryQueryResult.RefinementResults)?o.Refiners:[]).forEach(function(t){t.Entries.forEach(function(t){e.push({name:t.RefinementName})})}),[3,5];case 4:throw new Error(""+r.statusMessage);case 5:return[3,7];case 6:throw a=u.sent(),n.Log.error("[SharePointSearchService.getAvailableManagedProperties()]",a,this.serviceScope),a;case 7:return[2,e]}})})},e.prototype.getAvailableQueryLanguages=function(){return g(this,void 0,void 0,function(){var e,t,r;return y(this,function(s){switch(s.label){case 0:return s.trys.push([0,6,,7]),this.clientStorage.local.deleteExpired(),(e=this.clientStorage.local.get("pnpSearchResults_AvailableQueryLanguages"))?[2,Promise.resolve(e)]:[3,1];case 1:return[4,this.spHttpClient.get(this.pageContext.web.absoluteUrl+"/_api/web/RegionalSettings/InstalledLanguages",i.SPHttpClient.configurations.v1,{headers:{"X-ClientService-ClientTag":h.b.X_CLIENTSERVICE_CLIENTTAG,UserAgent:h.b.X_CLIENTSERVICE_CLIENTTAG}})];case 2:return(t=s.sent()).ok?[4,t.json()]:[3,4];case 3:return e=s.sent(),this.clientStorage.local.put("pnpSearchResults_AvailableQueryLanguages",e.Items,Object(o.a)(new Date,"week",1)),[2,e.Items];case 4:throw new Error(""+t.statusMessage);case 5:return[3,7];case 6:throw r=s.sent(),n.Log.error("[SharePointSearchService._getQueryLanguages()]",r,this.serviceScope),new Error(r);case 7:return[2]}})})},e.prototype.validateSortableProperty=function(e){return g(this,void 0,void 0,function(){var t,r,n;return y(this,function(s){switch(s.label){case 0:t=!1,(r={}).Querytext="*",r.SortList=[{Property:e,Direction:p.a.Ascending}],r.RowLimit=1,r.SelectProperties=["Path"],s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.spHttpClient.post(this.searchEndpointUrl,i.SPHttpClient.configurations.v1,{body:this.getRequestPayload(r),headers:{"odata-version":"3.0",accept:"application/json;odata=nometadata","X-ClientService-ClientTag":h.b.X_CLIENTSERVICE_CLIENTTAG,UserAgent:h.b.X_CLIENTSERVICE_CLIENTTAG}})];case 2:return n=s.sent(),t=!!n.ok,[3,4];case 3:return s.sent(),t=!1,[3,4];case 4:return[2,t]}})})},e.prototype.suggest=function(e){return g(this,void 0,void 0,function(){var t,r,s,o,a,u;return y(this,function(c){switch(c.label){case 0:t=[],r={preQuery:!0,queryText:encodeURIComponent(e.replace(/'/g,"''")),count:10,hitHighlighting:!0,prefixMatch:!0,culture:l.a.getLocaleId(this.pageContext.cultureInfo.currentUICultureName).toString(),numberOfQuerySuggestions:10,capitalize:!1},c.label=1;case 1:return c.trys.push([1,6,,7]),s=n.Text.format(this.pageContext.web.absoluteUrl+"/_api/search/suggest?querytext='{0}'&inumberofquerysuggestions={1}&fHitHighlighting={2}&fCapitalizeFirstLetters={3}&Culture={4}&fPrefixMatchAllTerms={5}",r.queryText,r.numberOfQuerySuggestions,r.hitHighlighting,r.capitalize,r.culture,r.prefixMatch),[4,this.spHttpClient.get(s,i.SPHttpClient.configurations.v1,{headers:{"X-ClientService-ClientTag":h.b.X_CLIENTSERVICE_CLIENTTAG,UserAgent:h.b.X_CLIENTSERVICE_CLIENTTAG}})];case 2:return(o=c.sent()).ok?[4,o.json()]:[3,4];case 3:return(a=c.sent()).Queries.length>0&&(t=a.Queries.map(function(e){return e.Query})),[2,t];case 4:throw new Error(""+o.statusMessage);case 5:return[3,7];case 6:throw u=c.sent(),n.Log.error("[SharePointSearchService.suggest()]",u,this.serviceScope),u;case 7:return[2]}})})},e.prototype.getSearchResults=function(e){return e.map(function(e){var t={};return e.Cells.map(function(e){t[e.Key]=e.Value}),t})},e.prototype.getRequestPayload=function(e){var t=Object(u.cloneDeep)(e);t.HitHighlightedProperties=this.fixArrProp(t.HitHighlightedProperties),t.Properties=this.fixArrProp(t.Properties),t.RefinementFilters=this.fixArrProp(t.RefinementFilters),t.ReorderingRules=this.fixArrProp(t.ReorderingRules),t.SelectProperties=this.fixArrProp(t.SelectProperties),t.SortList=this.fixArrProp(t.SortList);var r={request:f({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)};return JSON.stringify(r)},e.prototype.fixArrProp=function(e){return void 0===e?{results:[]}:{results:Array.isArray(e)?e:[e]}},e.ServiceKey=n.ServiceKey.create("pnpSearchResults:SharePointSearchService",e),e}()},q5kO:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return n}),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(n||(n={}))}}]);